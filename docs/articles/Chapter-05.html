<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • glmbayes</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glmbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/chapter-01.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-02.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-03.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-04.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-05.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-06.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-07.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-08.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-09.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-10.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-11.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-A1.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-A2.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapter 5: A detailed overview of the glmbayes
package</h1>
                        <h4 data-toc-skip class="author">Kjell
Nygren</h4>
            
            <h4 data-toc-skip class="date">2025-07-14</h4>
      

      <div class="hidden name"><code>Chapter-05.Rmd</code></div>

    </div>

    
    
<p>Yaml</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <em>glmbayes</em> package produces iid samples for Bayesian
Linear Models and Bayesian Genereralized Linear Models by providing
Bayesian versions of the <em>lmb</em> and <em>glm</em> functions for
classical models. Extensive efforts have been made to make the new
functions, <em>lmb</em> and <em>glmb</em>, as similar as possible to
their classical cousins. To that end, the functions add a single
required argument (pfamily) and one optional argument (n) to those
typically used by the classical functions. The Bayesian functions also
generally inherit and/or provide implemented methods for nearly all of
the methods available for the <em>lm</em> and <em>glm</em> functions so
that the same type of outputs as from the classical functions can be
readily produced.</p>
<p>This vignette is designed to provide users a detailed overview of the
package and the various functionalities available. In the rest of this
introduction, we briefly touch on the basics of loading the package and
accessings various help resources and demos (which we recommend as a
next step for users after they read this vignette). The next section
then gives an overview of all the core functions that most users are
likely to use. This includes the two aforementioned functions, functions
used to specify and check prior distributions, and methods available for
the two functions. Most users can likely stop after that section and can
then turn to either the help pages or the next set of vignettes that go
into a more detailed comparisons of how the methods are used for these
Bayesian functions vs. for their classical cousins.</p>
<p>For advanced users who are interested in implementing Block-Gibbs
sampling procedures or in doing simulation for other more complex
models, we recommend continuing on to the third section in this vignette
that covers the two functions <em>rlmb</em> and <em>rglmb</em> and are
designed for implementation of precisely that type of sampling. The
third section discusses how those functions can be called, references
some examples/demos where they are used, and describes how to use the
output from the functions to access similar output to that produced by
the <em>lmb</em> and <em>glmb</em> functions.</p>
<p>For users who are interested in the details of how the simulation is
performed there is the final section that contains a discussion of the
various simulation functions that are used to sample from the posterior
distributions. This includes a discussion of three core function that
simuate for the currently implemented prior families and a couple of
functions related to what we call the Central Normal distribution (the
normal distribution between a lower and an upper bound). It also
includes a discussion of a set of functions that are used in order to
utilize the enveloping functions needed to get iid samples for some of
the posterior distributions. That material is rather technical and we
refer the user to the Nygren and Nygren (2006) paper that forms the
foundation for the simulation procedure.</p>
<div class="section level3">
<h3 id="loading-the-package">Loading the package<a class="anchor" aria-label="anchor" href="#loading-the-package"></a>
</h3>
<p>The package curently requires the MASS package so it also needs to be
installed and gets loaded as part of the loading of the glmbayes package
(see below).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">glmbayes</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: MASS</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="accessing-package-information-general-documentation-and-demos">Accessing package information, general documentation, and demos<a class="anchor" aria-label="anchor" href="#accessing-package-information-general-documentation-and-demos"></a>
</h3>
<p>To access information for the package outside of the information
contained in these vignettes, we suggest users review three sets of help
pages. A call to help(glmbayes) yields a page with a detailed discussion
of the package with an example at the bottom. Calling
help(package=“glmbayes”) brings the user to a list of Help pages for
specific functions as well as links to a general description file, code
demos, and these vignettes. Part of the objective of this vignette is to
provide more organized layout of the functions than the general list of
help pages provided on the documentation page.</p>
<p>A call to demo(package=“glmbayes”), finally, brings up a list of
available demos for the package. A useful start for users might be to go
through the specific demos as they are set up to illustrate the
functionality of the package.</p>
<ul>
<li>help(glmbayes)</li>
<li>help(package=“glmbayes”)</li>
<li>demo(package=“glmbayes”)</li>
<li>data(package=“glmbayes)</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="using-the-lmb-and-glmb-functions-and-their-methods">Using the <em>lmb</em> and <em>glmb</em> functions and their
methods<a class="anchor" aria-label="anchor" href="#using-the-lmb-and-glmb-functions-and-their-methods"></a>
</h2>
<p>As noted above, the <em>lmb</em> and <em>glmb</em> functions are the
two core functions in this package. More detailed side-by-side
comparisons of the use of methods for these functions and their
classical cousins are provided in the next two vignettes. Here we
provide a brief overview of supporting functions available to facilitate
the use of the core functions. In the first subsection, we show how the
core functions are called (and how this compares to calls for the
classical functions). We then give a brief discussion of how priors are
specified and some related functions designed to assist with that task
as well as with the task of viewiw prior specifications after the
modeling is completed.</p>
<div class="section level3">
<h3 id="the-lmb-and-glmb-functions">The <em>lmb</em> and <em>glmb</em> functions<a class="anchor" aria-label="anchor" href="#the-lmb-and-glmb-functions"></a>
</h3>
<p>The code snippets below illustrates how model specification for these
models can be done by simply providind an additional argument, a
pfamily, that provides information on the type of prior distribution
that has been selected and the parameter values that are desired. A
separate vignette is provided to give guidance to users on how to select
appropriate prior parameters (and some standardization steps that may be
useful as part of that).</p>
<p>[NEED TO MODIFY Prior_Setup PRINT FUNCTION AND HOW IT HANDLES CASE
WHERE X IS MISSING] [MAY ALSO WANT TO HAVE IT INITIALIZE SHAPE AND RATE
PARAMETERS]</p>
<p><em>Calling lm vs. calling lmb</em></p>
<p>Here is the call for the lmb function and how it compares to the call
to the classical lm function. The recommended prior here is the
dNormal_Gamma pfamily which requires four parameters (2 for he Normal
component, and 2 for the Gamma component).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Annette Dobson (1990) "An Introduction to Generalized Linear Models".</span></span>
<span><span class="co">## Page 9: Plant Weight Data.</span></span>
<span><span class="va">ctl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.17</span>,<span class="fl">5.58</span>,<span class="fl">5.18</span>,<span class="fl">6.11</span>,<span class="fl">4.50</span>,<span class="fl">4.61</span>,<span class="fl">5.17</span>,<span class="fl">4.53</span>,<span class="fl">5.33</span>,<span class="fl">5.14</span><span class="op">)</span></span>
<span><span class="va">trt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.81</span>,<span class="fl">4.17</span>,<span class="fl">4.41</span>,<span class="fl">3.59</span>,<span class="fl">5.87</span>,<span class="fl">3.83</span>,<span class="fl">6.03</span>,<span class="fl">4.89</span>,<span class="fl">4.32</span>,<span class="fl">4.69</span><span class="op">)</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span>, <span class="fl">20</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ctl"</span>,<span class="st">"Trt"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">weight</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ctl</span>, <span class="va">trt</span><span class="op">)</span></span>
<span><span class="co">##Classical model-call</span></span>
<span><span class="va">lm.D9</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bayesian Prior Setup and Call-Prior Should Generally be Customized</span></span>
<span><span class="va">p_info</span><span class="op">=</span><span class="fu"><a href="../reference/Prior_Setup.html">Prior_Setup</a></span><span class="op">(</span><span class="va">weight</span><span class="op">~</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="va">mu1</span><span class="op">=</span><span class="va">p_info</span><span class="op">$</span><span class="va">mu</span>    </span>
<span><span class="va">Sigma1</span><span class="op">=</span><span class="va">p_info</span><span class="op">$</span><span class="va">Sigma</span></span>
<span></span>
<span><span class="co">#lmb.D9 &lt;- lmb(weight ~ group,pfamily=dNormal_Gamma(mu1,Sigma1,shape=4,rate=0.1))</span></span></code></pre></div>
<p><em>Calling glm vs. calling glmb</em></p>
<p>The call for the glmb function is quite similar and is here compared
to the corresponding call for the glm function. For the binomial and
Poisson families, the recommended prior here is the dNormal pfamily
which requires 2 parameters (a prior mean vector and a prior
Variance-Covariance matrix).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Dobson (1990) Page 93: Randomized Controlled Trial :</span></span>
<span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">18</span>,<span class="fl">17</span>,<span class="fl">15</span>,<span class="fl">20</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">25</span>,<span class="fl">13</span>,<span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">9</span><span class="op">)</span></span>
<span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">##Classical model-call</span></span>
<span><span class="va">glm.D93</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">counts</span> <span class="op">~</span> <span class="va">outcome</span> <span class="op">+</span> <span class="va">treatment</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bayesian Prior Setup and Call-Prior Should Generally be Customized</span></span>
<span><span class="va">p_info2</span><span class="op">=</span><span class="fu"><a href="../reference/Prior_Setup.html">Prior_Setup</a></span><span class="op">(</span><span class="va">counts</span> <span class="op">~</span> <span class="va">outcome</span> <span class="op">+</span> <span class="va">treatment</span><span class="op">)</span></span>
<span><span class="va">mu2</span><span class="op">=</span><span class="va">p_info2</span><span class="op">$</span><span class="va">mu</span>    </span>
<span><span class="va">Sigma2</span><span class="op">=</span><span class="va">p_info2</span><span class="op">$</span><span class="va">Sigma</span></span>
<span></span>
<span><span class="va">glmb.D93</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/glmb.html">glmb</a></span><span class="op">(</span><span class="va">counts</span> <span class="op">~</span> <span class="va">outcome</span> <span class="op">+</span> <span class="va">treatment</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,pfamily<span class="op">=</span><span class="fu"><a href="../reference/pfamily.html">dNormal</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu2</span>,Sigma<span class="op">=</span><span class="va">Sigma2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="specifying-priors">Specifying Priors<a class="anchor" aria-label="anchor" href="#specifying-priors"></a>
</h3>
<div class="section level4">
<h4 id="prior-family-functions">Prior Family Functions<a class="anchor" aria-label="anchor" href="#prior-family-functions"></a>
</h4>
<p>The <em>pfamily</em> arguments described above are actually functions
that provide needed information to the <em>lmb</em> and <em>glmb</em>
functions. Since they are are functions, they can also be called
directly, as seen below, where they return lists with items related to
the prior (see documentation of these pfamily functions for details).
These functions are also discussed in more detail in a latter
chapter.</p>
<p>While the current package only provides 3 implemented pfamiles, this
is actually not a severe limitations as users easily can write their own
prior families and pass those to the <em>lmb</em> and <em>glmb</em>
functions. One of our exaxmple includes an illustration of this and this
approach is discussed more extensively in one of our other vignettes.
Below, we simply illustrate how the functions can be called
directly.</p>
<p>NOTE: IMPLEMENT THE EXAMPLE DISCUSSED ABOVE AND WRITE A SEPARATE
VIGNETTE TO ACCOMPANY THE EXAMPLE.</p>
<p><em>Calling the dNormal prior family</em></p>
<p>This prior is typically used as a prior for the Poisson and Binomial
families when calling either the <em>glmb</em> or <em>rglm</em>
functions. Calling it directly provides a list with, among other items,
the prior specification. the documentation for the <em>pfamilies</em>
provides additional information on what the returned list contains and
what required and optional arguments are.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pfamily.html">dNormal</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu2</span>,Sigma<span class="op">=</span><span class="va">Sigma2</span>,dispersion<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p>*Calling the dNormal_Gamma prior family</p>
<p>This prior is typically used as a prior when calling either the
<em>lmb</em> or <em>rglmb</em> functions or when using the
<em>gaussian()</em> family in the <em>glm</em> and <em>rglmb</em>
functions. Calling it directly</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/pfamily.html">dNormal_Gamma</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu1</span>,Sigma<span class="op">=</span><span class="va">Sigma1</span>,shape<span class="op">=</span><span class="fl">4</span>,rate<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p>*Calling the dGamma prior family</p>
<p>This prior is typically used when giving a prior for the dispersion
parameter in the <em>lmb</em>, <em>rlmb</em>, <em>glmb</em>, and
<em>rglmb</em> functions (in the latter case for the <em>gaussian()</em>
and <em>Gamma()</em> families). Typicall this would be done as part of
Block-Gibbs sampling where the regression coefficients are updated in a
separate block.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b</span><span class="op">=</span><span class="va">lm.D9</span><span class="op">$</span><span class="va">coefficients</span></span>
<span><span class="fu"><a href="../reference/pfamily.html">dGamma</a></span><span class="op">(</span>shape<span class="op">=</span><span class="fl">4</span>,rate<span class="op">=</span><span class="fl">0.1</span>,beta<span class="op">=</span><span class="va">b</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="other-prior-related-functions">Other Prior Related Functions<a class="anchor" aria-label="anchor" href="#other-prior-related-functions"></a>
</h4>
<p>Three additional functions relate to the prior specification and are
useful when either specifying the prior or when extracting the
information about the prior used by an existing model object.</p>
<p>*The Prior_Setup function</p>
<p>This function can be used to set up the prior arguments so they have
the correct dimensions and so that the various dimensions have names
that correspond to those in the model. In addition to initialized prior
structrues, these functions also return the model frame and the model
matrix as a reference (the latter when it was requested from the
underlying model). It is worth noting that this function is intended as
a tool for initializig the prior objects and not for setting them to the
final values used in the estimation. How to populate the arguments with
sensible values is discussed in a separate vignette.</p>
<p>NOTE: ADD A PRINT METHOD FOR THIS FUNCTION SO THAT THE OUTPUT CAN BE
CONTROLLED</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Prior_Setup.html">Prior_Setup</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span><span class="op">)</span></span></code></pre></div>
<p>*The Prior_Check function</p>
<p>The Prior Check function provides a utility for checking whether the
data appears to be consistent with the prior. Essentially, consistency
here means that the maximum likelihood estimate are within the credible
intervals implied by the prior. If the data appears inconsistent with
the data, it is possible that the data was generated from a different
process than that implied by the model or that the prior was not well
thought out. Specifying a good prior is usually important and we
dedicate a separate vignette to this topic.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glm.D93</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">counts</span> <span class="op">~</span> <span class="va">outcome</span> <span class="op">+</span> <span class="va">treatment</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/Prior_Check.html">Prior_Check</a></span><span class="op">(</span><span class="va">counts</span> <span class="op">~</span> <span class="va">outcome</span> <span class="op">+</span> <span class="va">treatment</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,<span class="fu"><a href="../reference/pfamily.html">dNormal</a></span><span class="op">(</span><span class="va">mu2</span>,<span class="va">Sigma2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>*The pfamily function</p>
<p>This function can be used to extract a pfamily object from an
existing object and is useful post-modeling in order to verify the prior
used in the modeling process. It is also used by some of the methods
during post-processing to extract information about the prior.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pfamily.html">pfamily</a></span><span class="op">(</span><span class="va">glmb.D93</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="method-functions">Method functions<a class="anchor" aria-label="anchor" href="#method-functions"></a>
</h3>
<p>The <em>lm</em> and <em>glm</em> functions come with an extensive set
of method functions that can be used to conduct supplemental analysis
(typically during the post-modeling phase). Because the <em>lmb</em> and
<em>glmb</em> functions are structured to return many of the same items
as the classical functions and because they inherit methods from
<em>glm</em> and <em>lm</em>, many of the methods available for the
classical functions are directly available for the <em>glmb</em> and
<em>lmb</em> functions. As some of the output does tend to be different
(in particular, coefficients are returned as random draws as opposed to
a single maximum likelihood estimate), we have implemented specific
methods for the “glmb” and “lmb” classes of objects. The current set of
methods for all four classes of objects are displayed below.</p>
<p>Two separate vignettes illustrate how calls to these methods can be
used to replicate the output from the classical models. It is worth
noting that a smaller subset of the classical methods are not yet
implemented (although plans are in place to replicate some of those as
well). Those are discussed in the separate vignette’s as well. Here we
provide lists of the methods available for classical <em>lm</em> and
<em>glm</em> functions (many of which are inherited by <em>lmb</em> and
<em>glmb</em>) as well as methods that have been developed specifically
for <em>glmb</em> and <em>rglmb</em>.</p>
<p>[NOTE: AS NEEDED, ADD ADDITIONAL METHODS FOR lmb. THE LIST OF METHODS
FOR glmb SHOULD BE FAIRLY COMPLETE]</p>
<p><em>Methods for class=“lm”</em></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class<span class="op">=</span><span class="st">"lm"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] add1           addterm        alias          anova          boxcox        </span></span>
<span><span class="co">#&gt;  [6] case.names     coerce         confint        cooks.distance deviance      </span></span>
<span><span class="co">#&gt; [11] dfbeta         dfbetas        drop1          dropterm       dummy.coef    </span></span>
<span><span class="co">#&gt; [16] effects        extractAIC     family         formula        hatvalues     </span></span>
<span><span class="co">#&gt; [21] influence      initialize     kappa          labels         logLik        </span></span>
<span><span class="co">#&gt; [26] logtrans       model.frame    model.matrix   nobs           plot          </span></span>
<span><span class="co">#&gt; [31] predict        print          proj           qr             residuals     </span></span>
<span><span class="co">#&gt; [36] rstandard      rstudent       show           simulate       slotsFromS3   </span></span>
<span><span class="co">#&gt; [41] summary        variable.names vcov          </span></span>
<span><span class="co">#&gt; see '?methods' for accessing help and source code</span></span></code></pre></div>
<p><em>Methods for class=“glm”</em></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class<span class="op">=</span><span class="st">"glm"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] add1           addterm        anova          coerce         confint       </span></span>
<span><span class="co">#&gt;  [6] cooks.distance deviance       drop1          dropterm       effects       </span></span>
<span><span class="co">#&gt; [11] extractAIC     family         formula        gamma.shape    influence     </span></span>
<span><span class="co">#&gt; [16] initialize     logLik         model.frame    nobs           predict       </span></span>
<span><span class="co">#&gt; [21] print          profile        residuals      rstandard      rstudent      </span></span>
<span><span class="co">#&gt; [26] show           sigma          slotsFromS3    summary        vcov          </span></span>
<span><span class="co">#&gt; [31] weights       </span></span>
<span><span class="co">#&gt; see '?methods' for accessing help and source code</span></span></code></pre></div>
<p><em>Methods for class=“glmb”</em></p>
<p>While most of the methods for the <em>glm</em> class (when it has its
own method) or the <em>lm</em> class (when it does not) work properly
for objects of class <em>glmb</em>, some methods do not. For that
reason, we have implemented the below methods specifically for the
<em>glmb</em> class of objects. Future enhancements to this package may
enhance these methods. There are also additional methods for <em>lm</em>
and/or <em>glm</em> that do not currently have functioning methods for
the <em>glmb</em> class. This includes the <em>add1</em>,
<em>drop1</em>, and <em>dropterm</em> functions (which should be
implementable fairly easily) and the various influence.measure methods
(influence, rstandard, rstudent, dfbeta, dfbetas, cooks.distance, and
hatvalues) which may require more work. Plans do exist to add the former
and perhaps the latter (which likely would look at influence on
posterior modes and not on posterior means).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class<span class="op">=</span><span class="st">"glmb"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] anova          case.names     confint        cooks.distance dfbetas       </span></span>
<span><span class="co">#&gt;  [6] dummy.coef     extractAIC     influence      logLik         predict       </span></span>
<span><span class="co">#&gt; [11] print          residuals      rstandard      rstudent       simulate      </span></span>
<span><span class="co">#&gt; [16] summary        variable.names vcov          </span></span>
<span><span class="co">#&gt; see '?methods' for accessing help and source code</span></span></code></pre></div>
<p>NOTE: CHECK WHICH METHODS FOR lmb that are inherited and functions
vs. those that may require additional development.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class<span class="op">=</span><span class="st">"lmb"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] print     residuals</span></span>
<span><span class="co">#&gt; see '?methods' for accessing help and source code</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="the-rlmb-and-rglmb-functions-and-their-summary-functions">The <em>rlmb</em> and <em>rglmb</em> functions and their summary
functions<a class="anchor" aria-label="anchor" href="#the-rlmb-and-rglmb-functions-and-their-summary-functions"></a>
</h2>
<p>Because the functions <em>lmb</em> and <em>glmb</em> are set up to
mirror their corresponding classical cousins, they include a great deal
of overhead for pre and post processing that are unsuitable if the
functions need to be called repetitively (say during Block-Gibbs
sampling). To faciliate Block-Gibbs sampling and other simulation, we
provide more minimalistic interfaces to the simulation procedures in the
form of the corresponding functions <em>rlmb</em> and
<em>rglmb</em>.</p>
<p>These functions are called internally by <em>lmb</em> and
<em>glmb</em> in much the same way that <em>lm.fit</em> and
<em>glm.fit</em> are called by the <em>lm</em> and <em>glm</em>
functions so in a way they are Bayesian versions of those functions. We
choose the r prefix for these functions to symbolize that they also
represent random draws from probability distributions in much the same
way that <em>rnorm</em>, <em>rgamma</em>, and other functions in the
<em>stats</em> package do.</p>
<div class="section level3">
<h3 id="calling-the-rlmb-and-rglmb-functions">Calling the <em>rlmb</em> and <em>rglmb</em> functions<a class="anchor" aria-label="anchor" href="#calling-the-rlmb-and-rglmb-functions"></a>
</h3>
<p>Instead of passing a formula to these functions, the user instead
passes the dependent and independent variables as a dependent variable
vector <em>y</em> and as an independent variable design matrix
<em>x</em> respectively. A useful approach that can help the user
specify the design matrix involves sequential calls to
<em>model.frame</em> and <em>model.matrix</em> as seen below.</p>
<p>NOTE 1: SHORTEN THIS CODE NOTE 2: The SUMMARY FUNCTION IS CURRENTLY
NOT WORKING FOR rlmb</p>
<p><em>Calling the rlmb function</em></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Annette Dobson (1990) "An Introduction to Generalized Linear Models".</span></span>
<span><span class="co">## Page 9: Plant Weight Data.</span></span>
<span><span class="va">ctl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.17</span>,<span class="fl">5.58</span>,<span class="fl">5.18</span>,<span class="fl">6.11</span>,<span class="fl">4.50</span>,<span class="fl">4.61</span>,<span class="fl">5.17</span>,<span class="fl">4.53</span>,<span class="fl">5.33</span>,<span class="fl">5.14</span><span class="op">)</span></span>
<span><span class="va">trt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.81</span>,<span class="fl">4.17</span>,<span class="fl">4.41</span>,<span class="fl">3.59</span>,<span class="fl">5.87</span>,<span class="fl">3.83</span>,<span class="fl">6.03</span>,<span class="fl">4.89</span>,<span class="fl">4.32</span>,<span class="fl">4.69</span><span class="op">)</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span>, <span class="fl">20</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ctl"</span>,<span class="st">"Trt"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">weight</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ctl</span>, <span class="va">trt</span><span class="op">)</span></span>
<span><span class="co">## Classical call</span></span>
<span><span class="va">lm.D9</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>,x<span class="op">=</span><span class="cn">TRUE</span>,y<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">lm_summary</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm.D9</span><span class="op">)</span></span>
<span><span class="co">## Bayesian Call</span></span>
<span><span class="va">n</span><span class="op">&lt;-</span><span class="fl">10000</span></span>
<span><span class="va">y</span><span class="op">&lt;-</span><span class="va">lm.D9</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="co">#x&lt;-as.matrix(lm.D9$x)</span></span>
<span></span>
<span><span class="co">### Set old regression and dispersion coefficients</span></span>
<span></span>
<span><span class="va">b_old</span><span class="op">=</span><span class="va">lm.D9</span><span class="op">$</span><span class="va">coefficients</span></span>
<span><span class="va">v_old</span><span class="op">=</span><span class="va">lm_summary</span><span class="op">$</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span></span>
<span></span>
<span><span class="co">#### Set up for rglmb_dispersion</span></span>
<span></span>
<span><span class="va">n0</span><span class="op">=</span><span class="fl">0.1</span></span>
<span><span class="va">shape</span><span class="op">=</span><span class="va">n0</span><span class="op">/</span><span class="fl">2</span></span>
<span><span class="va">rate</span><span class="op">=</span><span class="va">shape</span><span class="op">*</span><span class="va">v_old</span></span>
<span></span>
<span><span class="va">rate</span><span class="op">/</span><span class="op">(</span><span class="va">shape</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">rate</span><span class="op">/</span><span class="va">shape</span></span>
<span></span>
<span><span class="co">#a1&lt;-shape+n1/2</span></span>
<span><span class="co">#b1&lt;-rate+sum(SS)/2</span></span>
<span></span>
<span><span class="co">#out&lt;-1/rgamma(n,shape=a1,rate=b1)</span></span>
<span><span class="co">## v0=sum(SS)/n1 ~ (2*rate+sum(SS))/(2*shape+n1)=[(2*rate+sum(SS))/2]/((2*shape+n1)/2) </span></span>
<span><span class="va">n1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">SS</span><span class="op">=</span><span class="va">v_old</span><span class="op">*</span><span class="va">n1</span></span>
<span></span>
<span><span class="va">n1</span> <span class="co"># This is equal to 20</span></span>
<span></span>
<span></span>
<span><span class="va">n0</span><span class="op">=</span><span class="fl">2</span> <span class="co"># Prior observations</span></span>
<span><span class="va">v_prior</span><span class="op">=</span><span class="va">v_old</span>  <span class="co"># Prior point estimate for variance (the mean of (1/dispersion=1/v_prior))</span></span>
<span><span class="va">wt0</span><span class="op">=</span><span class="op">(</span><span class="va">n0</span><span class="op">/</span><span class="va">n1</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co">## set shape=0.01*(n1/2)</span></span>
<span><span class="co">## set rate= 0.01*SS/2</span></span>
<span></span>
<span><span class="va">shape</span><span class="op">=</span><span class="va">wt0</span><span class="op">*</span><span class="op">(</span><span class="va">n1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>   <span class="co">###  Shape is prior observations /2</span></span>
<span><span class="va">rate</span><span class="op">=</span><span class="va">shape</span><span class="op">*</span><span class="va">v_prior</span>  <span class="co">### rate is essentiall prior SS - V in rmultireg should be this</span></span>
<span><span class="va">rate</span><span class="op">/</span><span class="va">shape</span> <span class="co">## Should match v_prior (currently also v_old)</span></span>
<span></span>
<span><span class="va">mu</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">mu</span><span class="op">=</span><span class="va">b_old</span>  <span class="co">### For testing purposes, set prior=b_old</span></span>
<span><span class="va">P</span><span class="op">&lt;-</span><span class="fl">0.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># Bayesian Prior Setup and Call-Prior Should Generally be Customized</span></span>
<span><span class="va">p_info</span><span class="op">=</span><span class="fu"><a href="../reference/Prior_Setup.html">Prior_Setup</a></span><span class="op">(</span><span class="va">weight</span><span class="op">~</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="va">x</span><span class="op">=</span><span class="va">p_info</span><span class="op">$</span><span class="va">x</span></span>
<span><span class="va">outtemp4</span><span class="op">=</span><span class="fu"><a href="../reference/rlmb.html">rlmb</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1000</span>,y<span class="op">=</span><span class="va">y</span>,x<span class="op">=</span><span class="va">x</span>,pfamily<span class="op">=</span><span class="fu"><a href="../reference/pfamily.html">dNormal_Gamma</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu</span>,Sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span>,shape<span class="op">=</span><span class="va">shape</span>,rate<span class="op">=</span><span class="va">rate</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#summary(outtemp4)</span></span></code></pre></div>
<p><em>Calling the rglmb function</em></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">menarche2</span><span class="op">)</span></span>
<span><span class="va">Age2</span><span class="op">=</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Age</span><span class="op">-</span><span class="fl">13</span></span>
<span></span>
<span><span class="va">y</span><span class="op">=</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Menarche</span><span class="op">/</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Total</span></span>
<span><span class="va">wt</span><span class="op">=</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Total</span></span>
<span></span>
<span><span class="co">## Use model.frame and model.matrix to derive x</span></span>
<span><span class="co">#mf=model.frame(formula)</span></span>
<span><span class="co">#x=model.matrix(formula,mf)</span></span>
<span></span>
<span><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Age2</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="va">Age2</span></span>
<span></span>
<span><span class="co">## Modify Prior_Setup so it can take a model matrix as well as an model object</span></span>
<span><span class="va">mu</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fl">0.0</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">V1</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fl">2.0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mu</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">/</span><span class="fl">0.1</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span></span>
<span></span>
<span><span class="co"># 2 standard deviations for prior estimate at age 13 between 0.1 and 0.9</span></span>
<span><span class="co">## Specifies uncertainty around the point estimates</span></span>
<span></span>
<span><span class="va">V1</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">/</span><span class="fl">0.1</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> </span>
<span><span class="va">V1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="op">(</span><span class="fl">3</span><span class="op">*</span><span class="va">mu</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>  <span class="co"># Allows slope to be up to 3 times as large as point estimate </span></span>
<span></span>
<span><span class="va">out</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/rglmb.html">rglmb</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, y<span class="op">=</span><span class="va">y</span>, x<span class="op">=</span><span class="va">x</span>, pfamily<span class="op">=</span><span class="fu"><a href="../reference/pfamily.html">dNormal</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu</span>,Sigma<span class="op">=</span><span class="va">V1</span><span class="op">)</span>, weights <span class="op">=</span> <span class="va">wt</span>, </span>
<span>           family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="va">logit</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in eval(family$initialize): non-integer #successes in a binomial glm!</span></span>
<span><span class="co">#&gt; Call</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Prior Estimates with Standard Deviations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Prior.sd Approx.Prior.wt</span></span>
<span><span class="co">#&gt; [1,] 0.0000   1.0986           0.003</span></span>
<span><span class="co">#&gt; [2,] 0.7324   1.0986           0.003</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bayesian Estimates Based on 1000 iid draws</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      Post.Mode Post.Mean  Post.Sd MC Error Pr(tail)    </span></span>
<span><span class="co">#&gt; [1,]  -0.01070  -0.01180  0.06085        0 0.432567    </span></span>
<span><span class="co">#&gt; [2,]   1.62939   1.63259  0.05710        0 0.000999 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Distribution Percentiles</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          1.0%     2.5%     5.0%   Median    95.0%    97.5% 99.0%</span></span>
<span><span class="co">#&gt; [1,] -0.15862 -0.13124 -0.11419 -0.01168  0.08472  0.10503 0.131</span></span>
<span><span class="co">#&gt; [2,]  1.50322  1.52534  1.54001  1.63199  1.72728  1.73980 1.772</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="methods-for-the-rlmb-rglmb-and-their-summary-functions">Methods for The <em>rlmb</em>, <em>rglmb</em>, and their summary
functions<a class="anchor" aria-label="anchor" href="#methods-for-the-rlmb-rglmb-and-their-summary-functions"></a>
</h3>
<p>To allow for the output from the rglmb and rlmb functions to benefit
from the wide range of methods available for their <em>lmb</em> and
<em>glmb</em> cousins, we implement a few additional methods for these
functions that enable most of the methods to also work for these objects
post modeling.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class<span class="op">=</span><span class="st">"rglmb"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] deviance   extractAIC print      summary   </span></span>
<span><span class="co">#&gt; see '?methods' for accessing help and source code</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class<span class="op">=</span><span class="st">"summary.rglmb"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] formula print  </span></span>
<span><span class="co">#&gt; see '?methods' for accessing help and source code</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class<span class="op">=</span><span class="st">"rlmb"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] print</span></span>
<span><span class="co">#&gt; see '?methods' for accessing help and source code</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="advanced-topics">Advanced Topics<a class="anchor" aria-label="anchor" href="#advanced-topics"></a>
</h2>
<p>In this section, we cover additional functions included in the
package that most users likely would not call directly but which provide
visibility to the simulation methods utilized as part of the package.
These functions can be broadly broken down into four distinct
categories:.</p>
<ul>
<li>A set of simulation functions (one for each pfamily) that gets
called during the estimation process when the respective pfamily is
specified.</li>
<li>Two functions for the Central Normal Distribution that play a key
role in generating candidates for the envelope used to estimate some of
the models</li>
<li>A set of functions related to the envelope construction and
simulation from a model in Standard form that uses the envelope as part
of the simulation process</li>
<li>A set of utility functions used by various method functions to
produce the desired outputs</li>
</ul>
<div class="section level3">
<h3 id="simulation-functions">Simulation Functions<a class="anchor" aria-label="anchor" href="#simulation-functions"></a>
</h3>
<p>One of the key items returned by the <em>pfamily</em> functions is an
assigned simulation function to be called during the estimation process
(one for each pfamily). These functions can also be called directly
(though we don’t recommend it). The Function documentation for each of
these underlying functions contains information on the type of algorihm
used to generate the sample. We refer the reader to the documentation
for each of these functions but note the following relationship:</p>
<ul>
<li>The <em>rglmb_norm_reg</em> function is used for the
<em>dNormal</em> <em>pfamily</em>
</li>
<li>The <em>rglmb_dispersion</em> function is used for the
<em>dGamma</em> <em>pfamily</em>
</li>
<li>The <em>rnorm_gamma_reg</em> function is used for the
<em>dNormal_Gamma</em> <em>pfamily</em>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="normal_ct-functions">Normal_ct Functions<a class="anchor" aria-label="anchor" href="#normal_ct-functions"></a>
</h3>
<p>For estimation of Bayesian generalized linear models with Normal
Priors but non-gaussian families, accept-reject procedures are used
where candidates are generated from mixtures of restricted multivariate
normal distributions. Two functions for univariate restricted normal
distributions (<em>rnorm_ct</em> and <em>pnorm_ct</em>) play a key role
during this process and can be viewed as generalizations of the rnorm
and pnorm functions.</p>
</div>
<div class="section level3">
<h3 id="envelope-related-functions">Envelope Related Functions<a class="anchor" aria-label="anchor" href="#envelope-related-functions"></a>
</h3>
<p>For estimation of Bayesian generalized linear models with Normal
Priors but with non-gaussian families, there are a number of functions
that are used in order to generate the samples and that all in
one-way-or another are related to the Enveloping functions used. The
below is a list of these functions (we refer the reader to the
respective function documentation for details).</p>
<ul>
<li>
<em>glmb_Standardize_Model</em> standardizes a Bayesian Generalized
Linear Model so it can be sampled using an Enveloping function</li>
<li>
<em>EnvelopeBuild</em> builds the enveloping function used during
the simulation</li>
<li>
<em>EnvelopeOpt</em> selects an “optimal” size for the Grid used
during Envelope construction</li>
<li>
<em>EnvelopeSort</em> sorts the envelope after construction to
increade efficiency of the simulation</li>
<li>
<em>Set_Grid</em> calculates log-densities associated with the
restricted normals used to generate candidated</li>
<li>
<em>set_logP</em> calculates constans used during sampling from the
constructed envelope</li>
<li>
<em>rnnorm_reg_std</em> simulates from a standardized Bayesian
Generalized linear model using an Enveloping function</li>
<li>
<em>Neg_logLik</em> returns the Negative log-likelihood for a
Generalized Linear Model</li>
<li>
<em>Neg_logPost</em> returns the negative log-posterior for a
Bayesian Generalized Linear Model</li>
<li>
<em>Neg_logPost_Gradient</em> returns the Gradient for the Negative
Log-posteror of a Bayesian Generalized Linear Model</li>
</ul>
</div>
<div class="section level3">
<h3 id="utility-functions">Utility Functions<a class="anchor" aria-label="anchor" href="#utility-functions"></a>
</h3>
<p>Finally, the package contains a small set of functions that are used
by various method functions. While these are currently exported, we may
in the future choose not to export them as they are unlikely to be
useful for users of the package as standalone functions.</p>
<ul>
<li>Compare_Model_Frames</li>
<li>complete_newdata</li>
<li>generate_predictions</li>
<li>get_x_matrix</li>
<li>glmbdic</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kjell Nygren.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
