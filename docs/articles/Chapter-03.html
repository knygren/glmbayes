<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • glmbayes</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glmbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/chapter-01.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-02.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-03.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-04.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-05.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-06.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-07.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-08.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-09.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-10.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-11.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-A1.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-A2.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapter 3: Using the Prior_Setup and Prior_Check
Functions</h1>
                        <h4 data-toc-skip class="author">Kjell
Nygren</h4>
            
            <h4 data-toc-skip class="date">2025-07-14</h4>
      

      <div class="hidden name"><code>Chapter-03.Rmd</code></div>

    </div>

    
    
<p>Yaml</p>
<pre><code><span><span class="co">#&gt; Loading required package: MASS</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Warning in eval(family$initialize): non-integer #successes in a binomial glm!</span></span></code></pre>
<div class="section level2">
<h2 id="general-discussion">General Discussion<a class="anchor" aria-label="anchor" href="#general-discussion"></a>
</h2>
<p>In the previous chapter, we dealt with a relatively simple case where
it was obvious that the model of interest had two coefficients that were
to be estimated (an intercept and a slope tied to the Age variable). For
more complex models, it is common for the flexibility of the
<em>glm</em> and <em>glmb</em> formula setup to make it difficult for
the analyst to know the number of coefficients in the model prior to
actually running the model. This is particularly true in cases where
some variables are factors or if the formula involves interaction
terms.</p>
<p>Once a prior has been set, it can also be difficult to judge whether
it will have the kind of impact on the model the analyst may have
intended. This is particularly true if particular coefficients are hard
to interpret and the analyst is looking to provide what amounts to
*non-informative priors”. In some cases, a poorly formulated prior can
lead to conflicts between the prior and the data (i.e., cases where the
prior implies a very low prior probability of observing the observed
data).</p>
<p>To make it easier for the analyst to know the variable for which a
prior specification is needed and to allow him/her to flag potentially
problematic prior specifications, we provide two helper functions.</p>
<ul>
<li>
<em>Prior_Setup()</em> helps the analyst set up the proper
dimensions for the prior and provides a list of the variables in the
model that will require a prior specification</li>
<li>
<em>Prior_Check()</em> allows the analyst to examine if the data is
consistent with the prior specification</li>
</ul>
<p>We already used these briefly in the first chapter but now turn to a
more extensive discussion.</p>
</div>
<div class="section level2">
<h2 id="identifying-the-variables-that-need-a-prior-specification">Identifying the Variables that Need a Prior Specification<a class="anchor" aria-label="anchor" href="#identifying-the-variables-that-need-a-prior-specification"></a>
</h2>
<p>When a model is using just numeric (non-factor) variables without
interaction effects, the analyst can usually tell directly from the
model formula what the set of coefficients will be. However, when
factors are included and/or when interaction effects are included, this
becomes harder to know. The <em>Prior_Setup</em> functions helps with
this by pulling in the required information about the model variables
and by setting up the appropriate dimensions for the prior mean and
variance-covariance objects.</p>
<p>#Model With Factors#</p>
<p>Let’s return to the Dobson Poisson data from the first chapter. Both
the outcome and treatment variables were coded as factors using the gl
function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Dobson (1990) Page 93: Randomized Controlled Trial :</span></span>
<span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">18</span>,<span class="fl">17</span>,<span class="fl">15</span>,<span class="fl">20</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">25</span>,<span class="fl">13</span>,<span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">9</span><span class="op">)</span></span>
<span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">d.AD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">treatment</span>, <span class="va">outcome</span>, <span class="va">counts</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   treatment outcome counts</span></span>
<span><span class="co">#&gt; 1         1       1     18</span></span>
<span><span class="co">#&gt; 2         1       2     17</span></span>
<span><span class="co">#&gt; 3         1       3     15</span></span>
<span><span class="co">#&gt; 4         2       1     20</span></span>
<span><span class="co">#&gt; 5         2       2     10</span></span>
<span><span class="co">#&gt; 6         2       3     20</span></span>
<span><span class="co">#&gt; 7         3       1     25</span></span>
<span><span class="co">#&gt; 8         3       2     13</span></span>
<span><span class="co">#&gt; 9         3       3     12</span></span></code></pre></div>
<p>Using the Prior_Setup function for the model formula shows us that
the model we are looking to estimate will have 5 coefficients. There is
an intercept, two coefficients related to the outcome variable, and two
coefficients related to the treatment variable.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#glm.D93 &lt;- glm(counts ~ outcome + treatment, family = poisson(),x=TRUE)</span></span>
<span></span>
<span></span>
<span><span class="va">Setup.D93</span><span class="op">=</span><span class="fu"><a href="../reference/Prior_Setup.html">Prior_Setup</a></span><span class="op">(</span><span class="va">counts</span> <span class="op">~</span> <span class="va">outcome</span> <span class="op">+</span> <span class="va">treatment</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Variable names are:"</span></span>
<span><span class="co">#&gt; [1] "(Intercept)" "outcome2"    "outcome3"    "treatment2"  "treatment3"</span></span></code></pre></div>
<p>Printing the output from the Prior_Check function gives us a printed
view of the initialized prior as well as the model.frame and
model.matrix (see below). From the latter two, we can see that the first
level of outcome and treatment (in this case the factor level=1) has
been used as a reference category and that the other two levels have
been given dummy variables in the model.</p>
<p>In terms of the prior specification, the above has the implication
that the prior means for variables 2 and 3 in the model should represent
prior point estimate for how much larger (or smaller) we believe the
counts would be for categories 2 and 3 relative to category 1 (on the
log scale). If our prior point estimates on the other hand were 0, we
could leave the prior at the initialized levels of 0 and instead give it
reasonable prior credible sets for how large the difference might be.
Since we are working on the log-scale, it if worth noting that our prior
really is a point estimate for how much larger (or smaller) in
percentage terms we expect the counts to be.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">Setup.D93</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mu</span></span>
<span><span class="co">#&gt;                   mu</span></span>
<span><span class="co">#&gt; (Intercept) 16.66667</span></span>
<span><span class="co">#&gt; outcome2     0.00000</span></span>
<span><span class="co">#&gt; outcome3     0.00000</span></span>
<span><span class="co">#&gt; treatment2   0.00000</span></span>
<span><span class="co">#&gt; treatment3   0.00000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Sigma</span></span>
<span><span class="co">#&gt;             (Intercept) outcome2 outcome3 treatment2 treatment3</span></span>
<span><span class="co">#&gt; (Intercept)           1        0        0          0          0</span></span>
<span><span class="co">#&gt; outcome2              0        1        0          0          0</span></span>
<span><span class="co">#&gt; outcome3              0        0        1          0          0</span></span>
<span><span class="co">#&gt; treatment2            0        0        0          1          0</span></span>
<span><span class="co">#&gt; treatment3            0        0        0          0          1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $model</span></span>
<span><span class="co">#&gt;   counts outcome treatment</span></span>
<span><span class="co">#&gt; 1     18       1         1</span></span>
<span><span class="co">#&gt; 2     17       2         1</span></span>
<span><span class="co">#&gt; 3     15       3         1</span></span>
<span><span class="co">#&gt; 4     20       1         2</span></span>
<span><span class="co">#&gt; 5     10       2         2</span></span>
<span><span class="co">#&gt; 6     20       3         2</span></span>
<span><span class="co">#&gt; 7     25       1         3</span></span>
<span><span class="co">#&gt; 8     13       2         3</span></span>
<span><span class="co">#&gt; 9     12       3         3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;   (Intercept) outcome2 outcome3 treatment2 treatment3</span></span>
<span><span class="co">#&gt; 1           1        0        0          0          0</span></span>
<span><span class="co">#&gt; 2           1        1        0          0          0</span></span>
<span><span class="co">#&gt; 3           1        0        1          0          0</span></span>
<span><span class="co">#&gt; 4           1        0        0          1          0</span></span>
<span><span class="co">#&gt; 5           1        1        0          1          0</span></span>
<span><span class="co">#&gt; 6           1        0        1          1          0</span></span>
<span><span class="co">#&gt; 7           1        0        0          0          1</span></span>
<span><span class="co">#&gt; 8           1        1        0          0          1</span></span>
<span><span class="co">#&gt; 9           1        0        1          0          1</span></span>
<span><span class="co">#&gt; attr(,"assign")</span></span>
<span><span class="co">#&gt; [1] 0 1 1 2 2</span></span>
<span><span class="co">#&gt; attr(,"contrasts")</span></span>
<span><span class="co">#&gt; attr(,"contrasts")$outcome</span></span>
<span><span class="co">#&gt; [1] "contr.treatment"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"contrasts")$treatment</span></span>
<span><span class="co">#&gt; [1] "contr.treatment"</span></span></code></pre></div>
<p>#Model With Factors and Interactions#</p>
<p>Let’s now take a look at a model with factors and interactions from
Venables and Ripley (2002). The classical model specified by Venables
and Ripley specified a two-factor <em>sex</em> variable and interacts
<em>sex</em> with an <em>ldose</em> variable. We again use the
Prior_Setup function to see that the resulting <em>model.matrix</em> has
4 columns, labeled as “(Intercept)”, “sexM”, “ldose”, and
“sexM:ldose”.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## example from Venables and Ripley (2002, pp. 190-2.)</span></span>
<span><span class="va">ldose</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">numdead</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">9</span>, <span class="fl">13</span>, <span class="fl">18</span>, <span class="fl">20</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">6</span>, <span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="st">"F"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">SF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">numdead</span>, numalive <span class="op">=</span> <span class="fl">20</span><span class="op">-</span><span class="va">numdead</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Setup.budworm</span><span class="op">=</span><span class="fu"><a href="../reference/Prior_Setup.html">Prior_Setup</a></span><span class="op">(</span><span class="va">SF</span> <span class="op">~</span> <span class="va">sex</span><span class="op">*</span><span class="va">ldose</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Variable names are:"</span></span>
<span><span class="co">#&gt; [1] "(Intercept)" "sexM"        "ldose"       "sexM:ldose"</span></span></code></pre></div>
<p>Reviewing the full printed output, we see that the intercept
corresponds to <em>Females</em> at ldose=0. The <em>sex</em> dummy for
<em>males</em> represent how much higher (or lower) the percentage dead
would be for males at ldose=0. The <em>ldose</em> variable in turn
represents the linear impact of ldose for females (so the slope), while
the interaction variable represents how much larger (or smaller) the
slope would be for males.</p>
<p>Any useful prior here should either use meaninful prior information
for these coefficients based on any other available information or
insights or be weak enough to greatly overlap with the distribution of
the coefficients implied by the data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">Setup.budworm</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mu</span></span>
<span><span class="co">#&gt;             mu</span></span>
<span><span class="co">#&gt; (Intercept) 10</span></span>
<span><span class="co">#&gt; sexM         0</span></span>
<span><span class="co">#&gt; ldose        0</span></span>
<span><span class="co">#&gt; sexM:ldose   0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Sigma</span></span>
<span><span class="co">#&gt;             (Intercept) sexM ldose sexM:ldose</span></span>
<span><span class="co">#&gt; (Intercept)           1    0     0          0</span></span>
<span><span class="co">#&gt; sexM                  0    1     0          0</span></span>
<span><span class="co">#&gt; ldose                 0    0     1          0</span></span>
<span><span class="co">#&gt; sexM:ldose            0    0     0          1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $model</span></span>
<span><span class="co">#&gt;    SF.numdead SF.numalive sex ldose</span></span>
<span><span class="co">#&gt; 1           1          19   M     0</span></span>
<span><span class="co">#&gt; 2           4          16   M     1</span></span>
<span><span class="co">#&gt; 3           9          11   M     2</span></span>
<span><span class="co">#&gt; 4          13           7   M     3</span></span>
<span><span class="co">#&gt; 5          18           2   M     4</span></span>
<span><span class="co">#&gt; 6          20           0   M     5</span></span>
<span><span class="co">#&gt; 7           0          20   F     0</span></span>
<span><span class="co">#&gt; 8           2          18   F     1</span></span>
<span><span class="co">#&gt; 9           6          14   F     2</span></span>
<span><span class="co">#&gt; 10         10          10   F     3</span></span>
<span><span class="co">#&gt; 11         12           8   F     4</span></span>
<span><span class="co">#&gt; 12         16           4   F     5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;    (Intercept) sexM ldose sexM:ldose</span></span>
<span><span class="co">#&gt; 1            1    1     0          0</span></span>
<span><span class="co">#&gt; 2            1    1     1          1</span></span>
<span><span class="co">#&gt; 3            1    1     2          2</span></span>
<span><span class="co">#&gt; 4            1    1     3          3</span></span>
<span><span class="co">#&gt; 5            1    1     4          4</span></span>
<span><span class="co">#&gt; 6            1    1     5          5</span></span>
<span><span class="co">#&gt; 7            1    0     0          0</span></span>
<span><span class="co">#&gt; 8            1    0     1          0</span></span>
<span><span class="co">#&gt; 9            1    0     2          0</span></span>
<span><span class="co">#&gt; 10           1    0     3          0</span></span>
<span><span class="co">#&gt; 11           1    0     4          0</span></span>
<span><span class="co">#&gt; 12           1    0     5          0</span></span>
<span><span class="co">#&gt; attr(,"assign")</span></span>
<span><span class="co">#&gt; [1] 0 1 2 3</span></span>
<span><span class="co">#&gt; attr(,"contrasts")</span></span>
<span><span class="co">#&gt; attr(,"contrasts")$sex</span></span>
<span><span class="co">#&gt; [1] "contr.treatment"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="checking-for-prior-data-conflicts-ahead-of-model-estimation">Checking For Prior-Data Conflicts Ahead of Model Estimation<a class="anchor" aria-label="anchor" href="#checking-for-prior-data-conflicts-ahead-of-model-estimation"></a>
</h2>
<p>As we noted in the previous chapter, it is critical for coefficients
to the interpretable in order for analysts to be able to provide
sensible priors. In some cases, efforts aimed at enhancing
interpretation through model transformations or efforts aimed at
gathering meaningful prior information can be difficult and/or time
consuming. Unfortunately, this leaves open the possibility for analysts
to specify priors that end up having more influence on the posterior
estimates than they may have intended. This is particularly problematic
in cases where the anayst is attempting to use what might best be
described as a “non-informative prior”.</p>
<p>To catch some of these cases we provide a Prior_Check function that
looks to see if the maximum likelihood estimates seem to conflict with
the prior specification. In particular, the functions checks if the
prior Bayesian credible interval has overlap with the confidence
interval based on the maximum likelihood estimate.</p>
<p>Conceptually, this approach is similar to that described in <span class="citation">(Evans and Moshonov 2006)</span>. Here are a few
examples implementing this approach:</p>
<p><em>Our prior Specification From Chapter 2</em></p>
<p>We first run the checks for our original specification (this assumes
code in the previous Chapter has been run). The resulting check just
indicates that the maximum likelihood estimates are roughly consistent
with the prior. This is mainly because the maximum likelihood estimate
for the slope, while different from our prior estimate, was still well
within the prior credible interval.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Prior_Check.html">Prior_Check</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Menarche</span>, <span class="va">Total</span><span class="op">-</span><span class="va">Menarche</span><span class="op">)</span> <span class="op">~</span> <span class="va">Age2</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="va">logit</span><span class="op">)</span>,pfamily<span class="op">=</span><span class="fu"><a href="../reference/pfamily.html">dNormal</a></span><span class="op">(</span><span class="va">mu1</span>,<span class="va">V1</span><span class="op">)</span>,data<span class="op">=</span><span class="va">Menarche_Model_Data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Variables in the Model Are:"</span></span>
<span><span class="co">#&gt; [1] "(Intercept)" "Age2"       </span></span>
<span><span class="co">#&gt; [1] "The maximum likelihood estimates for all coefficients appear to be roughly consistent with the prior."</span></span>
<span><span class="co">#&gt;              abs_ratio</span></span>
<span><span class="co">#&gt; (Intercept) 0.01326148</span></span>
<span><span class="co">#&gt; Age2        0.84405989</span></span></code></pre></div>
<p><em>Same prior but original Age variable </em></p>
<p>Here we run a model with the same prior but with the original Age
variable. This now indicates a potential problem. A prior point estimate
for half of all girls having had their first period is clearly
non-sensical, but it would clearly be difficult to provide any kind of
sensible prior point estimate that far out of the range of the data.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Prior_Check.html">Prior_Check</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Menarche</span>, <span class="va">Total</span><span class="op">-</span><span class="va">Menarche</span><span class="op">)</span> <span class="op">~</span> <span class="va">Age</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="va">logit</span><span class="op">)</span>,pfamily<span class="op">=</span><span class="fu"><a href="../reference/pfamily.html">dNormal</a></span><span class="op">(</span><span class="va">mu1</span>,<span class="va">V1</span><span class="op">)</span></span>
<span>,data<span class="op">=</span><span class="va">Menarche_Model_Data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Variables in the Model Are:"</span></span>
<span><span class="co">#&gt; [1] "(Intercept)" "Age"        </span></span>
<span><span class="co">#&gt; [1] "At least one of the maximum likelihood estimates appears to be inconsistent with the prior"</span></span>
<span><span class="co">#&gt;              abs_ratio</span></span>
<span><span class="co">#&gt; (Intercept) 10.7273082</span></span>
<span><span class="co">#&gt; Age          0.8440599</span></span></code></pre></div>
<p>Let’s take a look what would have happened to our estimates if we
would have proceeded with this model specification.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">glmb.out2</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/glmb.html">glmb</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10000</span>,<span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Menarche</span>, <span class="va">Total</span><span class="op">-</span><span class="va">Menarche</span><span class="op">)</span> <span class="op">~</span> <span class="va">Age</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="va">logit</span><span class="op">)</span>,pfamily<span class="op">=</span><span class="fu"><a href="../reference/pfamily.html">dNormal</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu1</span>,Sigma<span class="op">=</span><span class="va">V1</span><span class="op">)</span>,data<span class="op">=</span><span class="va">Menarche_Model_Data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in eval(family$initialize): non-integer #successes in a binomial glm!</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">glmb.out2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call</span></span>
<span><span class="co">#&gt; glmb(formula = cbind(Menarche, Total - Menarche) ~ Age, family = binomial(logit), </span></span>
<span><span class="co">#&gt;     pfamily = dNormal(mu = mu1, Sigma = V1), n = 10000, data = Menarche_Model_Data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expected Deviance Residuals:</span></span>
<span><span class="co">#&gt;       1       2       3       4       5       6       7       8       9      10 </span></span>
<span><span class="co">#&gt; -6.9638 -7.2743 -5.6452 -5.8679 -5.4197 -4.7708 -4.7569 -4.1073 -4.5682 -1.9785 </span></span>
<span><span class="co">#&gt;      11      12      13      14      15      16      17      18      19      20 </span></span>
<span><span class="co">#&gt; -1.3604 -0.6687 -1.5264  0.7336  2.8731  1.6269  1.9073  4.3885  4.6216  3.2433 </span></span>
<span><span class="co">#&gt;      21      22      23      24      25 </span></span>
<span><span class="co">#&gt;  3.9821  3.4185  3.3077  3.3514  7.5402 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Prior and Maximum Likelihood Estimates with Standard Deviations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           Prior Mean Prior.sd Max Like. Like.sd</span></span>
<span><span class="co">#&gt; Intercept     0.0000   0.4323  -21.2264   0.771</span></span>
<span><span class="co">#&gt; Age2          1.0986   0.3252    1.6320   0.059</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bayesian Estimates Based on 10000 iid draws</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Post.Mode Post.Mean  Post.Sd MC Error Pr(tail)    </span></span>
<span><span class="co">#&gt; (Intercept)  -9.64349  -9.65089  0.24832        0   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; Age           0.75302   0.75358  0.01896        0   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Distribution Percentiles</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                 1.0%     2.5%     5.0%   Median    95.0%    97.5%  99.0%</span></span>
<span><span class="co">#&gt; (Intercept) -10.2342 -10.1406 -10.0636  -9.6503  -9.2413  -9.1702 -9.088</span></span>
<span><span class="co">#&gt; Age           0.7097   0.7167   0.7222   0.7535   0.7853   0.7914  0.798</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Effective Number of Parameters: 1.668396 </span></span>
<span><span class="co">#&gt; Expected Residual Deviance: 462.7533 </span></span>
<span><span class="co">#&gt; DIC: 548.4735 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expected Mean dispersion: 1 </span></span>
<span><span class="co">#&gt; Sq.root of Expected Mean dispersion: 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean Likelihood Subgradient Candidates Per iid sample: 1.2418</span></span></code></pre></div>
<p>Under this specification, the Intercept standard deviation was much
higher than under the original specification, and as a result the
posterior estimates (mode and mean) end up somewhere in between the
prior mean and maximum likelihood estimates. However, the posterior
credible interval suggests that both the prior and the maximum
likelihood estimates are inconsistent with the posterior distribution.
Because the posterior estimates for the intercept are much higher than
the very negative) maximum likelihood estimate, the posterior
coefficients for the Age variable is cut roughly in half relative to our
other original model and the Deviance residuals are much larger than
those we see if we go back to review the output from the original model.
Clearly, this would not be a model that should be run so catching
potential issues ahead of the fact (as we did using our above approach)
would be important.</p>
<p><em>Same Age and Variance but 0 mean vector </em></p>
<p>Here we run a model with the same Age variable as in our original
specification but with a 0 prior mean vector combined with the original
Variance-Covariance matrix. This now also indicates a potential problem.
Looking at the details from the summary function, we see that the issue
now is with the slope parameter instead of the mean but the magnitude of
the issue appears to be less as the ratio is smaller.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu2</span><span class="op">=</span><span class="va">mu1</span></span>
<span><span class="va">mu2</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">0</span></span>
<span></span>
<span><span class="va">pc</span><span class="op">=</span><span class="fu"><a href="../reference/Prior_Check.html">Prior_Check</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Menarche</span>, <span class="va">Total</span><span class="op">-</span><span class="va">Menarche</span><span class="op">)</span> <span class="op">~</span> <span class="va">Age2</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="va">logit</span><span class="op">)</span>,pfamily<span class="op">=</span><span class="fu"><a href="../reference/pfamily.html">dNormal</a></span><span class="op">(</span><span class="va">mu2</span>,<span class="va">V1</span><span class="op">)</span></span>
<span>,data<span class="op">=</span><span class="va">Menarche_Model_Data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Variables in the Model Are:"</span></span>
<span><span class="co">#&gt; [1] "(Intercept)" "Age2"       </span></span>
<span><span class="co">#&gt; [1] "At least one of the maximum likelihood estimates appears to be inconsistent with the prior"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pc</span><span class="op">)</span></span>
<span><span class="co">#&gt;              abs_ratio</span></span>
<span><span class="co">#&gt; (Intercept) 0.01326148</span></span>
<span><span class="co">#&gt; Age2        2.58266313</span></span></code></pre></div>
<p>Let’s proceed with running the model to see how it compares to the
original model.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glmb.out3</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/glmb.html">glmb</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10000</span>,<span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Menarche</span>, <span class="va">Total</span><span class="op">-</span><span class="va">Menarche</span><span class="op">)</span> <span class="op">~</span> <span class="va">Age2</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="va">logit</span><span class="op">)</span>,pfamily<span class="op">=</span><span class="fu"><a href="../reference/pfamily.html">dNormal</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu2</span>,Sigma<span class="op">=</span><span class="va">V1</span><span class="op">)</span>,data<span class="op">=</span><span class="va">Menarche_Model_Data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in eval(family$initialize): non-integer #successes in a binomial glm!</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">glmb.out3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call</span></span>
<span><span class="co">#&gt; glmb(formula = cbind(Menarche, Total - Menarche) ~ Age2, family = binomial(logit), </span></span>
<span><span class="co">#&gt;     pfamily = dNormal(mu = mu2, Sigma = V1), n = 10000, data = Menarche_Model_Data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expected Deviance Residuals:</span></span>
<span><span class="co">#&gt;        1        2        3        4        5        6        7        8 </span></span>
<span><span class="co">#&gt; -1.35657 -2.17366 -1.98079 -0.97056 -1.14471 -0.32337  0.05067  0.60503 </span></span>
<span><span class="co">#&gt;        9       10       11       12       13       14       15       16 </span></span>
<span><span class="co">#&gt; -0.67872  1.26862  1.14950  0.92242 -1.03228  0.19284  1.40752 -0.84586 </span></span>
<span><span class="co">#&gt;       17       18       19       20       21       22       23       24 </span></span>
<span><span class="co">#&gt; -1.00824  1.27761  0.80679 -0.66048 -0.25683 -0.70668 -0.31614 -0.56762 </span></span>
<span><span class="co">#&gt;       25 </span></span>
<span><span class="co">#&gt;  1.23994 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Prior and Maximum Likelihood Estimates with Standard Deviations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           Prior Mean Prior.sd Max Like. Like.sd</span></span>
<span><span class="co">#&gt; Intercept    0.00000  0.43229  -0.01081   0.063</span></span>
<span><span class="co">#&gt; Age2         0.00000  0.32521   1.63197   0.059</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bayesian Estimates Based on 10000 iid draws</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Post.Mode Post.Mean  Post.Sd MC Error Pr(tail)    </span></span>
<span><span class="co">#&gt; (Intercept)  -0.01992  -0.02022  0.06123        0    0.365    </span></span>
<span><span class="co">#&gt; Age2          1.57967   1.58406  0.05540        0    1e-04 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Distribution Percentiles</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                 1.0%     2.5%     5.0%   Median    95.0%    97.5% 99.0%</span></span>
<span><span class="co">#&gt; (Intercept) -0.16230 -0.13883 -0.12107 -0.02064  0.08132  0.09885 0.122</span></span>
<span><span class="co">#&gt; Age2         1.45811  1.47964  1.49458  1.58327  1.67636  1.69396 1.717</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Effective Number of Parameters: 1.925404 </span></span>
<span><span class="co">#&gt; Expected Residual Deviance: 29.33759 </span></span>
<span><span class="co">#&gt; DIC: 115.3148 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expected Mean dispersion: 1 </span></span>
<span><span class="co">#&gt; Sq.root of Expected Mean dispersion: 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean Likelihood Subgradient Candidates Per iid sample: 1.2695</span></span></code></pre></div>
<p>In reviewing the output, we can now see that the impact of this
specification on the results relative to the original model is
relatively small. Because the prior mean for the slope is so far away
from the maximum likelihood estimate, the posterior estimate for the
slope does get pulled away a bit more from the maximum likelihood
estimate than under the original specification (about one standard
deviation if we use the posterior standard deviation) but in relation to
the overall magnitude of the coefficient, this is not all that big of an
impact.</p>
<p>In the case of this particular model, we had some (although
imprecise) prior insight into the fact that the slope should be positive
and of a somewhat reasonable magnitude. In other applications, the
analyst may indeed not have any clear insight into the magnitude or even
the sign of some of the coefficients. In such cases, specifying a prior
with 0 mean can indeed make some sense. Setting the prior standard
deviation/variance sufficiently large can in such cases present some
challenges. Using our Prior check to see if the prior standard
deviation/variance is sufficiently large can in such cases be a sensible
alternative that can facilitate adjustments to the prior.</p>
<p>Let’s look at what would have happened to our results if we scaled
the prior standard deviation for the slope up based on the ratio from
our model check.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">V2</span><span class="op">=</span><span class="va">V1</span></span>
<span><span class="va">V2</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="op">(</span><span class="va">pc</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">sd_slope</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="co">#glmb.out4&lt;-glmb(n=10000,cbind(Menarche, Total-Menarche) ~ #Age2,family=binomial(logit),mu=mu2,Sigma=V2,data=Menarche_Model_Data)</span></span>
<span><span class="va">glmb.out4</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/glmb.html">glmb</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10000</span>,<span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Menarche</span>, <span class="va">Total</span><span class="op">-</span><span class="va">Menarche</span><span class="op">)</span> <span class="op">~</span> <span class="va">Age2</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="va">logit</span><span class="op">)</span>,pfamily<span class="op">=</span><span class="fu"><a href="../reference/pfamily.html">dNormal</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu2</span>,Sigma<span class="op">=</span><span class="va">V2</span><span class="op">)</span>,data<span class="op">=</span><span class="va">Menarche_Model_Data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in eval(family$initialize): non-integer #successes in a binomial glm!</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">glmb.out4</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call</span></span>
<span><span class="co">#&gt; glmb(formula = cbind(Menarche, Total - Menarche) ~ Age2, family = binomial(logit), </span></span>
<span><span class="co">#&gt;     pfamily = dNormal(mu = mu2, Sigma = V2), n = 10000, data = Menarche_Model_Data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expected Deviance Residuals:</span></span>
<span><span class="co">#&gt;        1        2        3        4        5        6        7        8 </span></span>
<span><span class="co">#&gt; -1.25343 -2.05330 -1.88668 -0.82165 -1.01050 -0.17633  0.21255  0.76287 </span></span>
<span><span class="co">#&gt;        9       10       11       12       13       14       15       16 </span></span>
<span><span class="co">#&gt; -0.55549  1.36015  1.19880  0.91870 -1.09080  0.07932  1.25427 -1.04802 </span></span>
<span><span class="co">#&gt;       17       18       19       20       21       22       23       24 </span></span>
<span><span class="co">#&gt; -1.21394  1.08452  0.59056 -0.86825 -0.46482 -0.89776 -0.47180 -0.72735 </span></span>
<span><span class="co">#&gt;       25 </span></span>
<span><span class="co">#&gt;  1.11689 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Prior and Maximum Likelihood Estimates with Standard Deviations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           Prior Mean Prior.sd Max Like. Like.sd</span></span>
<span><span class="co">#&gt; Intercept    0.00000  0.43229  -0.01081   0.063</span></span>
<span><span class="co">#&gt; Age2         0.00000  0.83991   1.63197   0.059</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bayesian Estimates Based on 10000 iid draws</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Post.Mode Post.Mean  Post.Sd MC Error Pr(tail)    </span></span>
<span><span class="co">#&gt; (Intercept)  -0.01199  -0.01198  0.06229        0    0.419    </span></span>
<span><span class="co">#&gt; Age2          1.62400   1.62827  0.05795        0    1e-04 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Distribution Percentiles</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                 1.0%     2.5%     5.0%   Median    95.0%    97.5% 99.0%</span></span>
<span><span class="co">#&gt; (Intercept) -0.15761 -0.13611 -0.11497 -0.01246  0.08914  0.11168 0.132</span></span>
<span><span class="co">#&gt; Age2         1.49752  1.51470  1.53403  1.62784  1.72381  1.74494 1.773</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Effective Number of Parameters: 1.947528 </span></span>
<span><span class="co">#&gt; Expected Residual Deviance: 28.65534 </span></span>
<span><span class="co">#&gt; DIC: 114.6547 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expected Mean dispersion: 1 </span></span>
<span><span class="co">#&gt; Sq.root of Expected Mean dispersion: 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean Likelihood Subgradient Candidates Per iid sample: 1.2723</span></span></code></pre></div>
<p>While we will leave a formal discussion of the DIC <span class="citation">(Spiegelhalter et al. 2002)</span> to a later chapter,
we here produce a summary of how the models fitted so far compare on the
measure (generally, a smaller DIC tends to be preferred). We can see
below that the model using the Regular Age variable by this crteria
peforms particularly poorly. We can also see that our last model with an
adjusted variance term perfoms better than the one with a stronger prior
centered away from the maximum likelihood estimate. The original model
specifications has a DIC very similar to the final model.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DIC_Out</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/extractAIC.html" class="external-link">extractAIC</a></span><span class="op">(</span><span class="va">glmb.out1</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/extractAIC.html" class="external-link">extractAIC</a></span><span class="op">(</span><span class="va">glmb.out2</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/extractAIC.html" class="external-link">extractAIC</a></span><span class="op">(</span><span class="va">glmb.out3</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/extractAIC.html" class="external-link">extractAIC</a></span><span class="op">(</span><span class="va">glmb.out4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">DIC_Out</span><span class="op">)</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pD"</span>,<span class="st">"DIC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">DIC_Out</span><span class="op">)</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Original Specification"</span>,<span class="st">"Regular Age"</span>,<span class="st">"Slope Mean=0 - No Var Adjustment"</span>,</span>
<span>                     <span class="st">"Slope Mean=0 - Var Adjustment"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">DIC_Out</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                        pD      DIC</span></span>
<span><span class="co">#&gt; Original Specification           1.944884 114.7053</span></span>
<span><span class="co">#&gt; Regular Age                      1.668396 548.4735</span></span>
<span><span class="co">#&gt; Slope Mean=0 - No Var Adjustment 1.925404 115.3148</span></span>
<span><span class="co">#&gt; Slope Mean=0 - Var Adjustment    1.947528 114.6547</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Evans2006" class="csl-entry">
Evans, Michael, and Hadas Moshonov. 2006. <span>“Checking for Prior-Data
Conflict.”</span> <em>Bayesian Analysis</em> 1 (4): 893–914. <a href="https://doi.org/10.1214/06-BA129" class="external-link">https://doi.org/10.1214/06-BA129</a>.
</div>
<div id="ref-nygren2006" class="csl-entry">
Nygren, Kjell, and Lan Ma Nygren. 2006. <span>“Likelihood Subgradient
Densities.”</span> <em>Journal of the American Statistical
Association</em> 101 (475): 1144–56. <a href="https://doi.org/10.1198/016214506000000357" class="external-link">https://doi.org/10.1198/016214506000000357</a>.
</div>
<div id="ref-Spiegelhalter2002" class="csl-entry">
Spiegelhalter, David J., Nicola G. Best, Bradley P. Carlin, and Angelika
Van Der Linde. 2002. <span>“Bayesian Measures of Model Complexity and
Fit.”</span> <em>Journal of the Royal Statistical Society Series B
(Statistical Methodology)</em> 64 (4): 583–639. <a href="https://doi.org/10.1111/1467-9868.00353" class="external-link">https://doi.org/10.1111/1467-9868.00353</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kjell Nygren.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
