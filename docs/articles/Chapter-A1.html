<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • glmbayes</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glmbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/chapter-01.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-02.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-03.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-04.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-05.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-06.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-07.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-08.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-09.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-10.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-11.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-A1.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-A2.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapter A1: Overview of Estimation
Procedures</h1>
                        <h4 data-toc-skip class="author">Kjell
Nygren</h4>
            
            <h4 data-toc-skip class="date">2025-07-14</h4>
      

      <div class="hidden name"><code>Chapter-A1.Rmd</code></div>

    </div>

    
    
<p>Yaml</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">glmbayes</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: MASS</span></span></code></pre></div>
<div class="section level2">
<h2 id="general-discussion">General Discussion<a class="anchor" aria-label="anchor" href="#general-discussion"></a>
</h2>
<p>The estimation procedures implemented in this package can divided
into the following four distinct categories:</p>
<ul>
<li>Finding posterior modes</li>
<li>Simulating from models with with conjugate priors</li>
<li>Generating iid samples for log-concave models with non-conjugate
Normal, Gamma, or Independent_Normal_Gamma priors</li>
<li>Bounding Distances to posterior densities for two-block Gibbs
samplers</li>
</ul>
<p>In this vingette, we provide a brief overview of how these procedures
are implemented. It is worth noting that the combination of these four
approaches likely can be applied to wider range of models and future
plans for this package include the implementation of additional
models.</p>
</div>
<div class="section level2">
<h2 id="finding-posterior-modes">Finding Posterior Modes<a class="anchor" aria-label="anchor" href="#finding-posterior-modes"></a>
</h2>
<p>Finding posterior modes is an important first component for most of
the implemented sampling procedures in this package. The posterior modes
are returned as part of the output itself from many of the core
functions and are also used to center many of the sampling procedures
implemented so they also help determine the accuracy and speed of
underlying sampling procedures. The process for fiding posterior modes
work a bit differently depending on the <em>family</em> and
<em>pfamily</em> in question. Our subsections here describe the
currently implemented approaches</p>
<div class="section level3">
<h3 id="posterior-modes-for-the-gaussian-family-combined-with-either-the-dnormal-or-dnormal_gamma-pfamilies">Posterior Modes for the <em>gaussian()</em> family combined with
either the <em>dNormal()</em> or <em>dNormal_Gamma()</em> pfamilies<a class="anchor" aria-label="anchor" href="#posterior-modes-for-the-gaussian-family-combined-with-either-the-dnormal-or-dnormal_gamma-pfamilies"></a>
</h3>
<p>In this case, the posterior modes have closed form solutions that
also correspond to the posterior means for the posterior distributions.
Moreover, using proper priors ensure that the modes always exists
(unlike the classical case where unique maximum likelihood estimates
might not exist). The concern in this case is mainly with ensuring
numerical accuracy, especially in cases where the model might have many
variables or where the resulting model coefficients (despite the prior)
might be poorly identified.</p>
<p>Our implemented process for finding posterior modes essentially
involves the following steps</p>
<ul>
<li>Perform a Cholesky decomposition for the prior precision (inverse
variance-covariance)</li>
<li>Use the Cholesky decomposition to add additional “prior”
observations to the dataset</li>
<li>Use the <em>lm.fit</em> or <em>lm.wfit</em> functions for the
modified dataset in order to return resulting posterior mode
estimates</li>
</ul>
<p>The source codes <em>rnorm_reg_cpp.cpp</em> (for the
<em>dNormal()</em> prior) and <em>rNormal_reg.wfit.R</em> (for the
<em>dNormal_Gamma()</em> Prior) shows the current version of these
implementations. Note that the <em>rNormal_reg.wfit</em> function is
called from within the <em>rNormal_Gamma_reg</em> function in order to
find the posterior mode.</p>
<p>In addition to having the benefit of the robust estimation procedures
built into the <em>lm.fit</em> and <em>lm.wfit</em> functions, calling
these functions also have the added benefit of returning the components
needed to have access to the various influence related methods available
for classes <em>lm</em> and <em>glm</em>.</p>
</div>
<div class="section level3">
<h3 id="posterior-modes-for-non-gaussian-families-combined-with-the-dnormal-pfamily-">Posterior Modes for <em>non-gaussian</em> families combined with the
<em>dNormal()</em> pfamily.<a class="anchor" aria-label="anchor" href="#posterior-modes-for-non-gaussian-families-combined-with-the-dnormal-pfamily-"></a>
</h3>
<p>In this case, there is no closed form solution for the posterior
mode. Our current implementation (see the source code
<em>rnnorm_reg_cpp.cpp</em>) leverages a call to the <em>optim</em>
function with the <em>method=“BFGS”</em> and <em>hessian=TRUE</em>
options in order to attempt to find the posterior mode. The
<em>“BFGS”</em> method [Add reference] is a quasi-Newton method (also
known as a variable metric algorithm) that uses function values and
gradients to build up a picture of the surface optimized. The
<em>hessian=TRUE</em> option returns an approximation for the hessian
associated with the negative of the log-posterior density which is
leveraged during standardization of the model prior to the simuation
phase (see the section “Generating iid Samples for Non-Conjugate
Families” below for details) for these models.</p>
<p>While the posterior mode is derived using the above method (and used
as the estimate for the posterior mode), our <em>rNormal_reg</em>
function also uses a call to the <em>glmb.wfit</em> function in order to
get the output needed for the influence measures. This implements a
similar procedure to that in the <em>glm.fit</em> function before doing
a single call to the <em>lm.fit</em> function. Similar to the procedure
in the <em>gaussian()</em> family case above, the data provided to the
<em>lm.fit</em> function has additional added observations (based on a
Cholesky decomposition). We refer the reader to the source codes for the
<em>glm.fit</em> and <em>glmb.wfit</em> for the details on the
similarities and differences between the two functions. Essentially, the
latter assumes that the posterior mode has alredy been reached (using
the calls to the optim function) so no iterations are therefore
required.</p>
</div>
<div class="section level3">
<h3 id="conditional-posterior-modes-for-the-gaussian-family-combined-with-the-dindependent_normal_gamma-pfamily-">Conditional Posterior Modes for the <em>gaussian</em> family
combined with the <em>dIndependent_Normal_Gamma()</em> pfamily.<a class="anchor" aria-label="anchor" href="#conditional-posterior-modes-for-the-gaussian-family-combined-with-the-dindependent_normal_gamma-pfamily-"></a>
</h3>
<p>The rIndependent_Normal_Gamma_reg procedure currently uses an initial
iterative process where the coefficients and dispersion are
conditionally optimized in order to arrive at a good centering of
candidate densities for the simulation. The conditional optimization of
the coefficients in this process relies on the same process as in the
other <em>gaussian()</em> family case above. The shape and rate
parameters for the candidate gamma distribution are in turn set based on
the expected <em>RSS</em> based on simulation from the conditional
densitiy associated with the conditionally optimized coefficients (see
the current source code <em>rIndependent_Normal_Gamma_Reg.R</em> for
details).</p>
<p>Plese note that the methods implemented for this prior should be
regarded as still being in the developemental/experimental phase. The
current implementation appears to yield valid <em>iid</em> samples at
reasonable speeds for some of our smaller models, but it is unclear how
well this will perform for larger models and methods may be adjusted in
the future to improve performance.</p>
</div>
</div>
<div class="section level2">
<h2 id="simulating-from-models-with-conjugate-priors">Simulating from Models With Conjugate priors<a class="anchor" aria-label="anchor" href="#simulating-from-models-with-conjugate-priors"></a>
</h2>
<p>Three of the currently implemented combinations of <em>families</em>
and <em>pfamilies</em> involves what is known in the literature as
conjugate prior distributions where the posterior distributions take on
the same well known probability distribution as the prior distributions
[ADD REFERENCES]. These models are</p>
<ul>
<li>The <em>gaussian()</em> family with a <em>dNormal()</em> pfamily
prior for the regression coefficients</li>
<li>The <em>gaussian()</em> family with a <em>dGamma()</em> pfamily
prior for the inverse dispersion (precision) parameter</li>
<li>The <em>gaussian()</em> family with a <em>dNormal_Gamma()</em>
pfamily prior the regression coefficienst and inverse dispersion
parameter.</li>
</ul>
<p>Simulation in these cases reduces to simulation from <em>multivariate
normal</em> and/or <em>gamma</em> distributions and the main concern is
ensuring numerical accuracy and speed for the resulting simulation. We
refer the reader to the source codes <em>rnorm_reg_cpp.cpp</em>,
<em>rgamma_reg.R</em>, and <em>rNormal_Gamma_reg</em> for details on the
current implementation of these simulation procedures in the current
package.</p>
</div>
<div class="section level2">
<h2 id="generating-iid-samples-for-non-conjugate-families">Generating iid Samples for Non-Conjugate Families<a class="anchor" aria-label="anchor" href="#generating-iid-samples-for-non-conjugate-families"></a>
</h2>
<p>The most innovative components of the current package likely involves
the procedures implemented in order to generate <em>iid</em> samples
from models with various non-gaussian families combined with
<em>dNormal()</em> pfamily priors as well as for models combining the
<em>gaussian()</em> family with <em>dIndependent_Normal_Gamma()</em>
pfamily prior distributions. In addititon the package contains an
<em>iid</em> sampling procedure for the <em>Gamma()</em> family with a
<em>dGamma()</em> pfamily prior for the dispersion parameter. We discuss
each of these at a high level here and provide references to additional
details for those interested.</p>
<div class="section level3">
<h3 id="non-gaussian-families-with-normal-priors">Non-gaussian families with Normal Priors<a class="anchor" aria-label="anchor" href="#non-gaussian-families-with-normal-priors"></a>
</h3>
<p>When the specified <em>family</em> is any log-concave non-gaussian
family, then the estimation uses the Likelihood subgradient density
approach of Nygren and Nygren (2006). This approaches uses tangencies to
the log-likelihood function in order to construct an enveloping function
from which candidate draws are generated and then either
accepted/rejected using accept/reject methods. The core C function
performing this simulation essentially goes through the following
steps:</p>
<ol style="list-style-type: decimal">
<li><p>The model is standardized to have prior mean vector equal to 0
(i.e., offsets and any prior mean are combined into a constant
term).</p></li>
<li><p>The posterior mode for this transformed model is found. Currently
this uses the <em>optim</em> function. Later implementations may replace
this with iteratively reweighted least squares (IWLS) to increase
consistency with the <em>glm</em> function and to enhance numerical
accuracy.</p></li>
<li><p>The model is further standardized so that (a) the precision
matrix at the posterior mode is diagonal and (b) the prior
variance-covariance matrix is the identity matrix (see the documentation
<em>glmb_Standardize_Model</em> and the discussion below for
details).</p></li>
<li><p>An enveloping function is built for the the standardized model,
containing constants needed during simulation (see the documentation
<em>EnvelopeBuild</em> and the discussion below for details).</p></li>
<li><p>Samples for the standardized model are generated using
accept-reject methods (see the documentation for <em>rnnorm_reg_std</em>
and the discussion below for details).</p></li>
<li><p>The output from the standardized model are transformed back to
the original scale by reversing the two eigenvalue decompositions and by
adding back the prior mean.</p></li>
</ol>
<p>The below code chunks provide a more detailed illustration of the
estimation process</p>
<p><strong>Setup of Data and Prior</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">menarche2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Age2</span><span class="op">=</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Age</span><span class="op">-</span><span class="fl">13</span></span>
<span><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Age2</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="va">Age2</span></span>
<span></span>
<span><span class="va">y</span><span class="op">=</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Menarche</span><span class="op">/</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Total</span></span>
<span><span class="va">wt</span><span class="op">=</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Total</span></span>
<span></span>
<span><span class="va">mu</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fl">0.0</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mu</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">/</span><span class="fl">0.1</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span></span>
<span><span class="va">V1</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fl">2.0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2 standard deviations for prior estimate at age 13 between 0.1 and 0.9</span></span>
<span><span class="co">## Specifies uncertainty around the point estimates</span></span>
<span></span>
<span><span class="va">V1</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">/</span><span class="fl">0.1</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> </span>
<span><span class="va">V1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="op">(</span><span class="fl">3</span><span class="op">*</span><span class="va">mu</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>  <span class="co"># Allows slope to be up to 1 times as large as point estimate </span></span>
<span></span>
<span><span class="va">dispersion2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span></span>
<span><span class="va">offset2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fl">0.0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">P</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">V1</span><span class="op">)</span></span>
<span><span class="va">n</span><span class="op">=</span><span class="fl">1000</span></span></code></pre></div>
<p><strong>Gathering of family functions Used in process</strong></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">famfunc</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/glmbfamfunc.html">glmbfamfunc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="va">logit</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">f1</span><span class="op">&lt;-</span><span class="va">famfunc</span><span class="op">$</span><span class="va">f1</span></span>
<span><span class="va">f2</span><span class="op">&lt;-</span><span class="va">famfunc</span><span class="op">$</span><span class="va">f2</span>  <span class="co"># Used in optim and glmbsim_cpp</span></span>
<span><span class="va">f3</span><span class="op">&lt;-</span><span class="va">famfunc</span><span class="op">$</span><span class="va">f3</span>  <span class="co"># Used in optim</span></span>
<span><span class="va">f5</span><span class="op">&lt;-</span><span class="va">famfunc</span><span class="op">$</span><span class="va">f5</span></span>
<span><span class="va">f6</span><span class="op">&lt;-</span><span class="va">famfunc</span><span class="op">$</span><span class="va">f6</span></span></code></pre></div>
<p><strong>Finding the posterior mode</strong></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">start</span> <span class="op">&lt;-</span> <span class="va">mu</span></span>
<span></span>
<span><span class="co">###### Adjust weight for dispersion</span></span>
<span></span>
<span><span class="va">wt2</span><span class="op">=</span><span class="va">wt</span><span class="op">/</span><span class="va">dispersion2</span></span>
<span></span>
<span></span>
<span><span class="co">######################### Shift mean vector to offset so that adjusted model has 0 mean</span></span>
<span></span>
<span><span class="va">alpha</span><span class="op">=</span><span class="va">x</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">+</span><span class="va">offset2</span></span>
<span><span class="va">mu2</span><span class="op">=</span><span class="fl">0</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span></span>
<span><span class="va">P2</span><span class="op">=</span><span class="va">P</span></span>
<span><span class="va">x2</span><span class="op">=</span><span class="va">x</span></span>
<span></span>
<span></span>
<span><span class="co">#####  Optimization step to find posterior mode and associated Precision</span></span>
<span></span>
<span><span class="va">parin</span><span class="op">=</span><span class="va">start</span><span class="op">-</span><span class="va">mu</span></span>
<span></span>
<span><span class="va">opt_out</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="va">parin</span>,<span class="va">f2</span>,<span class="va">f3</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,mu<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">mu2</span><span class="op">)</span>,</span>
<span>              P<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span>,alpha<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>,wt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">wt2</span><span class="op">)</span>,</span>
<span>              method<span class="op">=</span><span class="st">"BFGS"</span>,hessian<span class="op">=</span><span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">bstar</span><span class="op">=</span><span class="va">opt_out</span><span class="op">$</span><span class="va">par</span>  <span class="co">## Posterior mode for adjusted model</span></span>
<span><span class="va">bstar</span> <span class="co"># Mode from Optimization</span></span>
<span><span class="co">#&gt;             [,1]</span></span>
<span><span class="co">#&gt; [1,] -0.01069645</span></span>
<span><span class="co">#&gt; [2,]  0.89698197</span></span>
<span><span class="va">bstar</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span>  <span class="co"># Mode for actual model</span></span>
<span><span class="co">#&gt;             [,1]</span></span>
<span><span class="co">#&gt; [1,] -0.01069645</span></span>
<span><span class="co">#&gt; [2,]  1.62939016</span></span>
<span><span class="va">A1</span><span class="op">=</span><span class="va">opt_out</span><span class="op">$</span><span class="va">hessian</span> <span class="co"># Approximate Precision at mode</span></span>
<span><span class="va">A1</span></span>
<span><span class="co">#&gt;            [,1]       [,2]</span></span>
<span><span class="co">#&gt; [1,] 252.463770   7.286465</span></span>
<span><span class="co">#&gt; [2,]   7.286465 290.021317</span></span></code></pre></div>
<p><strong>Standardizing the Model</strong></p>
<p>This functions starts with basic information about the model in the
argument list and then uses the following steps to further standardize
the model (the model is already assumed to have a 0 prior mean vector
when this step is applied).</p>
<ol style="list-style-type: decimal">
<li><p>An eigenvalue composition is applied to the posterior precision
matrix, and the model is (as an interim step) standardized to have a
posterior precision matrix equal to the identity matrix. Please note
that this means that the prior precision matrix after this step is
<em>“smaller”</em> than the identity matrix.</p></li>
<li><p>A diagonal matrix epsilon is pulled out from the standardized
prior precision matrix so that the remaining part of the prior precision
matrix still is positive definite. That part is then treated as part of
the posterior for the rest of the standardization and simulation and
only the part connected to epsilon is treated as part of the prior. Note
that the exact epsilon chosen seems not to matter. Hence there are many
possible ways of doing this standardization and future versions of this
package may tweak the current approach if it helps improve numerical
accuracy or acceptance rates.</p></li>
<li><p>The model is next standardized (using a second eigenvalue
decomposition) so that the prior (i.e., the portion connected to
epsilon) is the identity matrix. The standardized model then
simutaneously has the feature that the prior precision matrix is the
identity matrix and that the data precision A (at the posterior mode) is
a diagonal matrix. Hence the variables in the standardized model are
approximately independent at the posterior mode.</p></li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Standardize Model</span></span>
<span></span>
<span><span class="va">Standard_Mod</span><span class="op">=</span><span class="fu"><a href="../reference/glmb_Standardize_Model.html">glmb_Standardize_Model</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,P<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span>,</span>
<span>                                    bstar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">bstar</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, A1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">A1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bstar2</span><span class="op">=</span><span class="va">Standard_Mod</span><span class="op">$</span><span class="va">bstar2</span>  </span>
<span><span class="va">A</span><span class="op">=</span><span class="va">Standard_Mod</span><span class="op">$</span><span class="va">A</span></span>
<span><span class="va">x2</span><span class="op">=</span><span class="va">Standard_Mod</span><span class="op">$</span><span class="va">x2</span></span>
<span><span class="va">mu2</span><span class="op">=</span><span class="va">Standard_Mod</span><span class="op">$</span><span class="va">mu2</span></span>
<span><span class="va">P2</span><span class="op">=</span><span class="va">Standard_Mod</span><span class="op">$</span><span class="va">P2</span></span>
<span><span class="va">L2Inv</span><span class="op">=</span><span class="va">Standard_Mod</span><span class="op">$</span><span class="va">L2Inv</span></span>
<span><span class="va">L3Inv</span><span class="op">=</span><span class="va">Standard_Mod</span><span class="op">$</span><span class="va">L3Inv</span></span></code></pre></div>
<p><strong>Building the Envelope</strong></p>
<p>To construct an enveloping function, we follow the approach in Nygren
and Nygren (2006) which involves the following steps when a maximally
sized grid is constructed (if the prior for some dimensions is
relatively strong, this may not be needed)</p>
<ol style="list-style-type: decimal">
<li><p>For each dimension, a constant <em>omega_i</em> is found that
depends on the corresponding diagonal element in the precision
matrix.</p></li>
<li><p>Corresponding intervals <em>(thetastar_i-0.5
omega,thetastar_i-0.5 omega)</em> are constructed around the posterior
mode thetastar for each dimension</p></li>
<li><p>The mode as well as the points <em>thetastar_i-omega_i</em> and
<em>thetastar_i+omega_i</em> are selected as the components of the
points at which tangencies will be found for each of the
dimensions.</p></li>
<li><p>A Grid is constructed with all possible combinations of points
and negative log-likelihood and gradient for the negative log-likelihood
are evaluated (see the EnvelopeBuild_c.cpp function source code for
details)</p></li>
<li><p>The <em>Set_Grid</em> function is called in order to evaluate the
log of the density associated with each of the resulting restricted
multivariate normals by evaluating the differences between the
cummulative density for each dimension between its lower and upper
bound.</p></li>
<li><p>The Set_LogP function is called in order to help set the
probabilities with which each of the components of the grid should be
sampled (see remark 6 in Nygren and Nygren (2006)).</p></li>
</ol>
<p>Any constants needed by the sampling are added to a list and returned
by the function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">Env2</span><span class="op">=</span><span class="fu"><a href="../reference/EnvelopeBuild.html">EnvelopeBuild</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">bstar2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>,<span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">mu2</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">P2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">wt2</span><span class="op">)</span>,</span>
<span>                   family<span class="op">=</span><span class="st">"binomial"</span>,link<span class="op">=</span><span class="st">"logit"</span>,Gridtype<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, </span>
<span>                   n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,sortgrid<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">Env2</span></span>
<span><span class="co">#&gt; $GridIndex</span></span>
<span><span class="co">#&gt;   GIndex.Var1 GIndex.Var2</span></span>
<span><span class="co">#&gt; 5           2           2</span></span>
<span><span class="co">#&gt; 6           3           2</span></span>
<span><span class="co">#&gt; 8           2           3</span></span>
<span><span class="co">#&gt; 2           2           1</span></span>
<span><span class="co">#&gt; 4           1           2</span></span>
<span><span class="co">#&gt; 9           3           3</span></span>
<span><span class="co">#&gt; 3           3           1</span></span>
<span><span class="co">#&gt; 7           1           3</span></span>
<span><span class="co">#&gt; 1           1           1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $thetabars</span></span>
<span><span class="co">#&gt;     G3.Var1    G3.Var2</span></span>
<span><span class="co">#&gt; 5 0.5662049 0.11300265</span></span>
<span><span class="co">#&gt; 6 0.6195287 0.11300265</span></span>
<span><span class="co">#&gt; 8 0.5662049 0.17044504</span></span>
<span><span class="co">#&gt; 2 0.5662049 0.05556027</span></span>
<span><span class="co">#&gt; 4 0.5128810 0.11300265</span></span>
<span><span class="co">#&gt; 9 0.6195287 0.17044504</span></span>
<span><span class="co">#&gt; 3 0.6195287 0.05556027</span></span>
<span><span class="co">#&gt; 7 0.5128810 0.17044504</span></span>
<span><span class="co">#&gt; 1 0.5128810 0.05556027</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cbars</span></span>
<span><span class="co">#&gt;       cbars.1     cbars.2</span></span>
<span><span class="co">#&gt; 5  -0.5661981  -0.1130015</span></span>
<span><span class="co">#&gt; 6  34.4621159  -0.2437098</span></span>
<span><span class="co">#&gt; 8  -1.4475523  34.1689246</span></span>
<span><span class="co">#&gt; 2  -1.4796882 -35.3623598</span></span>
<span><span class="co">#&gt; 4 -40.7542186  -0.2682291</span></span>
<span><span class="co">#&gt; 9  33.3865305  32.4873204</span></span>
<span><span class="co">#&gt; 3  33.8979746 -33.8580716</span></span>
<span><span class="co">#&gt; 7 -41.3722300  35.7125259</span></span>
<span><span class="co">#&gt; 1 -42.1074002 -37.3119403</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $logU</span></span>
<span><span class="co">#&gt;        logU.1      logU.2</span></span>
<span><span class="co">#&gt; 5   -3.850428   -3.776049</span></span>
<span><span class="co">#&gt; 6 -618.902574   -3.784589</span></span>
<span><span class="co">#&gt; 8   -4.238723 -593.065539</span></span>
<span><span class="co">#&gt; 2   -4.267555 -626.754407</span></span>
<span><span class="co">#&gt; 4 -813.223858   -3.788093</span></span>
<span><span class="co">#&gt; 9 -581.745276 -536.732343</span></span>
<span><span class="co">#&gt; 3 -599.269541 -574.773949</span></span>
<span><span class="co">#&gt; 7 -838.283187 -647.262791</span></span>
<span><span class="co">#&gt; 1 -868.590223 -697.486001</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $logrt</span></span>
<span><span class="co">#&gt;        logrt.1      logrt.2</span></span>
<span><span class="co">#&gt; 5   -0.6721049   -0.6704936</span></span>
<span><span class="co">#&gt; 6 -618.9025745   -0.5738821</span></span>
<span><span class="co">#&gt; 8   -0.2008155 -593.0655394</span></span>
<span><span class="co">#&gt; 2   -0.1906419    0.0000000</span></span>
<span><span class="co">#&gt; 4    0.0000000   -0.5569172</span></span>
<span><span class="co">#&gt; 9 -581.7452759 -536.7323432</span></span>
<span><span class="co">#&gt; 3 -599.2695410    0.0000000</span></span>
<span><span class="co">#&gt; 7    0.0000000 -647.2627913</span></span>
<span><span class="co">#&gt; 1    0.0000000    0.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loglt</span></span>
<span><span class="co">#&gt;        loglt.1      loglt.2</span></span>
<span><span class="co">#&gt; 5   -0.6720943   -0.6704918</span></span>
<span><span class="co">#&gt; 6    0.0000000   -0.7778690</span></span>
<span><span class="co">#&gt; 8   -1.6277922    0.0000000</span></span>
<span><span class="co">#&gt; 2   -1.6735097 -626.7544071</span></span>
<span><span class="co">#&gt; 4 -813.2238580   -0.7992502</span></span>
<span><span class="co">#&gt; 9    0.0000000    0.0000000</span></span>
<span><span class="co">#&gt; 3    0.0000000 -574.7739490</span></span>
<span><span class="co">#&gt; 7 -838.2831866    0.0000000</span></span>
<span><span class="co">#&gt; 1 -868.5902230 -697.4860009</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $LLconst</span></span>
<span><span class="co">#&gt; [1] 55.87862 35.14719 51.52363 59.36200 77.55426 31.17893 38.32546 72.77690</span></span>
<span><span class="co">#&gt; [9] 81.36520</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $logP</span></span>
<span><span class="co">#&gt; [1]    -7.626477  -622.687163  -597.304262  -631.021962  -817.011951</span></span>
<span><span class="co">#&gt; [6] -1118.477619 -1174.043490 -1485.545978 -1566.076224</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $PLSD</span></span>
<span><span class="co">#&gt; [1] 0.24960979 0.13063173 0.12594361 0.12363622 0.11925255 0.06975357 0.06737136</span></span>
<span><span class="co">#&gt; [8] 0.05788189 0.05591928</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $a1</span></span>
<span><span class="co">#&gt; [1] 702.3746 605.1290</span></span></code></pre></div>
<p><strong>Simulating From the Standard Model</strong></p>
<p>This function uses the information contained in the constructed
envelope list in order to sample from a model in standard form. The
simulation proceeds as follows in order to generate each draw in the
required number of samples.</p>
<ol style="list-style-type: decimal">
<li><p>A random number between 0 and 1 is generated and is used together
with the information in the PLSD vector (from the envelope) in order to
identify the part of the grid from which a candidate is to be
generated.</p></li>
<li><p>For the part of the grid selected, the dimensions are looped
through and a candidate component for each dimension is generated from a
restricted normal using information from the Envelope (in particular,
the values for logrt, loglt, and cbars corresponding to that the part of
the grid selected and the dimension sampled)</p></li>
<li><p>The log-likelihood for the standardized model is evaluated for
the generated candidate (note that the log-likelihood here includes the
portion of the prior that was shifted to the log-likelihood as part of
the standardization procedure)</p></li>
<li><p>An additional random number is generated and the log of this
random number is compared to a log-acceptance rate that is calculated
based on the candidate and the LLconst component from the Envelope
component selected in order to determine if the candidate should be
accepted or rejected</p></li>
<li><p>If the candidate was not accepted, the process above is repeated
from step 1 until a candidate is accepted</p></li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">sim</span><span class="op">=</span><span class="fu"><a href="../reference/rnnorm_reg_std.html">rnnorm_reg_std</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span>,mu<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">mu2</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                   P<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">P2</span><span class="op">)</span>,alpha<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>,wt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">wt2</span><span class="op">)</span>,</span>
<span>                   f2<span class="op">=</span><span class="va">f2</span>,Envelope<span class="op">=</span><span class="va">Env2</span>,family<span class="op">=</span><span class="st">"binomial"</span>,link<span class="op">=</span><span class="st">"logit"</span>,<span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Undoing the standardization</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">out</span><span class="op">=</span><span class="va">L2Inv</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">L3Inv</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">out</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">out</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="va">out</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">+</span><span class="va">mu</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        V1                 V2       </span></span>
<span><span class="co">#&gt;  Min.   :-0.17635   Min.   :1.450  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.05598   1st Qu.:1.592  </span></span>
<span><span class="co">#&gt;  Median :-0.01549   Median :1.630  </span></span>
<span><span class="co">#&gt;  Mean   :-0.01448   Mean   :1.629  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.02398   3rd Qu.:1.666  </span></span>
<span><span class="co">#&gt;  Max.   : 0.18664   Max.   :1.825</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">draws</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.287</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="gaussian-families-with-independent_normal_gamma-prior">gaussian families with Independent_Normal_Gamma Prior<a class="anchor" aria-label="anchor" href="#gaussian-families-with-independent_normal_gamma-prior"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 id="bounding-distances-to-target-densities-for-two-block-gibbs-samplers">Bounding Distances to Target Densities for Two-Block Gibbs
Samplers<a class="anchor" aria-label="anchor" href="#bounding-distances-to-target-densities-for-two-block-gibbs-samplers"></a>
</h2>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kjell Nygren.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
