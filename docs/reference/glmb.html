<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fitting Bayesian Generalized Linear Models — glmb • glmbayes</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting Bayesian Generalized Linear Models — glmb"><meta property="og:description" content="glmb is used to fit Bayesian generalized linear models, specified by giving a symbolic descriptions of
the linear predictor,  the error distribution, and the prior distribution."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glmbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/chapter-01.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-02.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-03.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-04.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-05.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-06.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-07.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-08.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-09.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-10.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-11.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-A1.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-A2.html">UNKNOWN TITLE</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fitting Bayesian Generalized Linear Models</h1>

    <div class="hidden name"><code>glmb.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>glmb</code> is used to fit Bayesian generalized linear models, specified by giving a symbolic descriptions of
the linear predictor,  the error distribution, and the prior distribution.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">glmb</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  family <span class="op">=</span> <span class="va">binomial</span>,</span>
<span>  pfamily <span class="op">=</span> <span class="fu"><a href="pfamily.html">dNormal</a></span><span class="op">(</span><span class="va">mu</span>, <span class="va">Sigma</span>, dispersion <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">subset</span>,</span>
<span>  <span class="va">offset</span>,</span>
<span>  <span class="va">na.action</span>,</span>
<span>  Gridtype <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">etastart</span>,</span>
<span>  <span class="va">mustart</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"glm.fit"</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  contrasts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'glmb'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>an object of class <code>"<a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a>"</code> (or one that
    can be coerced to that class): a symbolic description of the
    model to be fitted.  The details of model specification are given
    under ‘Details’.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>a description of the error distribution and link
    function to be used in the model.  For <code>glm</code> this can be a
    character string naming a family function, a family function or the
    result of a call to a family function.  For <code>glm.fit</code> only the
    third option is supported.  (See <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code> for details of
    family functions.)</p></dd>


<dt id="arg-pfamily">pfamily<a class="anchor" aria-label="anchor" href="#arg-pfamily"></a></dt>
<dd><p>a description of the prior distribution and associated constants to be used in the model. This
should be a pfamily function (see <code><a href="pfamily.html">pfamily</a></code> for details of pfamily functions).</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>number of draws to generate. If <code>length(n) &gt; 1</code>, the length is taken to be the number required.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an optional data frame, list or environment (or object
    coercible by <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></code> to a data frame) containing
    the variables in the model.  If not found in <code>data</code>, the
    variables are taken from <code>environment(formula)</code>,
    typically the environment from which <code>glm</code> is called.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>an optional vector of ‘prior weights’ to be used
    in the fitting process.  Should be <code>NULL</code> or a numeric vector.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>an optional vector specifying a subset of observations to be used in the fitting process.</p></dd>


<dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>this can be used to specify an <em>a priori</em> known component to be included in the linear
predictor during fitting. This should be <code>NULL</code> or a numeric vector of length equal to the number of
cases.  One or more <code><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></code> terms can be included in the formula instead or as well, and
if more than one is specified their sum is used.  See documentation for <code>model.offset</code> at
<code><a href="https://rdrr.io/r/stats/model.extract.html" class="external-link">model.extract</a></code>.</p></dd>


<dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>a function which indicates what should happen when the data contain <code>NA</code>s.  The default is set by
the <code>na.action</code> setting of <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></code>, and is <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.fail</a></code>
if that is unset.  The ‘factory-fresh’ default is <code>stats{na.omit}</code>.
Another possible value is <code>NULL</code>, no action.  Value <code>stats{na.exclude}</code>
can be useful.</p></dd>


<dt id="arg-gridtype">Gridtype<a class="anchor" aria-label="anchor" href="#arg-gridtype"></a></dt>
<dd><p>an optional argument specifying the method used to determine the number of tangent points used to construct the enveloping function.</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>starting values for the parameters in the linear predictor.</p></dd>


<dt id="arg-etastart">etastart<a class="anchor" aria-label="anchor" href="#arg-etastart"></a></dt>
<dd><p>starting values for the linear predictor.</p></dd>


<dt id="arg-mustart">mustart<a class="anchor" aria-label="anchor" href="#arg-mustart"></a></dt>
<dd><p>starting values for the vector of means.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>a list of parameters for controlling the fitting
    process.  For <code>glm.fit</code> this is passed to
    <code><a href="https://rdrr.io/r/stats/glm.control.html" class="external-link">glm.control</a></code>.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>a logical value indicating whether <em>model frame</em>
    should be included as a component of the returned value.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>the method to be used in fitting the model.  The default
    method <code>"glm.fit"</code> uses iteratively reweighted least squares
    (IWLS): the alternative <code>"model.frame"</code> returns the model frame
    and does no fitting.</p>
<p>User-supplied fitting functions can be supplied either as a function
    or a character string naming a function, with a function which takes
    the same arguments as <code>glm.fit</code>.  If specified as a character
    string it is looked up from within the <span class="pkg">stats</span> namespace.</p></dd>


<dt id="arg-x-y">x, y<a class="anchor" aria-label="anchor" href="#arg-x-y"></a></dt>
<dd><p>For <code>glm</code>:
    logical values indicating whether the response vector and model
    matrix used in the fitting process should be returned as components
    of the returned value.</p>
<p>For <code>glm.fit</code>: <code>x</code> is a design matrix of dimension
    <code>n * p</code>, and <code>y</code> is a vector of observations of length
    <code>n</code>.</p></dd>


<dt id="arg-contrasts">contrasts<a class="anchor" aria-label="anchor" href="#arg-contrasts"></a></dt>
<dd><p>an optional list. See the <code>contrasts.arg</code>
    of <code>model.matrix.default</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>For <code>glm</code>: arguments to be used to form the default
    <code>control</code> argument if it is not supplied directly.</p>
<p>For <code>weights</code>: further arguments passed to or from other methods.</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>the number of significant digits to use when printing.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>glmb</code> returns an object of class <code>"glmb"</code>. The function <code>summary</code> (i.e.,
<code><a href="summary.glmb.html">summary.glmb</a></code>) can be used to obtain or print a summary of the results.  The generic accessor functions
<code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></code>, <code><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted.values</a></code>, <code><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></code>, and <code><a href="https://rdrr.io/r/stats/extractAIC.html" class="external-link">extractAIC</a></code> can be used
to extract various useful features of the value returned by <code>glmb</code>.</p>
<p>An object of class <code>"glmb"</code> is a list containing at least the following components:</p>
<dl><dt>glm</dt>
<dd><p>an object of class <code>"glm"</code> containing the output from a call to the function <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code></p></dd>

<dt>coefficients</dt>
<dd><p>a matrix of dimension <code>n</code> by <code>length(mu)</code> with one sample in each row</p></dd>

<dt>coef.means</dt>
<dd><p>a vector of <code>length(mu)</code> with the estimated posterior mean coefficients</p></dd>

<dt>coef.mode</dt>
<dd><p>a vector of <code>length(mu)</code> with the estimated posterior mode coefficients</p></dd>

<dt>dispersion</dt>
<dd><p>Either a constant provided as part of the call, or a vector of length <code>n</code> with one sample in each row.</p></dd>

<dt>Prior</dt>
<dd><p>A list with the priors specified for the model in question. Items in
list may vary based on the type of prior</p></dd>

<dt>fitted.values</dt>
<dd><p>a matrix of dimension <code>n</code> by <code>length(y)</code> with one sample for the mean fitted values in each row</p></dd>

<dt>family</dt>
<dd><p>the <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code> object used.</p></dd>

<dt>linear.predictors</dt>
<dd><p>an <code>n</code> by <code>length(y)</code> matrix with one sample for the linear fit on the link scale in each row</p></dd>

<dt>deviance</dt>
<dd><p>an <code>n</code> by <code>1</code> matrix with one sample for the deviance in each row</p></dd>

<dt>pD</dt>
<dd><p>An Estimate for the effective number of parameters</p></dd>

<dt>Dbar</dt>
<dd><p>Expected value for minus twice the log-likelihood function</p></dd>

<dt>Dthetabar</dt>
<dd><p>Value of minus twice the log-likelihood function evaluated at the mean value for the coefficients</p></dd>

<dt>DIC</dt>
<dd><p>Estimated Deviance Information criterion</p></dd>

<dt>prior.weights</dt>
<dd><p>a vector of weights specified or implied by the model</p></dd>

<dt>y</dt>
<dd><p>a vector with the dependent variable</p></dd>

<dt>x</dt>
<dd><p>a matrix with the implied design matrix for the model</p></dd>

<dt>model</dt>
<dd><p>if requested (the default),the model frame</p></dd>

<dt>call</dt>
<dd><p>the matched call</p></dd>

<dt>formula</dt>
<dd><p>the formula supplie</p></dd>

<dt>terms</dt>
<dd><p>the <code><a href="https://rdrr.io/r/stats/terms.html" class="external-link">terms</a></code> object used</p></dd>

<dt>data</dt>
<dd><p>the <code>data argument</code></p></dd>

<dt>famfunc</dt>
<dd><p>Family functions used during estimation process</p></dd>

<dt>iters</dt>
<dd><p>an <code>n</code> by <code>1</code> matrix giving the number of candidates generated before acceptance for each sample.</p></dd>

<dt>contrasts</dt>
<dd><p>(where relevant) the contrasts used.</p></dd>

<dt>xlevels</dt>
<dd><p>(where relevant) a record of the levels of the factors used in fitting</p></dd>

<dt>digits</dt>
<dd><p>the number of significant digits to use when printing.</p></dd>

</dl><p>In addition, non-empty fits will have (yet to be implemented) components <code>qr</code>, <code>R</code>
and <code>effects</code> relating to the final weighted linear fit for the posterior mode.
Objects of class <code>"glmb"</code> are normall of class <code>c("glmb","glm","lm")</code>,
that is inherit from classes <code>glm</code> and <code>lm</code> and well-designed
methods from those classed will be applied when appropriate.</p>
<p>If a <a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a> <code>glmb</code> model was specified by giving a two-column
response, the weights returned by <code>prior.weights</code> are the total number of
cases (factored by the supplied case weights) and the component of <code>y</code>
of the result is the proportion of successes.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function <code>glmb</code> is a Bayesian version of the classical <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code> function.  Setup of
the models mirrors those for the <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code> function but add additional required arguments
<code>mu</code> and <code>Sigma</code>, representing a multivariate normal prior. In addition, the dispersion
parameter must currently be provided for the gaussian, Gamma, quasipoisson, and quasibinomial families
(future implementations may incoporate priors for these into the <code>glmb</code> function).  The function
generates random iid samples from the posterior density associated with the model (assuming a fixed
dispersion parameter).</p>
<p>Current implemented models include the gaussian family (identity link function), the poisson and
quasipoisson families (log link function), the gamma family (log link function), as well as the
binomial and quasibinomial families (logit, probit, and cloglog link functions).</p>
<p>The function returns the output from a call to the function <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code> as well as the simulated
Bayesian coefficients and associated outputs. In addition, the function returns model diagnostic
information related to the <code>DIC</code>, a Bayesian Information Criterion similar to the <code>AIC</code> for
classical models.</p>
<p>For the gaussian family, iid samples from the posterior density are genererated using
standard simulation procedures for multivariate normal densities. For all other
families, the samples are generated using accept-reject procedures by leveraging the
likelihood subgradient approach of Nygren and Nygren (2006). This approach relies on
tight enveloping functions that bound the posterior density from above. The Gridtype
parameter is used to select the method used for determining the size of a Grid used
to build the enveloping function. See <code><a href="EnvelopeBuild.html">EnvelopeBuild</a></code> for details.
Depending on the selection, the time to build the envelope and the acceptance rate
during the simulation process may vary. The returned value <code>iters</code> contains the
number of candidates generated before acceptance for each draw.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Dobson, A. J. (1990)
<em>An Introduction to Generalized Linear Models.</em>
London: Chapman and Hall.</p>
<p>Hastie, T. J. and Pregibon, D. (1992)
<em>Generalized linear models.</em>
Chapter 6 of <em>Statistical Models in S</em>
eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
McCullagh P. and Nelder, J. A. (1989)
<em>Generalized Linear Models.</em>
London: Chapman and Hall.</p>
<p>Nygren, K.N. and Nygren, L.M (2006)
Likelihood Subgradient Densities. <em>Journal of the American Statistical Association</em>.
vol.101, no.475, pp 1144-1156.
doi: <a href="https://doi.org/10.1198/016214506000000357" class="external-link">10.1198/016214506000000357</a>.</p>
<p>Raiffa, Howard and Schlaifer, R (1961)
<em>Applied Statistical Decision Theory.</em>
Boston: Clinton Press, Inc.</p>
<p>Venables, W. N. and Ripley, B. D. (2002)
<em>Modern Applied Statistics with S.</em>
New York: Springer.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> and <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code> for classical modeling functions.</p>
<p><code><a href="pfamily.html">pfamily</a></code> for documentation of pfamily functions used to specify priors.</p>
<p><code><a href="Prior_Setup.html">Prior_Setup</a></code>, <code><a href="Prior_Check.html">Prior_Check</a></code> for functions used to initialize and to check priors,</p>
<p><code><a href="summary.glmb.html">summary.glmb</a></code>, <code><a href="predict.glmb.html">predict.glmb</a></code>, <code><a href="residuals.glmb.html">residuals.glmb</a></code>, <code><a href="simulate.glmb.html">simulate.glmb</a></code>,
<code><a href="extractAIC.glmb.html">extractAIC.glmb</a></code>, <code><a href="dummy.coef.glmb.html">dummy.coef.glmb</a></code> and methods(class="glmb") for <code>glmb</code>
and the methods and generic functions for classes <code>glm</code> and <code>lm</code> from which class <code>glmb</code> inherits.</p>
<p>Other glmbayes modeling functions:
<code><a href="lmb.html">lmb</a>()</code>,
<code><a href="rglmb.html">rglmb</a>()</code>,
<code><a href="rlmb.html">rlmb</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>The <span style="R">R</span> implementation of <code>glmb</code> has been written by Kjell Nygren and
was built to be a Bayesian version of the <code>glm</code> function and hence tries
to mirror the features of the <code>glm</code> function to the greatest extent possible. For details
on the author(s) for the <code>glm</code> function see the documentation for <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">333</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Dobson (1990) Page 93: Randomized Controlled Trial :</span></span></span>
<span class="r-in"><span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">18</span>,<span class="fl">17</span>,<span class="fl">15</span>,<span class="fl">20</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">25</span>,<span class="fl">13</span>,<span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mysd</span><span class="op">&lt;-</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">mu</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mu</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">counts</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">V0</span><span class="op">&lt;-</span><span class="op">(</span><span class="op">(</span><span class="va">mysd</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">glmb.D93</span><span class="op">&lt;-</span><span class="fu">glmb</span><span class="op">(</span><span class="va">counts</span> <span class="op">~</span> <span class="va">outcome</span> <span class="op">+</span> <span class="va">treatment</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,pfamily<span class="op">=</span><span class="fu"><a href="pfamily.html">dNormal</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu</span>,Sigma<span class="op">=</span><span class="va">V0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">glmb.D93</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glmb(formula = counts ~ outcome + treatment, family = poisson(), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pfamily = dNormal(mu = mu, Sigma = V0))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Deviance Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1       2       3       4       5       6       7       8       9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.5399  0.9667 -0.1405 -0.1038 -0.9671  1.0614  0.9687 -0.1031 -0.9567 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prior and Maximum Likelihood Estimates with Standard Deviations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          Prior.sd  Max Like. Like.sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  2.813e+00  1.000e+00  3.045e+00   0.171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outcome2     0.000e+00  1.000e+00 -4.543e-01   0.202</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outcome3     0.000e+00  1.000e+00 -2.930e-01   0.193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treatment2   0.000e+00  1.000e+00  1.217e-15   0.200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treatment3   0.000e+00  1.000e+00  8.438e-16   0.200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayesian Estimates Based on 1000 iid draws</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Post.Mode Post.Mean   Post.Sd MC Error Pr(tail)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  3.027191  3.010036  0.170870        0   0.1279  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outcome2    -0.428954 -0.427228  0.203969        0   0.0160 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outcome3    -0.272569 -0.271265  0.190823        0   0.0779 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treatment2   0.004042  0.004123  0.198831        0   0.4885  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treatment3   0.004042  0.004311  0.190245        0   0.4925  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution Percentiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  1.0%      2.5%      5.0%    Median     95.0%     97.5% 99.0%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  2.630959  2.678642  2.737872  3.007527  3.287809  3.332779 3.403</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outcome2    -0.898758 -0.834953 -0.766190 -0.417820 -0.093401 -0.024640 0.027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outcome3    -0.716630 -0.643639 -0.586258 -0.264059  0.034240  0.102084 0.149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treatment2  -0.468938 -0.410120 -0.327144  0.004865  0.312898  0.386260 0.457</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treatment3  -0.414533 -0.367326 -0.301737  0.002136  0.319114  0.371064 0.448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Effective Number of Parameters: 4.835259 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Residual Deviance: 10.03303 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIC: 56.50047 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Mean dispersion: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sq.root of Expected Mean dispersion: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Likelihood Subgradient Candidates Per iid sample: 1.834 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Menarche Binomial Data Example </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">menarche2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Age2</span><span class="op">=</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Age</span><span class="op">-</span><span class="fl">13</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Priors Are Derived in Vignette</span></span></span>
<span class="r-in"><span><span class="va">nvars</span><span class="op">=</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="co">## Logit Prior and Model</span></span></span>
<span class="r-in"><span><span class="va">mu1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1.098612</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">V1</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">nvars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">V1</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">0.18687882</span></span></span>
<span class="r-in"><span><span class="va">V1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="fl">0.10576217</span></span></span>
<span class="r-in"><span><span class="va">V1</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="op">-</span><span class="fl">0.03389182</span></span></span>
<span class="r-in"><span><span class="va">V1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="op">-</span><span class="fl">0.03389182</span></span></span>
<span class="r-in"><span><span class="va">glmb.out1</span><span class="op">&lt;-</span><span class="fu">glmb</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Menarche</span>, <span class="va">Total</span><span class="op">-</span><span class="va">Menarche</span><span class="op">)</span> <span class="op">~</span> <span class="va">Age2</span>,</span></span>
<span class="r-in"><span>family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="va">logit</span><span class="op">)</span>,pfamily<span class="op">=</span><span class="fu"><a href="pfamily.html">dNormal</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu1</span>,Sigma<span class="op">=</span><span class="va">V1</span><span class="op">)</span>, data<span class="op">=</span><span class="va">menarche2</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>non-integer #successes in a binomial glm!</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">glmb.out1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glmb(formula = cbind(Menarche, Total - Menarche) ~ Age2, family = binomial(logit), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pfamily = dNormal(mu = mu1, Sigma = V1), data = menarche2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Deviance Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1       2       3       4       5       6       7       8       9      10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.2765 -2.0799 -1.9073 -0.8541 -1.0394 -0.2075  0.1791  0.7315 -0.5782  1.3459 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      11      12      13      14      15      16      17      18      19      20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.1956  0.9290 -1.0677  0.1157  1.2993 -0.9914 -1.1580  1.1358  0.6471 -0.8146 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      21      22      23      24      25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.4116 -0.8493 -0.4326 -0.6874  1.1463 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prior and Maximum Likelihood Estimates with Standard Deviations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Prior.sd Max Like. Like.sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  0.00000  0.43229  -0.01081   0.063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Age2         1.09861  0.32521   1.63197   0.059</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayesian Estimates Based on 1000 iid draws</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Post.Mode Post.Mean  Post.Sd MC Error Pr(tail)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  -0.01369  -0.01578  0.06140        0 0.404595    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Age2          1.61438   1.61762  0.05738        0 0.000999 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution Percentiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 1.0%     2.5%     5.0%   Median    95.0%    97.5% 99.0%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.15338 -0.13303 -0.11422 -0.01799  0.08462  0.10358 0.120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Age2         1.49850  1.51047  1.52677  1.61714  1.71566  1.73292 1.752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Effective Number of Parameters: 1.922842 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Residual Deviance: 28.6934 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIC: 114.668 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Mean dispersion: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sq.root of Expected Mean dispersion: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Likelihood Subgradient Candidates Per iid sample: 1.3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Probit Prior and Model</span></span></span>
<span class="r-in"><span><span class="va">mu2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.6407758</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">V2</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">nvars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">V2</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">0.07158369</span></span></span>
<span class="r-in"><span><span class="va">V2</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="fl">0.03453205</span></span></span>
<span class="r-in"><span><span class="va">V2</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="op">-</span><span class="fl">0.01512075</span></span></span>
<span class="r-in"><span><span class="va">V2</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="op">-</span><span class="fl">0.01512075</span></span></span>
<span class="r-in"><span><span class="va">glmb.out2</span><span class="op">&lt;-</span><span class="fu">glmb</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Menarche</span>, <span class="va">Total</span><span class="op">-</span><span class="va">Menarche</span><span class="op">)</span> <span class="op">~</span> <span class="va">Age2</span>,</span></span>
<span class="r-in"><span>family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="va">probit</span><span class="op">)</span>,pfamily<span class="op">=</span><span class="fu"><a href="pfamily.html">dNormal</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu2</span>,Sigma<span class="op">=</span><span class="va">V2</span><span class="op">)</span>, data<span class="op">=</span><span class="va">menarche2</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>non-integer #successes in a binomial glm!</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">glmb.out2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glmb(formula = cbind(Menarche, Total - Menarche) ~ Age2, family = binomial(probit), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pfamily = dNormal(mu = mu2, Sigma = V2), data = menarche2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Deviance Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1        2        3        4        5        6        7        8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.47772 -1.50807 -1.61467 -0.56187 -0.93872 -0.26599 -0.05616  0.35264 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        9       10       11       12       13       14       15       16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.97959  0.97059  0.92817  0.84753 -0.92765  0.46940  1.78917 -0.38727 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       17       18       19       20       21       22       23       24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.62915  1.51679  0.90686 -0.75497 -0.56573 -1.20334 -0.90031 -1.35566 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.20928 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prior and Maximum Likelihood Estimates with Standard Deviations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Prior.sd Max Like. Like.sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  0.00000  0.26755  -0.01724   0.035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Age2         0.64078  0.18583   0.90782   0.030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayesian Estimates Based on 1000 iid draws</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Post.Mode Post.Mean  Post.Sd MC Error Pr(tail)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  -0.01863  -0.01865  0.03592        0 0.306693    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Age2          0.90071   0.90239  0.02806        0 0.000999 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution Percentiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 1.0%     2.5%     5.0%   Median    95.0%    97.5% 99.0%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.10164 -0.08717 -0.07752 -0.01752  0.03679  0.04622 0.061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Age2         0.83708  0.84843  0.85825  0.90201  0.94761  0.95844 0.968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Effective Number of Parameters: 1.969936 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Residual Deviance: 24.89386 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIC: 110.9156 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Mean dispersion: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sq.root of Expected Mean dispersion: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Likelihood Subgradient Candidates Per iid sample: 1.269 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## clog-log Prior and Model</span></span></span>
<span class="r-in"><span><span class="va">mu2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3665129</span>,<span class="fl">0.6002727</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">V2</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">nvars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">V2</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">0.11491322</span></span></span>
<span class="r-in"><span><span class="va">V2</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="fl">0.03365986</span></span></span>
<span class="r-in"><span><span class="va">V2</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="op">-</span><span class="fl">0.03502783</span></span></span>
<span class="r-in"><span><span class="va">V2</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="op">-</span><span class="fl">0.03502783</span></span></span>
<span class="r-in"><span><span class="va">glmb.out3</span><span class="op">&lt;-</span><span class="fu">glmb</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Menarche</span>, <span class="va">Total</span><span class="op">-</span><span class="va">Menarche</span><span class="op">)</span> <span class="op">~</span> <span class="va">Age2</span>,</span></span>
<span class="r-in"><span>                family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="va">cloglog</span><span class="op">)</span>,pfamily<span class="op">=</span><span class="fu"><a href="pfamily.html">dNormal</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu2</span>,Sigma<span class="op">=</span><span class="va">V2</span><span class="op">)</span>, data<span class="op">=</span><span class="va">menarche2</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: fitted probabilities numerically 0 or 1 occurred</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>non-integer #successes in a binomial glm!</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: fitted probabilities numerically 0 or 1 occurred</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">glmb.out3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glmb(formula = cbind(Menarche, Total - Menarche) ~ Age2, family = binomial(cloglog), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pfamily = dNormal(mu = mu2, Sigma = V2), data = menarche2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Deviance Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1          2          3          4          5          6          7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -3.414e+00 -3.989e+00 -3.239e+00 -2.683e+00 -2.552e+00 -1.687e+00 -1.244e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          8          9         10         11         12         13         14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.097e-01 -1.200e+00  1.238e+00  1.679e+00  2.042e+00  5.071e-01  2.117e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         15         16         17         18         19         20         21 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3.401e+00  1.201e+00  5.308e-01  2.182e+00  1.123e+00 -1.103e+00 -1.508e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         22         23         24         25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2.638e+00 -2.502e+00 -3.459e+00  8.400e-07 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prior and Maximum Likelihood Estimates with Standard Deviations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Prior.sd Max Like. Like.sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.3665   0.3390   -0.5960   0.041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Age2         0.6003   0.1835    0.9530   0.031</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayesian Estimates Based on 1000 iid draws</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Post.Mode Post.Mean  Post.Sd MC Error Pr(tail)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  -0.59224  -0.59220  0.04213        0  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Age2          0.94419   0.94445  0.02861        0 0.000999 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution Percentiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                1.0%    2.5%    5.0%  Median   95.0%   97.5%  99.0%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.6919 -0.6736 -0.6607 -0.5908 -0.5266 -0.5134 -0.492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Age2         0.8784  0.8881  0.8991  0.9442  0.9907  1.0004  1.015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Effective Number of Parameters: 1.979233 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Residual Deviance: 120.8928 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIC: 206.9238 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Mean dispersion: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sq.root of Expected Mean dispersion: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Likelihood Subgradient Candidates Per iid sample: 1.324 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">DIC_Out</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/extractAIC.html" class="external-link">extractAIC</a></span><span class="op">(</span><span class="va">glmb.out1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/extractAIC.html" class="external-link">extractAIC</a></span><span class="op">(</span><span class="va">glmb.out2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/extractAIC.html" class="external-link">extractAIC</a></span><span class="op">(</span><span class="va">glmb.out3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">DIC_Out</span><span class="op">)</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>,<span class="st">"probit"</span>,<span class="st">"clog-log"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">DIC_Out</span><span class="op">)</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pD"</span>,<span class="st">"DIC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DIC_Out</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                pD      DIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit    1.922842 114.6680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> probit   1.969936 110.9156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clog-log 1.979233 206.9238</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kjell Nygren.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

