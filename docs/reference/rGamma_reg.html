<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>The Bayesian Generalized Linear Model Dispersion Distribution — rGamma_reg • glmbayes</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="The Bayesian Generalized Linear Model Dispersion Distribution — rGamma_reg"><meta property="og:description" content="rGamma_reg is used to generate iid samples for the dispersion parameter in Bayesian Generalized Linear models.
The model is specified by providing the model structure, regression coefficient, and a Gamma prior."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glmbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/chapter-01.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-02.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-03.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-04.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-05.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-06.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-07.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-08.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-09.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-10.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-11.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-A1.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-A2.html">UNKNOWN TITLE</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>The Bayesian Generalized Linear Model Dispersion Distribution</h1>

    <div class="hidden name"><code>rGamma_reg.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>rGamma_reg</code> is used to generate iid samples for the dispersion parameter in Bayesian Generalized Linear models.
The model is specified by providing the model structure, regression coefficient, and a Gamma prior.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rGamma_reg</span><span class="op">(</span></span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">prior_list</span>,</span>
<span>  offset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'rGamma_reg'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'rGamma_reg'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>number of draws to generate. If <code>length(n) &gt; 1</code>, the length is taken to be the number required.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>a vector of observations of length <code>m</code>.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a design matrix of dimension <code>m * p</code>.</p></dd>


<dt id="arg-prior-list">prior_list<a class="anchor" aria-label="anchor" href="#arg-prior-list"></a></dt>
<dd><p>a list with the prior parameters (shape and rate) for the
prior distribution and a vector with the assumed value (beta) for the regression coefficients.</p></dd>


<dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>this can be used to specify an <em>a priori</em> known component to be included in the linear predictor during fitting. This should be <code>NULL</code> or a numeric vector of length equal to the number of cases. One or more offset terms can be included in the formula instead or as well, and if more than one is specified their sum is used. See <code><a href="https://rdrr.io/r/stats/model.extract.html" class="external-link">model.offset</a></code>.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>an optional vector of ‘prior weights’ to be used in the fitting process. Should be NULL or a numeric vector.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>a description of the error distribution and link function to be used in the model. This can be a character string naming a family function, a family function or the result of a call to a family function. (See <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code> for details of family functions.)</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>Number of significant digits to use for printed outpute</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>an object of class <code>"glmb_dispersion"</code> that is to be summarized</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments passed to or from other methods</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>rGamma_reg</code> returns a object of class <code>"rglmbdisp"</code>.  The function <code>summary</code>
(i.e., <code><a href="summary.rglmb.html">summary.rglmb</a></code>) can be used to obtain or print a summary of the results.
The generic accessor functions <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></code>, <code><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted.values</a></code>,
<code><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></code>, and <code><a href="https://rdrr.io/r/stats/extractAIC.html" class="external-link">extractAIC</a></code> can be used to extract
various useful features of the value returned by <code>rGamma_reg</code>.
An object of class <code>"rglmbdisp"</code> is a list containing at least the following components:</p>
<dl><dt>dispersion</dt>
<dd><p>an <code>n</code> by <code>1</code> matrix with simulated values for the dispersion</p></dd>

<dt>Prior</dt>
<dd><p>A list with two components. The first being the prior mean vector and the second the prior precision matrix</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The <code>rGamma_reg</code> function produces iid samples for
the dispersion parameter in Bayesian generalized linear models (gaussian and Gamma families
only). Core required inputs for the function include the data vector, the design
matrix, an estimate for the regression coefficients, and a prior gamma distribution specification.
The function returns the simulated Bayesian conditional dispersion and the prior specification.
The most practical use of this function is likely to be in conjunction with the
<code><a href="rglmb.html">rglmb</a></code> function as part of block Gibbs sampling procedues.</p>
<p>For the gaussian family, iid samples from the posterior density are genererated using
standard simulation procedures for gamma distributions. For the Gamma family,
, the samples are generated using accept-reject procedures by leveraging the
likelihood subgradient approach of Nygren and Nygren (2006).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>A reference</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other family simulation functions:
<code><a href="rNormal_Gamma_reg.html">rNormal_Gamma_reg</a>()</code>,
<code><a href="rNormal_reg.html">rNormal_reg</a>()</code>,
<code><a href="rindependent_norm_gamma_reg.html">rindependent_norm_gamma_reg</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Annette Dobson (1990) "An Introduction to Generalized Linear Models".</span></span></span>
<span class="r-in"><span><span class="co">## Page 9: Plant Weight Data.</span></span></span>
<span class="r-in"><span><span class="va">ctl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.17</span>,<span class="fl">5.58</span>,<span class="fl">5.18</span>,<span class="fl">6.11</span>,<span class="fl">4.50</span>,<span class="fl">4.61</span>,<span class="fl">5.17</span>,<span class="fl">4.53</span>,<span class="fl">5.33</span>,<span class="fl">5.14</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.81</span>,<span class="fl">4.17</span>,<span class="fl">4.41</span>,<span class="fl">3.59</span>,<span class="fl">5.87</span>,<span class="fl">3.83</span>,<span class="fl">6.03</span>,<span class="fl">4.89</span>,<span class="fl">4.32</span>,<span class="fl">4.69</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span>, <span class="fl">20</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ctl"</span>,<span class="st">"Trt"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">weight</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ctl</span>, <span class="va">trt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lm.D9</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>,x<span class="op">=</span><span class="cn">TRUE</span>,y<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">lm_summary</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm.D9</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">lm_summary</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = weight ~ group, x = TRUE, y = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.0710 -0.4938  0.0685  0.2462  1.3690 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   5.0320     0.2202  22.850 9.55e-15 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> groupTrt     -0.3710     0.3114  -1.191    0.249    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 0.6964 on 18 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.07308,	Adjusted R-squared:  0.02158 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 1.419 on 1 and 18 DF,  p-value: 0.249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">lm.D9</span><span class="op">$</span><span class="va">coefficients</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    groupTrt </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       5.032      -0.371 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">&lt;-</span><span class="fl">10000</span></span></span>
<span class="r-in"><span><span class="va">y</span><span class="op">&lt;-</span><span class="va">lm.D9</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">lm.D9</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Set old regression and dispersion coefficients</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">b_old</span><span class="op">=</span><span class="va">lm.D9</span><span class="op">$</span><span class="va">coefficients</span></span></span>
<span class="r-in"><span><span class="va">v_old</span><span class="op">=</span><span class="va">lm_summary</span><span class="op">$</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Set up for rglmb_dispersion</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n0</span><span class="op">=</span><span class="fl">0.1</span></span></span>
<span class="r-in"><span><span class="va">shape</span><span class="op">=</span><span class="va">n0</span><span class="op">/</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">rate</span><span class="op">=</span><span class="va">shape</span><span class="op">*</span><span class="va">v_old</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rate</span><span class="op">/</span><span class="op">(</span><span class="va">shape</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.02552412</span>
<span class="r-in"><span><span class="va">rate</span><span class="op">/</span><span class="va">shape</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4849583</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#a1&lt;-shape+n1/2</span></span></span>
<span class="r-in"><span><span class="co">#b1&lt;-rate+sum(SS)/2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#out&lt;-1/rgamma(n,shape=a1,rate=b1)</span></span></span>
<span class="r-in"><span><span class="co">## v0=sum(SS)/n1 ~ (2*rate+sum(SS))/(2*shape+n1)=[(2*rate+sum(SS))/2]/((2*shape+n1)/2) </span></span></span>
<span class="r-in"><span><span class="va">n1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">SS</span><span class="op">=</span><span class="va">v_old</span><span class="op">*</span><span class="va">n1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n1</span> <span class="co"># This is equal to 20</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n0</span><span class="op">=</span><span class="fl">2</span> <span class="co"># Prior observations</span></span></span>
<span class="r-in"><span><span class="va">v_prior</span><span class="op">=</span><span class="va">v_old</span>  <span class="co"># Prior point estimate for variance (the mean of (1/dispersion=1/v_prior))</span></span></span>
<span class="r-in"><span><span class="va">wt0</span><span class="op">=</span><span class="op">(</span><span class="va">n0</span><span class="op">/</span><span class="va">n1</span><span class="op">)</span>  </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## set shape=0.01*(n1/2)</span></span></span>
<span class="r-in"><span><span class="co">## set rate= 0.01*SS/2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">shape</span><span class="op">=</span><span class="va">wt0</span><span class="op">*</span><span class="op">(</span><span class="va">n1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>   <span class="co">###  Shape is prior observations /2</span></span></span>
<span class="r-in"><span><span class="va">rate</span><span class="op">=</span><span class="va">shape</span><span class="op">*</span><span class="va">v_prior</span>  <span class="co">### rate is essentiall prior SS - V in rmultireg should be this</span></span></span>
<span class="r-in"><span><span class="va">rate</span><span class="op">/</span><span class="va">shape</span> <span class="co">## Should match v_prior (currently also v_old)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4849583</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We see that this currently matches </span></span></span>
<span class="r-in"><span><span class="co">### (test different v_prior with various prior observations below) </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">prior_list</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="va">b_old</span>,shape<span class="op">=</span><span class="va">shape</span>,rate<span class="op">=</span><span class="va">rate</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dispout</span><span class="op">&lt;-</span><span class="fu">rGamma_reg</span><span class="op">(</span>n<span class="op">=</span><span class="va">n</span>,<span class="va">y</span>,<span class="va">x</span>,prior_list<span class="op">=</span><span class="va">prior_list</span>,</span></span>
<span class="r-in"><span>offset<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dispout</span><span class="op">$</span><span class="va">dispersion</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4870285</span>
<span class="r-in"><span><span class="va">v_prior</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4849583</span>
<span class="r-in"><span><span class="va">v_old</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4849583</span>
<span class="r-in"><span><span class="co">#summary(dispout)  ## Summary function not working - need to write</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Set up test rglmb regressions without and with prior for dispersion </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mu</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mu</span><span class="op">=</span><span class="va">b_old</span>  <span class="co">### For testing purposes, set prior=b_old</span></span></span>
<span class="r-in"><span><span class="va">P</span><span class="op">&lt;-</span><span class="fl">0.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wt2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Check</span></span></span>
<span class="r-in"><span><span class="va">prior</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu</span>,Sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span>,dispersion<span class="op">=</span><span class="va">v_old</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outtemp1</span><span class="op">&lt;-</span><span class="fu"><a href="glmb.html">glmb</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, <span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>pfamily<span class="op">=</span><span class="fu"><a href="pfamily.html">dNormal</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu</span>,Sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span>,dispersion<span class="op">=</span><span class="va">v_old</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Could use a residuals function here -- For now, maybe run the glmb function</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">outtemp1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glmb(formula = weight ~ group, family = gaussian(), pfamily = dNormal(mu = mu, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Sigma = solve(P), dispersion = v_old), n = 1000)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Deviance Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1        2        3        4        5        6        7        8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.86473  0.54527  0.14527  1.07527 -0.53473 -0.42473  0.13527 -0.50473 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        9       10       11       12       13       14       15       16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.29527  0.10527  0.15734 -0.48266 -0.24266 -1.06266  1.21734 -0.82266 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       17       18       19       20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.37734  0.23734 -0.33266  0.03734 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prior and Maximum Likelihood Estimates with Standard Deviations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    Prior.sd Max Like. Like.sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  5.032    3.162     5.032   0.220</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> groupTrt    -0.371    3.162    -0.371   0.311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayesian Estimates Based on 1000 iid draws</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Post.Mode Post.Mean Post.Sd MC Error Pr(tail)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    5.0320    5.0347  0.2214        0    0.495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> groupTrt      -0.3710   -0.3821  0.3030        0    0.473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution Percentiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                1.0%    2.5%    5.0%  Median   95.0%   97.5% 99.0%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  4.4953  4.5836  4.6486  5.0337  5.3932  5.4566 5.521</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> groupTrt    -1.1094 -0.9801 -0.8849 -0.3908  0.1123  0.2224 0.351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Effective Number of Parameters: 1.999052 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Residual Deviance: 9.699477 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIC: 21.4756 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Mean dispersion: 0.4849583 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sq.root of Expected Mean dispersion: 0.6963895 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Likelihood Subgradient Candidates Per iid sample: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">outtemp1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4849739</span>
<span class="r-in"><span><span class="va">v_old</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4849583</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="op">(</span><span class="va">outtemp1</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    groupTrt </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5.0347321  -0.3820732 </span>
<span class="r-in"><span><span class="va">b_old</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    groupTrt </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       5.032      -0.371 </span>
<span class="r-in"><span><span class="va">prior</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu</span>,P<span class="op">=</span><span class="va">P</span>,dispersion<span class="op">=</span><span class="va">v_old</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outtemp2</span><span class="op">&lt;-</span><span class="fu"><a href="rglmb.html">rglmb</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, <span class="va">y</span>, <span class="va">x</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>pfamily<span class="op">=</span><span class="fu"><a href="pfamily.html">dNormal</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu</span>,Sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span>,dispersion<span class="op">=</span><span class="va">v_old</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, weights <span class="op">=</span> <span class="va">wt2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">outtemp2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prior Estimates with Standard Deviations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    Prior.sd Approx.Prior.wt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  5.032    3.162           0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> groupTrt    -0.371    3.162           0.010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayesian Estimates Based on 1000 iid draws</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Post.Mode Post.Mean Post.Sd MC Error Pr(tail)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    5.0320    5.0321  0.2183        0    0.492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> groupTrt      -0.3710   -0.3685  0.3136        0    0.490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution Percentiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                1.0%    2.5%    5.0%  Median   95.0%   97.5% 99.0%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  4.5150  4.6117  4.6581  5.0369  5.4009  5.4783 5.563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> groupTrt    -1.1237 -0.9950 -0.9113 -0.3607  0.1404  0.2309 0.338</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="op">(</span><span class="va">outtemp2</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    groupTrt </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5.0320973  -0.3685078 </span>
<span class="r-in"><span><span class="va">b_old</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    groupTrt </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       5.032      -0.371 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">prior</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu</span>,Sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span>,shape<span class="op">=</span><span class="va">shape</span>,rate<span class="op">=</span><span class="va">rate</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outtemp3</span><span class="op">&lt;-</span><span class="fu"><a href="glmb.html">glmb</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10000</span>, <span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>,family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>,  </span></span>
<span class="r-in"><span>               <span class="fu"><a href="pfamily.html">dNormal_Gamma</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu</span>,Sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span>,shape<span class="op">=</span><span class="va">shape</span>,rate<span class="op">=</span><span class="va">rate</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Could use a residuals function here -- For now, maybe run the glmb function</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">outtemp3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glmb(formula = weight ~ group, family = gaussian(), pfamily = dNormal_Gamma(mu = mu, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Sigma = solve(P), shape = shape, rate = rate), n = 10000)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Deviance Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1        2        3        4        5        6        7        8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.86153  0.54847  0.14847  1.07847 -0.53153 -0.42153  0.13847 -0.50153 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        9       10       11       12       13       14       15       16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.29847  0.10847  0.14843 -0.49157 -0.25157 -1.07157  1.20843 -0.83157 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       17       18       19       20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.36843  0.22843 -0.34157  0.02843 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prior and Maximum Likelihood Estimates with Standard Deviations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    Prior.sd Max Like. Like.sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  5.032    3.162     5.032   0.220</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> groupTrt    -0.371    3.162    -0.371   0.311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayesian Estimates Based on 10000 iid draws</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Post.Mode Post.Mean Post.Sd MC Error Pr(tail)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    5.0320    5.0315  0.2151        0    0.498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> groupTrt      -0.3710   -0.3700  0.3066        0    0.497</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution Percentiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                1.0%    2.5%    5.0%  Median   95.0%   97.5% 99.0%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  4.5183  4.6051  4.6801  5.0311  5.3827  5.4520 5.556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> groupTrt    -1.0917 -0.9699 -0.8669 -0.3730  0.1334  0.2410 0.371</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Effective Number of Parameters: 2.765901 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Residual Deviance: 21.74862 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIC: 45.8179 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Mean dispersion: 0.4855357 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sq.root of Expected Mean dispersion: 0.6968039 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Likelihood Subgradient Candidates Per iid sample: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">outtemp3</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4836226</span>
<span class="r-in"><span><span class="va">v_old</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4849583</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="op">(</span><span class="va">outtemp3</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    groupTrt </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5.0315328  -0.3699673 </span>
<span class="r-in"><span><span class="va">b_old</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    groupTrt </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       5.032      -0.371 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">outtemp3</span><span class="op">$</span><span class="va">dispersion</span><span class="op">)</span>  <span class="co">## Seems slightly smaller --&gt; Needs qc</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4855357</span>
<span class="r-in"><span><span class="va">v_old</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4849583</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kjell Nygren.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

