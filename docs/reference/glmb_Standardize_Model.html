<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Standardize A Non-Gaussian Model — glmb_Standardize_Model • glmbayes</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Standardize A Non-Gaussian Model — glmb_Standardize_Model"><meta property="og:description" content="Standardizes a Non-Gaussian Model prior to Envelope Creation"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glmbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/chapter-01.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-02.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-03.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-04.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-05.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-06.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-07.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-08.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-09.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-10.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-11.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-A1.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-A2.html">UNKNOWN TITLE</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Standardize A Non-Gaussian Model</h1>

    <div class="hidden name"><code>glmb_Standardize_Model.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Standardizes a Non-Gaussian Model prior to Envelope Creation</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">glmb_Standardize_Model</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span>, <span class="va">P</span>, <span class="va">bstar</span>, <span class="va">A1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>a vector of observations of length m</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a design matrix of dimension m*p</p></dd>


<dt id="arg-p">P<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>a positive-definite symmetric matrix specifying the prior precision matrix of the variables.</p></dd>


<dt id="arg-bstar">bstar<a class="anchor" aria-label="anchor" href="#arg-bstar"></a></dt>
<dd><p>a matrix containing the posterior mode from an optimization step</p></dd>


<dt id="arg-a-">A1<a class="anchor" aria-label="anchor" href="#arg-a-"></a></dt>
<dd><p>a matrix containing the posterior precision matrix at the posterior mode</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with the following components</p>
<dl><dt>bstar2</dt>
<dd><p>Standardized Posterior Mode</p></dd>

<dt>A</dt>
<dd><p>Standardized Data Precision Matrix</p></dd>

<dt>x2</dt>
<dd><p>Standardized Design Matrix</p></dd>

<dt>mu2</dt>
<dd><p>Standardized Prior Mean vector</p></dd>

<dt>P2</dt>
<dd><p>Standardized Precision Matrix Added to log-likelihood</p></dd>

<dt>L2Inv</dt>
<dd><p>A matrix used when undoing the first step in standardization described below</p></dd>

<dt>L3Inv</dt>
<dd><p>A matrix used when undoing the second step in standardization described below</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This functions starts with basic information about the model in the argument list and then
uses the following steps to further standardize the model (the model is already assumed to have a 0 prior mean vector
when this step is applied).</p>
<p>1) An eigenvalue composition is applied to the posterior precision matrix, and the model is (as an interim step)
standardized to have a posterior precision matrix equal to the identity matrix. Please note that this means
that the prior precision matrix after this step is <code>"smaller"</code> than the identity matrix.</p>

<p>2) A diagonal matrix epsilon is pulled out from the standardized prior precision matrix so that the remaining
part of the prior precision matrix still is positive definite. That part is then treated as part of the posterior
for the rest of the standardization and simulation and only the part connected to epsilon is treated as part of the prior.
Note that the exact epsilon chosen seems not to matter. Hence there are many possible ways of doing this
standardization and future versions of this package may tweak the current approach
if it helps improve numerical accuracy or acceptance rates.</p>

<p>3) The model is next standardized (using a second eigenvalue decomposition) so that the prior (i.e., the portion connected to epsilon) is the identity
matrix. The standardized model then simutaneously has the feature that the prior precision matrix is the
identity matrix and that the data precision A (at the posterior mode) is a diagonal matrix. Hence the variables
in the standardized model are approximately independent at the posterior mode.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">menarche2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">menarche2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Age            Total           Menarche      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   : 9.21   Min.   :  88.0   Min.   :   0.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.:11.58   1st Qu.:  98.0   1st Qu.:  10.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median :13.08   Median : 105.0   Median :  51.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   :13.10   Mean   : 156.7   Mean   :  92.32  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.:14.58   3rd Qu.: 117.0   3rd Qu.:  92.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   :17.58   Max.   :1049.0   Max.   :1049.00  </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Menarche</span><span class="op">/</span><span class="va">Total</span> <span class="op">~</span> <span class="va">Age</span>, data<span class="op">=</span><span class="va">menarche2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="glmb_Standardize_Model-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Age2</span><span class="op">=</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Age</span><span class="op">-</span><span class="fl">13</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Age2</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="va">Age2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">y</span><span class="op">=</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Menarche</span><span class="op">/</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Total</span></span></span>
<span class="r-in"><span><span class="va">wt</span><span class="op">=</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Total</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mu</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fl">0.0</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mu</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">/</span><span class="fl">0.1</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">V1</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fl">2.0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2 standard deviations for prior estimate at age 13 between 0.1 and 0.9</span></span></span>
<span class="r-in"><span><span class="co">## Specifies uncertainty around the point estimates</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">V1</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">/</span><span class="fl">0.1</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> </span></span>
<span class="r-in"><span><span class="va">V1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="op">(</span><span class="fl">3</span><span class="op">*</span><span class="va">mu</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>  <span class="co"># Allows slope to be up to 1 times as large as point estimate </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">famfunc</span><span class="op">&lt;-</span><span class="fu"><a href="glmbfamfunc.html">glmbfamfunc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="va">logit</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">f1</span><span class="op">&lt;-</span><span class="va">famfunc</span><span class="op">$</span><span class="va">f1</span></span></span>
<span class="r-in"><span><span class="va">f2</span><span class="op">&lt;-</span><span class="va">famfunc</span><span class="op">$</span><span class="va">f2</span></span></span>
<span class="r-in"><span><span class="va">f3</span><span class="op">&lt;-</span><span class="va">famfunc</span><span class="op">$</span><span class="va">f3</span></span></span>
<span class="r-in"><span><span class="va">f5</span><span class="op">&lt;-</span><span class="va">famfunc</span><span class="op">$</span><span class="va">f5</span></span></span>
<span class="r-in"><span><span class="va">f6</span><span class="op">&lt;-</span><span class="va">famfunc</span><span class="op">$</span><span class="va">f6</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dispersion2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">start</span> <span class="op">&lt;-</span> <span class="va">mu</span></span></span>
<span class="r-in"><span><span class="va">offset2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fl">0.0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">P</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">V1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">1000</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Appears that the type for some of these arguments are important/problematic</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###### Adjust weight for dispersion</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">wt2</span><span class="op">=</span><span class="va">wt</span><span class="op">/</span><span class="va">dispersion2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">######################### Shift mean vector to offset so that adjusted model has 0 mean</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">alpha</span><span class="op">=</span><span class="va">x</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">+</span><span class="va">offset2</span></span></span>
<span class="r-in"><span><span class="va">mu2</span><span class="op">=</span><span class="fl">0</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">P2</span><span class="op">=</span><span class="va">P</span></span></span>
<span class="r-in"><span><span class="va">x2</span><span class="op">=</span><span class="va">x</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#####  Optimization step to find posterior mode and associated Precision</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">parin</span><span class="op">=</span><span class="va">start</span><span class="op">-</span><span class="va">mu</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">opt_out</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="va">parin</span>,<span class="va">f2</span>,<span class="va">f3</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,mu<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">mu2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              P<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span>,alpha<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>,wt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">wt2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              method<span class="op">=</span><span class="st">"BFGS"</span>,hessian<span class="op">=</span><span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bstar</span><span class="op">=</span><span class="va">opt_out</span><span class="op">$</span><span class="va">par</span>  <span class="co">## Posterior mode for adjusted model</span></span></span>
<span class="r-in"><span><span class="va">bstar</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.01069645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.89698197</span>
<span class="r-in"><span><span class="va">bstar</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span>  <span class="co"># mode for actual model</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.01069645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  1.62939016</span>
<span class="r-in"><span><span class="va">A1</span><span class="op">=</span><span class="va">opt_out</span><span class="op">$</span><span class="va">hessian</span> <span class="co"># Approximate Precision at mode</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Standardize Model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Standard_Mod</span><span class="op">=</span><span class="fu">glmb_Standardize_Model</span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,P<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                    bstar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">bstar</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, A1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">A1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bstar2</span><span class="op">=</span><span class="va">Standard_Mod</span><span class="op">$</span><span class="va">bstar2</span>  </span></span>
<span class="r-in"><span><span class="va">A</span><span class="op">=</span><span class="va">Standard_Mod</span><span class="op">$</span><span class="va">A</span></span></span>
<span class="r-in"><span><span class="va">x2</span><span class="op">=</span><span class="va">Standard_Mod</span><span class="op">$</span><span class="va">x2</span></span></span>
<span class="r-in"><span><span class="va">mu2</span><span class="op">=</span><span class="va">Standard_Mod</span><span class="op">$</span><span class="va">mu2</span></span></span>
<span class="r-in"><span><span class="va">P2</span><span class="op">=</span><span class="va">Standard_Mod</span><span class="op">$</span><span class="va">P2</span></span></span>
<span class="r-in"><span><span class="va">L2Inv</span><span class="op">=</span><span class="va">Standard_Mod</span><span class="op">$</span><span class="va">L2Inv</span></span></span>
<span class="r-in"><span><span class="va">L3Inv</span><span class="op">=</span><span class="va">Standard_Mod</span><span class="op">$</span><span class="va">L3Inv</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kjell Nygren.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

