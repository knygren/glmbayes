<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Predict Method for Bayesian GLM Fits — predict.glmb • glmbayes</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Predict Method for Bayesian GLM Fits — predict.glmb"><meta property="og:description" content="Obtains predictions and optionally estimates standard errors of those
predictions from a fitted Bayesian generalized linear model object."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glmbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/chapter-01.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-02.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-03.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-04.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-05.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-06.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-07.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-08.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-09.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-10.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-11.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-A1.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-A2.html">UNKNOWN TITLE</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Predict Method for Bayesian GLM Fits</h1>

    <div class="hidden name"><code>predict.glmb.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Obtains predictions and optionally estimates standard errors of those
predictions from a fitted Bayesian generalized linear model object.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'glmb'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  newdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"link"</span>,</span>
<span>  se.fit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dispersion <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.pass</span>,</span>
<span>  olddata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>a fitted object of class inheriting from <code>"glmb"</code>.</p></dd>


<dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>optionally, a data frame in which to look for variables
with which to predict. If omitted, the fitted linear predictors are used.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>the type of prediction required.  The default is on the scale of the linear predictors;
the alternative <code>"response"</code> is on the scale of the response variable.  Thus for a default
binomial model the default predictions are of log-odds (probabilities
on logit scale) and <code>type = "response"</code> gives the predicted
probabilities.  The <code>"terms"</code> option returns a matrix giving the
fitted values of each term in the model formula on the linear predictor
scale (not implemented).</p></dd>


<dt id="arg-se-fit">se.fit<a class="anchor" aria-label="anchor" href="#arg-se-fit"></a></dt>
<dd><p>logical switch indicating if standard errors are required (not implemented).</p></dd>


<dt id="arg-dispersion">dispersion<a class="anchor" aria-label="anchor" href="#arg-dispersion"></a></dt>
<dd><p>the dispersion of the Bayesian GLM fit to be assumed in
computing the standard errors. If omitted, that returned by the <code>summary</code> applied
to the object is used.</p></dd>


<dt id="arg-terms">terms<a class="anchor" aria-label="anchor" href="#arg-terms"></a></dt>
<dd><p>with <code>type="terms"</code> by default all terms are returned.
A character vector specifies which terms are to be returned.</p></dd>


<dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>function determining what should be done with missing values in
<code>newdata</code>. The default is to predict <code>NA</code>.</p></dd>


<dt id="arg-olddata">olddata<a class="anchor" aria-label="anchor" href="#arg-olddata"></a></dt>
<dd><p>a data frame that should contain all the variables used in the
original model specification. Must currently be provided whenever newdata is
provided. Both olddata and newdata are subsetted to the model variables extracte
from the object model formula and rbind(olddata,newdata) must be valid after this step.
A check is also run to verify if the resulting x matrix from olddata is consistent with that
from the original model object.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments passed to or from other methods.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A matrix of predictions where the rows correspond to the draws from the estimated model, and
the columns to the observations in the newdata dataset (or the original data if newdata is missing).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>If <code>newdata</code> is omitted the predictions are based on the data
used for the fit.  In that case how cases with missing values in the
original fit is determined by the <code>na.action</code> argument of that
fit.  If <code>na.action = na.omit</code> omitted cases will not appear in
the residuals, whereas if <code>na.action = na.exclude</code> they will
appear (in predictions and standard errors), with residual value
<code>NA</code>.  See also <code><a href="https://rdrr.io/r/stats/nafns.html" class="external-link">napredict</a></code>.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Variables are first looked for in <code>newdata</code> and then searched for
in the usual way (which will include the environment of the formula
used in the fit).  A warning will be given if the
variables found are not of the same length as those in <code>newdata</code>
if it was supplied.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">menarche2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## ----Analysis Setup-----------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Number of variables in model</span></span></span>
<span class="r-in"><span><span class="va">Age</span><span class="op">=</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Age</span></span></span>
<span class="r-in"><span><span class="va">nvars</span><span class="op">=</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="co">## Reference Ages for setting of priors and Age_Difference</span></span></span>
<span class="r-in"><span><span class="va">ref_age1</span><span class="op">=</span><span class="fl">13</span>  <span class="co"># user can modify this</span></span></span>
<span class="r-in"><span><span class="va">ref_age2</span><span class="op">=</span><span class="fl">15</span>  <span class="co">## user can modify this</span></span></span>
<span class="r-in"><span><span class="co">## Define variables used later in analysis</span></span></span>
<span class="r-in"><span><span class="va">Age2</span><span class="op">=</span><span class="va">Age</span><span class="op">-</span><span class="va">ref_age1</span></span></span>
<span class="r-in"><span><span class="va">Age_Diff</span><span class="op">=</span><span class="va">ref_age2</span><span class="op">-</span><span class="va">ref_age1</span></span></span>
<span class="r-in"><span><span class="va">mu1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1.098612</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">V1</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">nvars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">V1</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">0.18687882</span></span></span>
<span class="r-in"><span><span class="va">V1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="fl">0.10576217</span></span></span>
<span class="r-in"><span><span class="va">V1</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="op">-</span><span class="fl">0.03389182</span></span></span>
<span class="r-in"><span><span class="va">V1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="op">-</span><span class="fl">0.03389182</span></span></span>
<span class="r-in"><span><span class="va">Menarche_Model_Data</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Age<span class="op">=</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Age</span>,Total<span class="op">=</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Total</span>,</span></span>
<span class="r-in"><span>                               Menarche<span class="op">=</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Menarche</span>,<span class="va">Age2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">glmb.out1</span><span class="op">&lt;-</span><span class="fu"><a href="glmb.html">glmb</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1000</span>,<span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Menarche</span>, <span class="va">Total</span><span class="op">-</span><span class="va">Menarche</span><span class="op">)</span> <span class="op">~</span><span class="va">Age2</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="va">logit</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                pfamily<span class="op">=</span><span class="fu"><a href="pfamily.html">dNormal</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu1</span>,Sigma<span class="op">=</span><span class="va">V1</span><span class="op">)</span>,data<span class="op">=</span><span class="va">Menarche_Model_Data</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>non-integer #successes in a binomial glm!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Prediction from original model</span></span></span>
<span class="r-in"><span><span class="va">pred0</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">glmb.out1</span>,type<span class="op">=</span><span class="st">"link"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">pred0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1          2          3          4          5          6          7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -6.1633246 -4.5404968 -3.9400506 -3.5343436 -3.1286367 -2.7229298 -2.3172228 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          8          9         10         11         12         13         14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.9115159 -1.5058089 -1.1001020 -0.6943951 -0.2886881  0.1170188  0.5227257 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         15         16         17         18         19         20         21 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.9284327  1.3341396  1.7398466  2.1455535  2.5512604  2.9569674  3.3626743 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         22         23         24         25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3.7683813  4.1740882  4.5797951  7.4197437 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pred1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">glmb.out1</span>,type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">pred1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1           2           3           4           5           6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.002154815 0.010708227 0.019287548 0.028606215 0.042240730 0.061970300 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           7           8           9          10          11          12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.090064656 0.129165081 0.181879488 0.249972513 0.333219429 0.428392563 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          13          14          15          16          17          18 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.529194476 0.627667137 0.716554709 0.791252060 0.850349806 0.894918611 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          19          20          21          22          23          24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.927334055 0.950295800 0.966259475 0.977214740 0.984666546 0.989705057 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.999379836 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Generate new data</span></span></span>
<span class="r-in"><span><span class="va">Age_New</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">20</span>, <span class="fl">0.25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Age2_New</span><span class="op">=</span><span class="va">Age_New</span><span class="op">-</span><span class="fl">13</span></span></span>
<span class="r-in"><span><span class="va">mod_Object</span><span class="op">=</span><span class="va">glmb.out1</span></span></span>
<span class="r-in"><span><span class="va">obs_size</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Total</span><span class="op">)</span> <span class="co">## Counts for sim from Binomial</span></span></span>
<span class="r-in"><span><span class="va">olddata</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Age<span class="op">=</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Age</span>,</span></span>
<span class="r-in"><span>                   Menarche<span class="op">=</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Menarche</span>,Total<span class="op">=</span><span class="va">menarche2</span><span class="op">$</span><span class="va">Total</span>,Age2<span class="op">=</span><span class="va">Age2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">newdata</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Age<span class="op">=</span><span class="va">Age_New</span>,Age2<span class="op">=</span><span class="va">Age2_New</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate for newdata</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pred_menarche</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod_Object</span>,newdata<span class="op">=</span><span class="va">newdata</span>,olddata<span class="op">=</span><span class="va">olddata</span>,type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred_m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">pred_menarche</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mod_Object</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred_y</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="va">n</span>,ncol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Age_New</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">pred_y</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Age_New</span><span class="op">)</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Age_New</span><span class="op">)</span>,size<span class="op">=</span><span class="va">obs_size</span>,</span></span>
<span class="r-in"><span>  prob<span class="op">=</span><span class="va">pred_menarche</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Age_New</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                                                                      <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Produce various predictions</span></span></span>
<span class="r-in"><span><span class="va">pred_y_m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">pred_y</span><span class="op">/</span><span class="va">obs_size</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">quant1_m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pred_menarche</span>,<span class="fl">2</span>,FUN<span class="op">=</span><span class="va">quantile</span>,probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">quant2_m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pred_menarche</span>,<span class="fl">2</span>,FUN<span class="op">=</span><span class="va">quantile</span>,probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">quant1_m_y</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pred_y</span><span class="op">/</span><span class="va">obs_size</span>,<span class="fl">2</span>,FUN<span class="op">=</span><span class="va">quantile</span>,probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">quant2_m_y</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pred_y</span><span class="op">/</span><span class="va">obs_size</span>,<span class="fl">2</span>,FUN<span class="op">=</span><span class="va">quantile</span>,probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Plot Predictions for newdata</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Menarche</span><span class="op">/</span><span class="va">Total</span> <span class="op">~</span> <span class="va">Age</span>, data<span class="op">=</span><span class="va">menarche2</span>,</span></span>
<span class="r-in"><span>main<span class="op">=</span><span class="st">"Percentage of girls Who have had their first period"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">Age_New</span>, <span class="va">pred_m</span>,lty<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">Age_New</span>, <span class="va">quant1_m</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">Age_New</span>, <span class="va">quant2_m</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">Age_New</span>, <span class="va">quant1_m_y</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">Age_New</span>, <span class="va">quant2_m_y</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.glmb-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kjell Nygren.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

