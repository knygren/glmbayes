<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Checks for Prior-data conflicts — Prior_Check • glmbayes</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Checks for Prior-data conflicts — Prior_Check"><meta property="og:description" content="Checks if the credible intervals for the prior overlaps with the implied confidence intervals from
the classical model that comes from a call to the glm function"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glmbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/chapter-01.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-02.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-03.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-04.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-05.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-06.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-07.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-08.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-09.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-10.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-11.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-A1.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-A2.html">UNKNOWN TITLE</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Checks for Prior-data conflicts</h1>

    <div class="hidden name"><code>Prior_Check.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Checks if the credible intervals for the prior overlaps with the implied confidence intervals from
the classical model that comes from a call to the glm function</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Prior_Check</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">family</span>,</span>
<span>  <span class="va">pfamily</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">subset</span>,</span>
<span>  <span class="va">na.action</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">etastart</span>,</span>
<span>  <span class="va">mustart</span>,</span>
<span>  <span class="va">offset</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"glm.fit"</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  contrasts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>an object of class <code>"<a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a>"</code> (or one that
    can be coerced to that class): a symbolic description of the
    model to be fitted.  The details of model specification are given
    under ‘Details’.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>a description of the error distribution and link
    function to be used in the model.  For <code>glm</code> this can be a
    character string naming a family function, a family function or the
    result of a call to a family function.  For <code>glm.fit</code> only the
    third option is supported.  (See <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code> for details of
    family functions.)</p></dd>


<dt id="arg-pfamily">pfamily<a class="anchor" aria-label="anchor" href="#arg-pfamily"></a></dt>
<dd><p>a description of the prior distribution and associated constants to be used in the model. This
should be a pfamily function (see <code><a href="pfamily.html">pfamily</a></code> for details of pfamily functions).</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>the confidence level at which the Prior-data conflict should be checked.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an optional data frame, list or environment (or object
    coercible by <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></code> to a data frame) containing
    the variables in the model.  If not found in <code>data</code>, the
    variables are taken from <code>environment(formula)</code>,
    typically the environment from which <code>glm</code> is called.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>an optional vector of ‘prior weights’ to be used
    in the fitting process.  Should be <code>NULL</code> or a numeric vector.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>an optional vector specifying a subset of observations to be used in the fitting process.</p></dd>


<dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>a function which indicates what should happen when the data contain <code>NA</code>s.  The default is set by
the <code>na.action</code> setting of <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></code>, and is <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.fail</a></code>
if that is unset.  The ‘factory-fresh’ default is <code>stats{na.omit}</code>.
Another possible value is <code>NULL</code>, no action.  Value <code>stats{na.exclude}</code>
can be useful.</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>starting values for the parameters in the linear predictor.</p></dd>


<dt id="arg-etastart">etastart<a class="anchor" aria-label="anchor" href="#arg-etastart"></a></dt>
<dd><p>starting values for the linear predictor.</p></dd>


<dt id="arg-mustart">mustart<a class="anchor" aria-label="anchor" href="#arg-mustart"></a></dt>
<dd><p>starting values for the vector of means.</p></dd>


<dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>this can be used to specify an <em>a priori</em> known component to be included in the linear
predictor during fitting. This should be <code>NULL</code> or a numeric vector of length equal to the number of
cases.  One or more <code><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></code> terms can be included in the formula instead or as well, and
if more than one is specified their sum is used.  See documentation for <code>model.offset</code> at
<code><a href="https://rdrr.io/r/stats/model.extract.html" class="external-link">model.extract</a></code>.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>a list of parameters for controlling the fitting
    process.  For <code>glm.fit</code> this is passed to
    <code><a href="https://rdrr.io/r/stats/glm.control.html" class="external-link">glm.control</a></code>.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>a logical value indicating whether <em>model frame</em>
    should be included as a component of the returned value.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>the method to be used in fitting the model.  The default
    method <code>"glm.fit"</code> uses iteratively reweighted least squares
    (IWLS): the alternative <code>"model.frame"</code> returns the model frame
    and does no fitting.</p>
<p>User-supplied fitting functions can be supplied either as a function
    or a character string naming a function, with a function which takes
    the same arguments as <code>glm.fit</code>.  If specified as a character
    string it is looked up from within the <span class="pkg">stats</span> namespace.</p></dd>


<dt id="arg-x-y">x, y<a class="anchor" aria-label="anchor" href="#arg-x-y"></a></dt>
<dd><p>For <code>glm</code>:
    logical values indicating whether the response vector and model
    matrix used in the fitting process should be returned as components
    of the returned value.</p>
<p>For <code>glm.fit</code>: <code>x</code> is a design matrix of dimension
    <code>n * p</code>, and <code>y</code> is a vector of observations of length
    <code>n</code>.</p></dd>


<dt id="arg-contrasts">contrasts<a class="anchor" aria-label="anchor" href="#arg-contrasts"></a></dt>
<dd><p>an optional list. See the <code>contrasts.arg</code>
    of <code>model.matrix.default</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>For <code>glm</code>: arguments to be used to form the default
    <code>control</code> argument if it is not supplied directly.</p>
<p>For <code>weights</code>: further arguments passed to or from other methods.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A vector where each item provided the ratio of the absolue value for the difference between the
prior and maximum likelihood estimate divided by the length of the sum of half of the two intervals
(where normality is assumed)</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other prior utility Functions:
<code><a href="Prior_Setup.html">Prior_Setup</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Dobson (1990) Page 93: Randomized Controlled Trial :</span></span></span>
<span class="r-in"><span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">18</span>,<span class="fl">17</span>,<span class="fl">15</span>,<span class="fl">20</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">25</span>,<span class="fl">13</span>,<span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">d.AD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">treatment</span>, <span class="va">outcome</span>, <span class="va">counts</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   treatment outcome counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1       1     18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         1       2     17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         1       3     15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         2       1     20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         2       2     10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6         2       3     20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7         3       1     25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8         3       2     13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9         3       3     12</span>
<span class="r-in"><span><span class="co">## Step 1: Set up Prior</span></span></span>
<span class="r-in"><span><span class="va">ps</span><span class="op">=</span><span class="fu"><a href="Prior_Setup.html">Prior_Setup</a></span><span class="op">(</span><span class="va">counts</span> <span class="op">~</span> <span class="va">outcome</span> <span class="op">+</span> <span class="va">treatment</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Variable names are:"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "(Intercept)" "outcome2"    "outcome3"    "treatment2"  "treatment3" </span>
<span class="r-in"><span><span class="va">mu</span><span class="op">=</span><span class="va">ps</span><span class="op">$</span><span class="va">mu</span></span></span>
<span class="r-in"><span><span class="va">V</span><span class="op">=</span><span class="va">ps</span><span class="op">$</span><span class="va">Sigma</span></span></span>
<span class="r-in"><span><span class="co"># Step2A: Check the Prior</span></span></span>
<span class="r-in"><span><span class="fu">Prior_Check</span><span class="op">(</span><span class="va">counts</span> <span class="op">~</span> <span class="va">outcome</span> <span class="op">+</span> <span class="va">treatment</span>,family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            pfamily<span class="op">=</span><span class="fu"><a href="pfamily.html">dNormal</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu</span>,Sigma<span class="op">=</span><span class="va">V</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Variables in the Model Are:"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "(Intercept)" "outcome2"    "outcome3"    "treatment2"  "treatment3" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "At least one of the maximum likelihood estimates appears to be inconsistent with the prior"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                abs_ratio</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 7.072923e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outcome2    2.297241e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outcome3    1.493395e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treatment2  6.168282e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treatment3  4.274795e-16</span>
<span class="r-in"><span><span class="co"># Step2B: Update and Re-Check the Prior</span></span></span>
<span class="r-in"><span><span class="va">mu</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">counts</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">Prior_Check</span><span class="op">(</span><span class="va">counts</span> <span class="op">~</span> <span class="va">outcome</span> <span class="op">+</span> <span class="va">treatment</span>,family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            pfamily<span class="op">=</span><span class="fu"><a href="pfamily.html">dNormal</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu</span>,Sigma<span class="op">=</span><span class="va">V</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Variables in the Model Are:"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "(Intercept)" "outcome2"    "outcome3"    "treatment2"  "treatment3" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The maximum likelihood estimates for all coefficients appear to be roughly consistent with the prior."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                abs_ratio</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 1.199984e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outcome2    2.297241e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outcome3    1.493395e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treatment2  6.168282e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treatment3  4.274795e-16</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kjell Nygren.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

