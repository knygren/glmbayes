<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate constants used during sampling from Likelihood subgradient densities — setlogP • glmbayes</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate constants used during sampling from Likelihood subgradient densities — setlogP"><meta property="og:description" content="This function computes two vectors of constants needed during sampling. The first is used to determine
the probability with which each component of the grid should be visited, while the second
is used as a constants when calculating acceptance rates."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glmbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/chapter-01.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-02.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-03.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-04.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-05.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-06.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-07.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-08.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-09.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-10.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-11.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-A1.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/Chapter-A2.html">UNKNOWN TITLE</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate constants used during sampling from Likelihood subgradient densities</h1>

    <div class="hidden name"><code>setlogP.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function computes two vectors of constants needed during sampling. The first is used to determine
the probability with which each component of the grid should be visited, while the second
is used as a constants when calculating acceptance rates.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">setlogP</span><span class="op">(</span><span class="va">logP</span>, <span class="va">NegLL</span>, <span class="va">cbars</span>, <span class="va">G3</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-logp">logP<a class="anchor" aria-label="anchor" href="#arg-logp"></a></dt>
<dd><p>A matrix that typically contains two columns and information for each component of the grid. The
first column will typically hold the final output from the Set_Grid function, which is the density
associated with the related restricted normal.</p></dd>


<dt id="arg-negll">NegLL<a class="anchor" aria-label="anchor" href="#arg-negll"></a></dt>
<dd><p>A vector with evaluations of the Negative Log-likelihood for each of the components of the grid.</p></dd>


<dt id="arg-cbars">cbars<a class="anchor" aria-label="anchor" href="#arg-cbars"></a></dt>
<dd><p>A matix holding the gradients for the Negative of the Log-likelihood for each of the
componentsof the grid.</p></dd>


<dt id="arg-g-">G3<a class="anchor" aria-label="anchor" href="#arg-g-"></a></dt>
<dd><p>A matrix containing the set of tangent points used in the grid.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Refer to Nygren and Nygren (2006) for details. The first .</p>
<dl><dt>logP</dt>
<dd><p>The first column holds the value passed into the function while the second contains the log of the
(un-normalized) probabilities with which each of the components of the grid should be visited. This corresponds
to the log of the denominator components used to compute p_i in remark 6 in Nygren and Nygren (2006)</p></dd>

<dt>LLconst</dt>
<dd><p>This holds a vector of constants used as upper bounds when deriving acceptance rates during the
accept-reject sampling process. This constant corresponds to the denominator for the function h() in Theorem 1
of Nygren and Nygren (2006). During the sampling, the log of the numerator of the same function if evaluated for
each candidate and the difference between the candidate value and this constant is used to determine the acceptance
rate to use when evaluating acceptance of the candidate. If the evaluated value for the candidate is close to
this constant, then the chance of acceptance rate is high. If it is much smaller, then the chance of acceptance
is low.</p></dd>

</dl></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## ----dobson-------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Dobson (1990) Page 93: Randomized Controlled Trial :</span></span></span>
<span class="r-in"><span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">18</span>,<span class="fl">17</span>,<span class="fl">15</span>,<span class="fl">20</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">25</span>,<span class="fl">13</span>,<span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Prior mean vector </span></span></span>
<span class="r-in"><span><span class="va">mu</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>           </span></span>
<span class="r-in"><span><span class="va">mu</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">counts</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="co">## Prior standard deviation and Variance</span></span></span>
<span class="r-in"><span><span class="va">mysd</span><span class="op">&lt;-</span><span class="fl">1</span>           </span></span>
<span class="r-in"><span><span class="va">V</span><span class="op">=</span><span class="op">(</span><span class="op">(</span><span class="va">mysd</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>  </span></span>
<span class="r-in"><span><span class="co">## Call to glmb</span></span></span>
<span class="r-in"><span><span class="va">glmb.D93</span><span class="op">&lt;-</span><span class="fu"><a href="glmb.html">glmb</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1000</span>,<span class="va">counts</span> <span class="op">~</span> <span class="va">outcome</span> <span class="op">+</span> <span class="va">treatment</span>,</span></span>
<span class="r-in"><span>               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,pfamily<span class="op">=</span><span class="fu"><a href="pfamily.html">dNormal</a></span><span class="op">(</span>mu<span class="op">=</span><span class="va">mu</span>,Sigma<span class="op">=</span><span class="va">V</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## ----glmb extractAIC-------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/extractAIC.html" class="external-link">extractAIC</a></span><span class="op">(</span><span class="va">glmb.D93</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       pD      DIC </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4.95435 56.75433 </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kjell Nygren.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

