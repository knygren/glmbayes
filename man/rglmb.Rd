% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rglmb.R
\name{rglmb}
\alias{rglmb}
\alias{print.rglmb}
\title{The Bayesian Generalized Linear Model Distribution}
\usage{
rglmb(n = 1, y, x, family = gaussian(), pfamily, offset = NULL, weights = 1)

\method{print}{rglmb}(x, digits = max(3, getOption("digits") - 3), ...)
}
\arguments{
\item{n}{number of draws to generate. If \code{length(n) > 1}, the length is taken to be the number required.}

\item{y}{a vector of observations of length \code{m}.}

\item{x}{for \code{rglmb} a design matrix of dimension \code{m * p} and for \code{print.rglmb} the object to be printed.}

\item{family}{a description of the error distribution and link
    function to be used in the model.  For \code{glm} this can be a
    character string naming a family function, a family function or the
    result of a call to a family function.  For \code{glm.fit} only the
    third option is supported.  (See \code{\link[stats]{family}} for details of
    family functions.)}

\item{pfamily}{a description of the prior distribution and associated constants to be used in the model. This
should be a pfamily function (see \code{\link{pfamily}} for details of pfamily functions and \sQuote{Details}
for details about prior specifications).}

\item{offset}{this can be used to specify an \emph{a priori} known component to be included in the linear 
predictor during fitting. This should be \code{NULL} or a numeric vector of length equal to the number of 
cases.  One or more \code{\link[stats]{offset}} terms can be included in the formula instead or as well, and 
if more than one is specified their sum is used.  See documentation for \code{model.offset} at 
\code{\link[stats]{model.extract}}.}

\item{weights}{an optional vector of \sQuote{prior weights} to be used
    in the fitting process.  Should be \code{NULL} or a numeric vector.}

\item{digits}{the number of significant digits to use when printing.}

\item{...}{
    For \code{glm}: arguments to be used to form the default
    \code{control} argument if it is not supplied directly.

    For \code{weights}: further arguments passed to or from other methods.
  }
}
\value{
\code{rglmb} returns a object of class \code{"rglmb"}.  The function \code{summary} 
(i.e., \code{\link{summary.rglmb}}) can be used to obtain or print a summary of the results.
The generic accessor functions \code{\link{coefficients}}, \code{\link{fitted.values}},
\code{\link{residuals}}, and \code{\link{extractAIC}} can be used to extract
various useful features of the value returned by \code{\link{rglmb}}.
An object of class \code{"rglmb"} is a list containing at least the following components:
\item{coefficients}{a \code{n} by \code{length(mu)} matrix with one sample in each row}
\item{PostMode}{a vector of \code{length(mu)} with the estimated posterior mode coefficients}
\item{Prior}{A list with two components. The first being the prior mean vector and the second the prior precision matrix}
\item{iters}{an \code{n} by \code{1} matrix giving the number of candidates generated before acceptance for each sample.}
\item{famfunc}{an object of class \code{"famfunc"}}
\item{Envelope}{an object of class \code{"envelope"}  }
\item{dispersion}{the dispersion parameter used in the model}
\item{loglike}{a \code{n} by \code{1} matrix containing the negative loglikelihood for each sample.}
}
\description{
\code{rglmb} is used to generate iid samples for Bayesian Generalized Linear Models.
The model is specified by providing a data vector, a design matrix, 
the family (determining the likelihood function) and the pfamily (determining the 
prior distribution).
}
\examples{
data(menarche2)

summary(menarche2)
plot(Menarche/Total ~ Age, data=menarche2)

Age2=menarche2$Age-13

x<-matrix(as.numeric(1.0),nrow=length(Age2),ncol=2)
x[,2]=Age2

y=menarche2$Menarche/menarche2$Total
wt=menarche2$Total

mu<-matrix(as.numeric(0.0),nrow=2,ncol=1)
mu[2,1]=(log(0.9/0.1)-log(0.5/0.5))/3

V1<-1*diag(as.numeric(2.0))

# 2 standard deviations for prior estimate at age 13 between 0.1 and 0.9
## Specifies uncertainty around the point estimates

V1[1,1]<-((log(0.9/0.1)-log(0.5/0.5))/2)^2 
V1[2,2]=(3*mu[2,1]/2)^2  # Allows slope to be up to 3 times as large as point estimate 

out<-rglmb(n = 1000, y=y, x=x, pfamily=dNormal(mu=mu,Sigma=V1), weights = wt, 
           family = binomial(logit)) 
summary(out)

# Add mean(out$iters to rglmb summary function)
mean(out$iters)
}
\references{
Dobson, A. J. (1990)
\emph{An Introduction to Generalized Linear Models.}
London: Chapman and Hall.

Hastie, T. J. and Pregibon, D. (1992)
\emph{Generalized linear models.}
Chapter 6 of \emph{Statistical Models in S}
eds J. M. Chambers and T. J. Hastie, Wadsworth & Brooks/Cole.
McCullagh P. and Nelder, J. A. (1989)
\emph{Generalized Linear Models.}
London: Chapman and Hall.

Nygren, K.N. and Nygren, L.M (2006)
Likelihood Subgradient Densities. \emph{Journal of the American Statistical Association}.
vol.101, no.475, pp 1144-1156.
doi: \href{https://doi.org/10.1198/016214506000000357}{10.1198/016214506000000357}.

Raiffa, Howard and Schlaifer, R (1961)
\emph{Applied Statistical Decision Theory.}
Boston: Clinton Press, Inc.

Venables, W. N. and Ripley, B. D. (2002)
\emph{Modern Applied Statistics with S.}
New York: Springer.
}
\seealso{
\code{\link[stats]{lm}} and \code{\link[stats]{glm}} for classical modeling functions.

\code{\link{pfamily}} for documentation of pfamily functions used to specify priors.

\code{\link{Prior_Setup}}, \code{\link{Prior_Check}} for functions used to initialize and to check priors,  

\code{\link{summary.glmb}}, \code{\link{predict.glmb}}, \code{\link{residuals.glmb}}, \code{\link{simulate.glmb}}, 
\code{\link{extractAIC.glmb}}, \code{\link{dummy.coef.glmb}} and methods(class="glmb") for \code{glmb} 
and the methods and generic functions for classes \code{glm} and \code{lm} from which class \code{glmb} inherits.

Other glmbayes modeling functions:
\code{\link{glmb}()},
\code{\link{lmb}()},
\code{\link{rlmb}()}
}
\author{
The \R implementation of \code{rglmb} has been written by Kjell Nygren and
was built to be a Bayesian version of the \code{glm} function but with a more minimalistic interface 
than the \code{glmb} function. It also borrows some of its structure from other random generating function 
like \code{\link{rnorm}} and hence the \code{r} prefix.
}
\concept{modelfuns}
