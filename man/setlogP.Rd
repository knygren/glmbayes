% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/setlogP.R
\name{setlogP}
\alias{setlogP}
\title{Calculate constants used during sampling from Likelihood subgradient densities}
\usage{
setlogP(logP, NegLL, cbars, G3)
}
\arguments{
\item{logP}{A matrix that typically contains two columns and information for each component of the grid. The 
first column will typically hold the final output from the Set_Grid function, which is the density
associated with the related restricted normal.}

\item{NegLL}{A vector with evaluations of the Negative Log-likelihood for each of the components of the grid.}

\item{cbars}{A matix holding the gradients for the Negative of the Log-likelihood for each of the 
componentsof the grid.}

\item{G3}{A matrix containing the set of tangent points used in the grid.}
}
\value{
Refer to Nygren and Nygren (2006) for details. The first .
\item{logP}{The first column holds the value passed into the function while the second contains the log of the 
(un-normalized) probabilities with which each of the components of the grid should be visited. This corresponds 
to the log of the denominator components used to compute p_i in remark 6 in Nygren and Nygren (2006)}
\item{LLconst}{This holds a vector of constants used as upper bounds when deriving acceptance rates during the 
accept-reject sampling process. This constant corresponds to the denominator for the function h() in Theorem 1 
of Nygren and Nygren (2006). During the sampling, the log of the numerator of the same function if evaluated for
each candidate and the difference between the candidate value and this constant is used to determine the acceptance
rate to use when evaluating acceptance of the candidate. If the evaluated value for the candidate is close to 
this constant, then the chance of acceptance rate is high. If it is much smaller, then the chance of acceptance 
is low.}
}
\description{
This function computes two vectors of constants needed during sampling. The first is used to determine
the probability with which each component of the grid should be visited, while the second 
is used as a constants when calculating acceptance rates.
}
\examples{
data(menarche2)

summary(menarche2)
plot(Menarche/Total ~ Age, data=menarche2)

Age2=menarche2$Age-13

x<-matrix(as.numeric(1.0),nrow=length(Age2),ncol=2)
x[,2]=Age2

y=menarche2$Menarche/menarche2$Total
wt=menarche2$Total

mu<-matrix(as.numeric(0.0),nrow=2,ncol=1)
mu[2,1]=(log(0.9/0.1)-log(0.5/0.5))/3

V1<-1*diag(as.numeric(2.0))

# 2 standard deviations for prior estimate at age 13 between 0.1 and 0.9
## Specifies uncertainty around the point estimates

V1[1,1]<-((log(0.9/0.1)-log(0.5/0.5))/2)^2 
V1[2,2]=(3*mu[2,1]/2)^2  # Allows slope to be up to 3 times as large as point estimate 
prior=list(mu=mu,P=solve(V1))
out<-rglmb(n = 1000, y=y, x=x,family = binomial(logit), 
pfamily=dNormal(mu=mu,Sigma=V1),weights = wt ) 
summary(out)

mean(out$iters)
}
