% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rlmb.R
\name{rlmb}
\alias{rlmb}
\alias{print.rlmb}
\title{The Bayesian Linear Model Distribution}
\usage{
rlmb(n = 1, y, x, pfamily, offset = rep(0, nobs), weights = NULL)

\method{print}{rlmb}(x, digits = max(3, getOption("digits") - 3), ...)
}
\arguments{
\item{n}{number of draws to generate. If \code{length(n) > 1}, the length is taken to be the number required.}

\item{y}{a vector of observations of length \code{m}.}

\item{x}{a design matrix of dimension \code{m * p}.}

\item{pfamily}{the prior family to use for the model (including the constants passed to prior).}

\item{offset}{an offset parameter}

\item{weights}{a weighting variable}

\item{digits}{the number of significant digits to use when printing.}

\item{\ldots}{additional optional arguments.}
}
\value{
\code{rlmb} returns a object of class \code{"rglmb"}.  The function \code{summary} 
(i.e., \code{\link{summary.rglmb}}) can be used to obtain or print a summary of the results.
The generic accessor functions \code{\link{coefficients}}, \code{\link{fitted.values}},
\code{\link{residuals}}, and \code{\link{extractAIC}} can be used to extract
various useful features of the value returned by \code{\link{rglmb}}.
An object of class \code{"rglmb"} is a list containing at least the following components:
\item{coefficients}{a \code{n} by \code{length(mu)} matrix with one sample in each row}
\item{PostMode}{a vector of \code{length(mu)} with the estimated posterior mode coefficients}
\item{Prior}{A list with two components. The first being the prior mean vector and the second the prior precision matrix}
\item{iters}{an \code{n} by \code{1} matrix giving the number of candidates generated before acceptance for each sample.}
\item{famfunc}{an object of class \code{"famfunc"}}
\item{Envelope}{an object of class \code{"envelope"}  }
\item{dispersion}{the dispersion parameter used in the model}
\item{loglike}{a \code{n} by \code{1} matrix containing the negative loglikelihood for each sample.}
}
\description{
\code{rlmb} is used to generate iid samples from Bayesian Linear Models with multivariate normal priors. 
The model is specified by providing a data vector, a design matrix, and at least 2 prior constants.
}
\details{
The \code{rglmb} function produces iid samples for Bayesian generalized linear 
models. It has a more minimialistic interface than than the \code{\link{glmb}} 
function. Core required inputs for the function include the data vector, the design  
matrix and a prior specification. In addition, the dispersion parameter must 
currently be provided for the gaussian, Gamma, quasipoisson, and quasibinomial 
families (future implementations may incorporate a prior for these into the 
\code{rglmb} function).

Current implemented models include the gaussian family (identity link function), the
poisson and quasipoisson families (log link function), the gamma family (log link 
function), as well as the binomial and quasibinomial families (logit, probit, and 
cloglog link functions). The function returns the simulated Bayesian coefficients 
and some associated outputs.

For the gaussian family, iid samples from the posterior density are genererated using 
standard simulation procedures for multivariate normal densities. For all other 
families, the samples are generated using accept-reject procedures by leveraging the 
likelihood subgradient approach of Nygren and Nygren (2006). This approach relies on
tight enveloping functions that bound the posterior density from above. The Gridtype 
parameter is used to select the method used for determining the size of a Grid used 
to build the enveloping function. See \code{\link{EnvelopeBuild}} for details. 
Depending on the selection, the time to build the envelope and the acceptance rate 
during the simulation process may vary. The returned value \code{iters} contains the 
number of candidates generated before acceptance for each draw.
}
\examples{
## Annette Dobson (1990) "An Introduction to Generalized Linear Models".
## Page 9: Plant Weight Data.
ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
weight <- c(ctl, trt)
lm.D9 <- lm(weight ~ group,x=TRUE,y=TRUE)

lm_summary=summary(lm.D9)

lm_summary
lm.D9$coefficients

n<-10000
y<-lm.D9$y
x<-as.matrix(lm.D9$x)

### Set old regression and dispersion coefficients

b_old=lm.D9$coefficients
v_old=lm_summary$sigma^2

#### Set up for rglmb_dispersion

n0=0.1
shape=n0/2
rate=shape*v_old

rate/(shape-1)
rate/shape

#a1<-shape+n1/2
#b1<-rate+sum(SS)/2

#out<-1/rgamma(n,shape=a1,rate=b1)
## v0=sum(SS)/n1 ~ (2*rate+sum(SS))/(2*shape+n1)=[(2*rate+sum(SS))/2]/((2*shape+n1)/2) 
n1=length(y)
SS=v_old*n1

n1 # This is equal to 20


n0=2 # Prior observations
v_prior=v_old  # Prior point estimate for variance (the mean of (1/dispersion=1/v_prior))
wt0=(n0/n1)  

## set shape=0.01*(n1/2)
## set rate= 0.01*SS/2

shape=wt0*(n1/2)   ###  Shape is prior observations /2
rate=shape*v_prior  ### rate is essentiall prior SS - V in rmultireg should be this
rate/shape ## Should match v_prior (currently also v_old)

mu<-c(0,0)
mu=b_old  ### For testing purposes, set prior=b_old
P<-0.1*diag(2)

outtemp4=rlmb(n=1000,y=y,x=x,pfamily=dNormal_Gamma(mu=mu,Sigma=solve(P),shape=shape,rate=rate))
}
\references{
Dobson, A. J. (1990)
\emph{An Introduction to Generalized Linear Models.}
London: Chapman and Hall.

Hastie, T. J. and Pregibon, D. (1992)
\emph{Generalized linear models.}
Chapter 6 of \emph{Statistical Models in S}
eds J. M. Chambers and T. J. Hastie, Wadsworth & Brooks/Cole.
McCullagh P. and Nelder, J. A. (1989)
\emph{Generalized Linear Models.}
London: Chapman and Hall.

Nygren, K.N. and Nygren, L.M (2006)
Likelihood Subgradient Densities. \emph{Journal of the American Statistical Association}.
vol.101, no.475, pp 1144-1156.

Raiffa, Howard and Schlaifer, R (1961)
\emph{Applied Statistical Decision Theory.}
Boston: Clinton Press, Inc.

Venables, W. N. and Ripley, B. D. (2002)
\emph{Modern Applied Statistics with S.}
New York: Springer.
}
\seealso{
The classical modeling functions \code{\link[stats]{lm}} and \code{\link[stats]{glm}}.

Other Modeling Functions:
\code{\link{glmb}()},
\code{\link{lmb}()},
\code{\link{rglmb}()}
}
\concept{modelfuns}
