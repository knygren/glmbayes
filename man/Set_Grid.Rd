% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Set_Grid.R
\name{Set_Grid}
\alias{Set_Grid}
\title{Calculate Log-densities for Grid Components}
\usage{
Set_Grid(GridIndex, cbars, Lint)
}
\arguments{
\item{GridIndex}{A matrix containing information for each component in the grid related
to whether the components is to the left, in the center, or to the right of the density. 
Each row corresponds to a component in the grid, while the columns correspond to the 
transformed (standardized) variables.}

\item{cbars}{A matrix containing the subgradient for the (adjusted) negative log-likelihood function
for each the component in the grid.}

\item{Lint}{A matrix storing information on where the upper and lower bounds are, depending
on whether the sampling is from the left, the center, or the right.}
}
\value{
Refer to Nygren and Nygren (2006) for details. The first set of items refers to Example 2 in section 
3.1. All except the last item in this list of returned items has a number of rows equaling the number of 
components of the grid and a number of columns equaling the number of coefficients in the model. All quantities 
refer to the respective coefficient for each of the components of the grid.
\item{Down}{The lower bounds for the interval to be evaluated. Either negative infinity or a real number.}
\item{Up}{The upper bounds for the interval to be evaluated. Either positive infinity or a real number.}
\item{lglt}{The log of the density between negative infinity and the upper bound}
\item{lgrt}{The log of the density between the lower bound and infinity}
\item{lgct}{The log of the density between the lower and upper bounds}
\item{logU}{The one of the 3 above that is relevant for the component of the grid}
\item{logP}{A two column matrix, the first of which holds sum of logU across the components. The second column is 
0 and is later populated by the Set_logP function}
}
\description{
Computes un-normalized log of the density associated with each component of a Grid
used to sample using the likelihood-subgradient density approach
}
\examples{
data(menarche2)

summary(menarche2)
plot(Menarche/Total ~ Age, data=menarche2)

Age2=menarche2$Age-13

x<-matrix(as.numeric(1.0),nrow=length(Age2),ncol=2)
x[,2]=Age2

y=menarche2$Menarche/menarche2$Total
wt=menarche2$Total

mu<-matrix(as.numeric(0.0),nrow=2,ncol=1)
mu[2,1]=(log(0.9/0.1)-log(0.5/0.5))/3

V1<-1*diag(as.numeric(2.0))

# 2 standard deviations for prior estimate at age 13 between 0.1 and 0.9
## Specifies uncertainty around the point estimates

V1[1,1]<-((log(0.9/0.1)-log(0.5/0.5))/2)^2 
V1[2,2]=(3*mu[2,1]/2)^2  # Allows slope to be up to 3 times as large as point estimate 
prior=list(mu=mu,P=solve(V1))
out<-rglmb(n = 1000, y=y, x=x, prior=prior, wt = wt, 
           family = binomial(logit), Gridtype = 3) 
summary(out)

mean(out$iters)
}
