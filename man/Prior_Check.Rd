% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Prior_Check.R
\name{Prior_Check}
\alias{Prior_Check}
\title{Checks for Prior-data conflicts}
\usage{
Prior_Check(formula, family, pfamily, level = 0.95, data = NULL)
}
\arguments{
\item{formula}{an object of class \code{"\link[stats]{formula}"} (or one that
    can be coerced to that class): a symbolic description of the
    model to be fitted.  The details of model specification are given
    under \sQuote{Details}.}

\item{family}{a description of the error distribution and link
    function to be used in the model.  For \code{glm} this can be a
    character string naming a family function, a family function or the
    result of a call to a family function.  For \code{glm.fit} only the
    third option is supported.  (See \code{\link[stats]{family}} for details of
    family functions.)}

\item{pfamily}{the prior family to use for the model (including the constants passed to prior).}

\item{level}{the confidence level at which the Prior-data conflict should be checked.}

\item{data}{an optional data frame, list or environment (or object
    coercible by \code{\link{as.data.frame}} to a data frame) containing
    the variables in the model.  If not found in \code{data}, the
    variables are taken from \code{environment(formula)},
    typically the environment from which \code{glm} is called.}

\item{mu}{a vector of length \code{p} giving the prior means of the variables in the design matrix.}

\item{Sigma}{a positive-definite symmetric matrix of dimension \code{p * p} specifying the prior covariance matrix of the variables.}
}
\value{
A vector where each item provided the ratio of the absolue value for the difference between the 
prior and maximum likelihood estimate divided by the length of the sum of half of the two intervals 
(where normality is assumed)
}
\description{
Checks if the credible intervals for the prior overlaps with the implied confidence intervals from 
the classical model that comes from a call to the glm function
}
\examples{
## Dobson (1990) Page 93: Randomized Controlled Trial :
counts <- c(18,17,15,20,10,20,25,13,12)
outcome <- gl(3,1,9)
treatment <- gl(3,3)
print(d.AD <- data.frame(treatment, outcome, counts))


glm.D93 <- glm(counts ~ outcome + treatment, family = poisson(),x=TRUE)

summary(glm.D93)

n<-1000
mu<-matrix(0,5)
X<-glm.D93$x
Xmu=glm.D93$x\%*\%glm.D93$coefficients
explambda=diag(as.vector(exp(Xmu)))

# Use approximately conjugate prior for mu with 10\% weight on prior

wt_0<-0.1
m_0=exp(log(wt_0/(1-wt_0)))
V0<-solve(m_0*t(X)\%*\%explambda\%*\%X)

diag(sqrt(diag(V0)))
V0
sqrt(diag(V0))


Like_std=summary(glm.D93)$coefficients[,2]
Prior_Check(counts ~ outcome + treatment, family = poisson(),pfamily=dNormal(mu=mu,Sigma=V0))

#D93_Prior_Error_Checks=Prior_Check(glm.D93,mu,V0)



mu[1,1]=0+4*sqrt(diag(V0)[1])
mu[1,1]=0+15*Like_std[1]
mu[1,1]=log(mean(counts))
mu

Prior_Check(counts ~ outcome + treatment, family = poisson(),pfamily=dNormal(mu=mu,Sigma=V0))

#glmb.D93<-glmb(n=n,counts ~ outcome + treatment, family = poisson(),mu=mu,Sigma=V0,Gridtype=3)
#summary(glmb.D93)
}
