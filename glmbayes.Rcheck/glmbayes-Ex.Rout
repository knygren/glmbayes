
R version 4.5.1 (2025-06-13 ucrt) -- "Great Square Root"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> pkgname <- "glmbayes"
> source(file.path(R.home("share"), "R", "examples-header.R"))
> options(warn = 1)
> options(pager = "console")
> library('glmbayes')
Loading required package: MASS
> 
> base::assign(".oldSearch", base::search(), pos = 'CheckExEnv')
> base::assign(".old_wd", base::getwd(), pos = 'CheckExEnv')
> cleanEx()
> nameEx("AMI")
> ### * AMI
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: AMI
> ### Title: amitriptyline overdose data
> ### Aliases: AMI
> ### Keywords: datasets, Bayesian Binomial Regression
> 
> ### ** Examples
> 
> data(menarche2)
> 
> 
> 
> cleanEx()
> nameEx("EnvelopeBuild")
> ### * EnvelopeBuild
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: EnvelopeBuild
> ### Title: Builds Envelope function for simulation
> ### Aliases: EnvelopeBuild
> ### Keywords: internal
> 
> ### ** Examples
> 
> data(menarche2)
> 
> summary(menarche2)
      Age            Total           Menarche      
 Min.   : 9.21   Min.   :  88.0   Min.   :   0.00  
 1st Qu.:11.58   1st Qu.:  98.0   1st Qu.:  10.00  
 Median :13.08   Median : 105.0   Median :  51.00  
 Mean   :13.10   Mean   : 156.7   Mean   :  92.32  
 3rd Qu.:14.58   3rd Qu.: 117.0   3rd Qu.:  92.00  
 Max.   :17.58   Max.   :1049.0   Max.   :1049.00  
> plot(Menarche/Total ~ Age, data=menarche2)
> 
> Age2=menarche2$Age-13
> 
> x<-matrix(as.numeric(1.0),nrow=length(Age2),ncol=2)
> x[,2]=Age2
> 
> y=menarche2$Menarche/menarche2$Total
> wt=menarche2$Total
> 
> mu<-matrix(as.numeric(0.0),nrow=2,ncol=1)
> mu[2,1]=(log(0.9/0.1)-log(0.5/0.5))/3
> 
> V1<-1*diag(as.numeric(2.0))
> 
> # 2 standard deviations for prior estimate at age 13 between 0.1 and 0.9
> ## Specifies uncertainty around the point estimates
> 
> V1[1,1]<-((log(0.9/0.1)-log(0.5/0.5))/2)^2 
> V1[2,2]=(3*mu[2,1]/2)^2  # Allows slope to be up to 1 times as large as point estimate 
> 
> famfunc<-glmbfamfunc(binomial(logit))
> 
> f1<-famfunc$f1
> f2<-famfunc$f2
> f3<-famfunc$f3
> f5<-famfunc$f5
> f6<-famfunc$f6
> 
> dispersion2<-as.numeric(1.0)
> start <- mu
> offset2=rep(as.numeric(0.0),length(y))
> P=solve(V1)
> n=1000
> 
> 
> ###### Adjust weight for dispersion
> 
> wt2=wt/dispersion2
> 
> ######################### Shift mean vector to offset so that adjusted model has 0 mean
> 
> alpha=x%*%as.vector(mu)+offset2
> mu2=0*as.vector(mu)
> P2=P
> x2=x
> 
> 
> #####  Optimization step to find posterior mode and associated Precision
> 
> parin=start-mu
> 
> opt_out=optim(parin,f2,f3,y=as.vector(y),x=as.matrix(x),mu=as.vector(mu2),
+               P=as.matrix(P),alpha=as.vector(alpha),wt=as.vector(wt2),
+               method="BFGS",hessian=TRUE
+ )
> 
> bstar=opt_out$par  ## Posterior mode for adjusted model
> bstar
            [,1]
[1,] -0.01069645
[2,]  0.89698197
> bstar+as.vector(mu)  # mode for actual model
            [,1]
[1,] -0.01069645
[2,]  1.62939016
> A1=opt_out$hessian # Approximate Precision at mode
> 
> ## Standardize Model
> 
> Standard_Mod=glmb_Standardize_Model(y=as.vector(y), x=as.matrix(x),P=as.matrix(P),
+                                     bstar=as.matrix(bstar,ncol=1), A1=as.matrix(A1))
> 
> bstar2=Standard_Mod$bstar2  
> A=Standard_Mod$A
> x2=Standard_Mod$x2
> mu2=Standard_Mod$mu2
> P2=Standard_Mod$P2
> L2Inv=Standard_Mod$L2Inv
> L3Inv=Standard_Mod$L3Inv
> 
> Env2=EnvelopeBuild(as.vector(bstar2), as.matrix(A),y, as.matrix(x2),
+ as.matrix(mu2,ncol=1),as.matrix(P2),as.vector(alpha),as.vector(wt2),
+ family="binomial",link="logit",Gridtype=as.integer(3), n=as.integer(n),
+ sortgrid=TRUE)
Entering EnvelopeBuild_c: 2025-08-03 19:21:19
Entering Envelope Loop: 2025-08-03 19:21:19
Initiating NegLL Calculations: 2025-08-03 19:21:19
Initiating Gradient Calculations: 2025-08-03 19:21:19
> 
> ## These now seem to match
> 
> Env2
$GridIndex
  GIndex.Var1 GIndex.Var2
5           2           2
6           3           2
8           2           3
2           2           1
4           1           2
9           3           3
3           3           1
7           1           3
1           1           1

$thetabars
    G3.Var1    G3.Var2
5 0.5662049 0.11300265
6 0.6195287 0.11300265
8 0.5662049 0.17044504
2 0.5662049 0.05556027
4 0.5128810 0.11300265
9 0.6195287 0.17044504
3 0.6195287 0.05556027
7 0.5128810 0.17044504
1 0.5128810 0.05556027

$cbars
      cbars.1     cbars.2
5  -0.5661981  -0.1130015
6  34.4621159  -0.2437098
8  -1.4475523  34.1689246
2  -1.4796882 -35.3623598
4 -40.7542186  -0.2682291
9  33.3865305  32.4873204
3  33.8979746 -33.8580716
7 -41.3722300  35.7125259
1 -42.1074002 -37.3119403

$logU
       logU.1      logU.2
5   -3.850428   -3.776049
6 -618.902574   -3.784589
8   -4.238723 -593.065539
2   -4.267555 -626.754407
4 -813.223858   -3.788093
9 -581.745276 -536.732343
3 -599.269541 -574.773949
7 -838.283187 -647.262791
1 -868.590223 -697.486001

$logrt
       logrt.1      logrt.2
5   -0.6721049   -0.6704936
6 -618.9025745   -0.5738821
8   -0.2008155 -593.0655394
2   -0.1906419    0.0000000
4    0.0000000   -0.5569172
9 -581.7452759 -536.7323432
3 -599.2695410    0.0000000
7    0.0000000 -647.2627913
1    0.0000000    0.0000000

$loglt
       loglt.1      loglt.2
5   -0.6720943   -0.6704918
6    0.0000000   -0.7778690
8   -1.6277922    0.0000000
2   -1.6735097 -626.7544071
4 -813.2238580   -0.7992502
9    0.0000000    0.0000000
3    0.0000000 -574.7739490
7 -838.2831866    0.0000000
1 -868.5902230 -697.4860009

$LLconst
[1] 55.87862 35.14719 51.52363 59.36200 77.55426 31.17893 38.32546 72.77690
[9] 81.36520

$logP
[1]    -7.626477  -622.687163  -597.304262  -631.021962  -817.011951
[6] -1118.477619 -1174.043490 -1485.545978 -1566.076224

$PLSD
[1] 0.24960979 0.13063173 0.12594361 0.12363622 0.11925255 0.06975357 0.06737136
[8] 0.05788189 0.05591928

$a1
[1] 702.3746 605.1290

> 
> 
> 
> cleanEx()
> nameEx("EnvelopeOpt")
> ### * EnvelopeOpt
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: EnvelopeOpt
> ### Title: Optimizes Envelope function for simulation
> ### Aliases: EnvelopeOpt
> ### Keywords: internal
> 
> ### ** Examples
> 
> data(menarche2)
> 
> summary(menarche2)
      Age            Total           Menarche      
 Min.   : 9.21   Min.   :  88.0   Min.   :   0.00  
 1st Qu.:11.58   1st Qu.:  98.0   1st Qu.:  10.00  
 Median :13.08   Median : 105.0   Median :  51.00  
 Mean   :13.10   Mean   : 156.7   Mean   :  92.32  
 3rd Qu.:14.58   3rd Qu.: 117.0   3rd Qu.:  92.00  
 Max.   :17.58   Max.   :1049.0   Max.   :1049.00  
> plot(Menarche/Total ~ Age, data=menarche2)
> 
> Age2=menarche2$Age-13
> 
> x<-matrix(as.numeric(1.0),nrow=length(Age2),ncol=2)
> x[,2]=Age2
> 
> y=menarche2$Menarche/menarche2$Total
> wt=menarche2$Total
> 
> mu<-matrix(as.numeric(0.0),nrow=2,ncol=1)
> mu[2,1]=(log(0.9/0.1)-log(0.5/0.5))/3
> 
> V1<-1*diag(as.numeric(2.0))
> 
> # 2 standard deviations for prior estimate at age 13 between 0.1 and 0.9
> ## Specifies uncertainty around the point estimates
> 
> V1[1,1]<-((log(0.9/0.1)-log(0.5/0.5))/2)^2 
> V1[2,2]=(3*mu[2,1]/2)^2  # Allows slope to be up to 1 times as large as point estimate 
> 
> famfunc<-glmbfamfunc(binomial(logit))
> 
> f1<-famfunc$f1
> f2<-famfunc$f2
> f3<-famfunc$f3
> f5<-famfunc$f5
> f6<-famfunc$f6
> 
> dispersion2<-as.numeric(1.0)
> start <- mu
> offset2=rep(as.numeric(0.0),length(y))
> P=solve(V1)
> n=1000
> 
> 
> 
> ###### Adjust weight for dispersion
> 
> wt2=wt/dispersion2
> 
> ######################### Shift mean vector to offset so that adjusted model has 0 mean
> 
> alpha=x%*%as.vector(mu)+offset2
> mu2=0*as.vector(mu)
> P2=P
> x2=x
> 
> 
> #####  Optimization step to find posterior mode and associated Precision
> 
> parin=start-mu
> 
> opt_out=optim(parin,f2,f3,y=as.vector(y),x=as.matrix(x),mu=as.vector(mu2),
+               P=as.matrix(P),alpha=as.vector(alpha),wt=as.vector(wt2),
+               method="BFGS",hessian=TRUE
+ )
> 
> bstar=opt_out$par  ## Posterior mode for adjusted model
> bstar
            [,1]
[1,] -0.01069645
[2,]  0.89698197
> bstar+as.vector(mu)  # mode for actual model
            [,1]
[1,] -0.01069645
[2,]  1.62939016
> A1=opt_out$hessian # Approximate Precision at mode
> 
> ## Standardize Model
> 
> Standard_Mod=glmb_Standardize_Model(y=as.vector(y), x=as.matrix(x),
+ P=as.matrix(P),bstar=as.matrix(bstar,ncol=1), A1=as.matrix(A1))
> 
> bstar2=Standard_Mod$bstar2  
> A=Standard_Mod$A
> x2=Standard_Mod$x2
> mu2=Standard_Mod$mu2
> P2=Standard_Mod$P2
> L2Inv=Standard_Mod$L2Inv
> L3Inv=Standard_Mod$L3Inv
> 
> Env2=EnvelopeBuild(as.vector(bstar2), as.matrix(A),y, as.matrix(x2),
+ as.matrix(mu2,ncol=1),as.matrix(P2),as.vector(alpha),as.vector(wt2),
+ family="binomial",link="logit",Gridtype=as.integer(3), 
+ n=as.integer(n),sortgrid=TRUE)
Entering EnvelopeBuild_c: 2025-08-03 19:21:19
Entering Envelope Loop: 2025-08-03 19:21:19
Initiating NegLL Calculations: 2025-08-03 19:21:19
Initiating Gradient Calculations: 2025-08-03 19:21:19
> 
> ## These now seem to match
> 
> Env2
$GridIndex
  GIndex.Var1 GIndex.Var2
5           2           2
6           3           2
8           2           3
2           2           1
4           1           2
9           3           3
3           3           1
7           1           3
1           1           1

$thetabars
    G3.Var1    G3.Var2
5 0.5662049 0.11300265
6 0.6195287 0.11300265
8 0.5662049 0.17044504
2 0.5662049 0.05556027
4 0.5128810 0.11300265
9 0.6195287 0.17044504
3 0.6195287 0.05556027
7 0.5128810 0.17044504
1 0.5128810 0.05556027

$cbars
      cbars.1     cbars.2
5  -0.5661981  -0.1130015
6  34.4621159  -0.2437098
8  -1.4475523  34.1689246
2  -1.4796882 -35.3623598
4 -40.7542186  -0.2682291
9  33.3865305  32.4873204
3  33.8979746 -33.8580716
7 -41.3722300  35.7125259
1 -42.1074002 -37.3119403

$logU
       logU.1      logU.2
5   -3.850428   -3.776049
6 -618.902574   -3.784589
8   -4.238723 -593.065539
2   -4.267555 -626.754407
4 -813.223858   -3.788093
9 -581.745276 -536.732343
3 -599.269541 -574.773949
7 -838.283187 -647.262791
1 -868.590223 -697.486001

$logrt
       logrt.1      logrt.2
5   -0.6721049   -0.6704936
6 -618.9025745   -0.5738821
8   -0.2008155 -593.0655394
2   -0.1906419    0.0000000
4    0.0000000   -0.5569172
9 -581.7452759 -536.7323432
3 -599.2695410    0.0000000
7    0.0000000 -647.2627913
1    0.0000000    0.0000000

$loglt
       loglt.1      loglt.2
5   -0.6720943   -0.6704918
6    0.0000000   -0.7778690
8   -1.6277922    0.0000000
2   -1.6735097 -626.7544071
4 -813.2238580   -0.7992502
9    0.0000000    0.0000000
3    0.0000000 -574.7739490
7 -838.2831866    0.0000000
1 -868.5902230 -697.4860009

$LLconst
[1] 55.87862 35.14719 51.52363 59.36200 77.55426 31.17893 38.32546 72.77690
[9] 81.36520

$logP
[1]    -7.626477  -622.687163  -597.304262  -631.021962  -817.011951
[6] -1118.477619 -1174.043490 -1485.545978 -1566.076224

$PLSD
[1] 0.24960979 0.13063173 0.12594361 0.12363622 0.11925255 0.06975357 0.06737136
[8] 0.05788189 0.05591928

$a1
[1] 702.3746 605.1290

> 
> 
> 
> cleanEx()
> nameEx("EnvelopeSort")
> ### * EnvelopeSort
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: EnvelopeSort
> ### Title: Sorts Envelope function for simulation
> ### Aliases: EnvelopeSort
> ### Keywords: internal
> 
> ### ** Examples
> 
> data(menarche2)
> 
> summary(menarche2)
      Age            Total           Menarche      
 Min.   : 9.21   Min.   :  88.0   Min.   :   0.00  
 1st Qu.:11.58   1st Qu.:  98.0   1st Qu.:  10.00  
 Median :13.08   Median : 105.0   Median :  51.00  
 Mean   :13.10   Mean   : 156.7   Mean   :  92.32  
 3rd Qu.:14.58   3rd Qu.: 117.0   3rd Qu.:  92.00  
 Max.   :17.58   Max.   :1049.0   Max.   :1049.00  
> plot(Menarche/Total ~ Age, data=menarche2)
> 
> Age2=menarche2$Age-13
> 
> x<-matrix(as.numeric(1.0),nrow=length(Age2),ncol=2)
> x[,2]=Age2
> 
> y=menarche2$Menarche/menarche2$Total
> wt=menarche2$Total
> 
> mu<-matrix(as.numeric(0.0),nrow=2,ncol=1)
> mu[2,1]=(log(0.9/0.1)-log(0.5/0.5))/3
> 
> V1<-1*diag(as.numeric(2.0))
> 
> # 2 standard deviations for prior estimate at age 13 between 0.1 and 0.9
> ## Specifies uncertainty around the point estimates
> 
> V1[1,1]<-((log(0.9/0.1)-log(0.5/0.5))/2)^2 
> V1[2,2]=(3*mu[2,1]/2)^2  # Allows slope to be up to 1 times as large as point estimate 
> 
> famfunc<-glmbfamfunc(binomial(logit))
> 
> f1<-famfunc$f1
> f2<-famfunc$f2
> f3<-famfunc$f3
> f5<-famfunc$f5
> f6<-famfunc$f6
> 
> dispersion2<-as.numeric(1.0)
> start <- mu
> offset2=rep(as.numeric(0.0),length(y))
> P=solve(V1)
> n=1000
> 
> ## Appears that the type for some of these arguments are important/problematic
> 
> #outlist<-rnnorm_reg_cpp(n=as.integer(n),y=as.vector(y),x=as.matrix(x),
> #mu=as.vector(mu),P=as.matrix(P),offset2=as.vector(offset2),
> #wt=as.vector(wt),dispersion=as.numeric(dispersion2),famfunc=famfunc,
> #f1=f1,f2=f2,f3=f3,start=as.vector(start),family="binomial",
> #link="logit",Gridtype=as.integer(3))
> 
> ### This allows use of the rglmb summary function 
> ### add interface for glmbsim_NGauss_cpp later
> 
> #outlist$call<-match.call()
> #colnames(outlist$coefficients)<-colnames(x)
> #class(outlist)<-c(outlist$class,"rglmb")
> #summary(outlist)
> #Env1=outlist$Envelope
> 
> 
> ###### Adjust weight for dispersion
> 
> wt2=wt/dispersion2
> 
> ######################### Shift mean vector to offset so that adjusted model has 0 mean
> 
> alpha=x%*%as.vector(mu)+offset2
> mu2=0*as.vector(mu)
> P2=P
> x2=x
> 
> 
> #####  Optimization step to find posterior mode and associated Precision
> 
> parin=start-mu
> 
> opt_out=optim(parin,f2,f3,y=as.vector(y),x=as.matrix(x),mu=as.vector(mu2),
+               P=as.matrix(P),alpha=as.vector(alpha),wt=as.vector(wt2),
+               method="BFGS",hessian=TRUE
+ )
> 
> bstar=opt_out$par  ## Posterior mode for adjusted model
> bstar
            [,1]
[1,] -0.01069645
[2,]  0.89698197
> bstar+as.vector(mu)  # mode for actual model
            [,1]
[1,] -0.01069645
[2,]  1.62939016
> A1=opt_out$hessian # Approximate Precision at mode
> 
> ## Standardize Model
> 
> Standard_Mod=glmb_Standardize_Model(y=as.vector(y), x=as.matrix(x),
+ P=as.matrix(P),bstar=as.matrix(bstar,ncol=1), A1=as.matrix(A1))
> 
> bstar2=Standard_Mod$bstar2  
> A=Standard_Mod$A
> x2=Standard_Mod$x2
> mu2=Standard_Mod$mu2
> P2=Standard_Mod$P2
> L2Inv=Standard_Mod$L2Inv
> L3Inv=Standard_Mod$L3Inv
> 
> Env2=EnvelopeBuild(as.vector(bstar2), as.matrix(A),y, as.matrix(x2),
+ as.matrix(mu2,ncol=1),as.matrix(P2),as.vector(alpha),as.vector(wt2),
+ family="binomial",link="logit",Gridtype=as.integer(3), 
+ n=as.integer(n),sortgrid=TRUE)
Entering EnvelopeBuild_c: 2025-08-03 19:21:19
Entering Envelope Loop: 2025-08-03 19:21:19
Initiating NegLL Calculations: 2025-08-03 19:21:19
Initiating Gradient Calculations: 2025-08-03 19:21:19
> 
> ## These now seem to match
> 
> #Env1
> Env2
$GridIndex
  GIndex.Var1 GIndex.Var2
5           2           2
6           3           2
8           2           3
2           2           1
4           1           2
9           3           3
3           3           1
7           1           3
1           1           1

$thetabars
    G3.Var1    G3.Var2
5 0.5662049 0.11300265
6 0.6195287 0.11300265
8 0.5662049 0.17044504
2 0.5662049 0.05556027
4 0.5128810 0.11300265
9 0.6195287 0.17044504
3 0.6195287 0.05556027
7 0.5128810 0.17044504
1 0.5128810 0.05556027

$cbars
      cbars.1     cbars.2
5  -0.5661981  -0.1130015
6  34.4621159  -0.2437098
8  -1.4475523  34.1689246
2  -1.4796882 -35.3623598
4 -40.7542186  -0.2682291
9  33.3865305  32.4873204
3  33.8979746 -33.8580716
7 -41.3722300  35.7125259
1 -42.1074002 -37.3119403

$logU
       logU.1      logU.2
5   -3.850428   -3.776049
6 -618.902574   -3.784589
8   -4.238723 -593.065539
2   -4.267555 -626.754407
4 -813.223858   -3.788093
9 -581.745276 -536.732343
3 -599.269541 -574.773949
7 -838.283187 -647.262791
1 -868.590223 -697.486001

$logrt
       logrt.1      logrt.2
5   -0.6721049   -0.6704936
6 -618.9025745   -0.5738821
8   -0.2008155 -593.0655394
2   -0.1906419    0.0000000
4    0.0000000   -0.5569172
9 -581.7452759 -536.7323432
3 -599.2695410    0.0000000
7    0.0000000 -647.2627913
1    0.0000000    0.0000000

$loglt
       loglt.1      loglt.2
5   -0.6720943   -0.6704918
6    0.0000000   -0.7778690
8   -1.6277922    0.0000000
2   -1.6735097 -626.7544071
4 -813.2238580   -0.7992502
9    0.0000000    0.0000000
3    0.0000000 -574.7739490
7 -838.2831866    0.0000000
1 -868.5902230 -697.4860009

$LLconst
[1] 55.87862 35.14719 51.52363 59.36200 77.55426 31.17893 38.32546 72.77690
[9] 81.36520

$logP
[1]    -7.626477  -622.687163  -597.304262  -631.021962  -817.011951
[6] -1118.477619 -1174.043490 -1485.545978 -1566.076224

$PLSD
[1] 0.24960979 0.13063173 0.12594361 0.12363622 0.11925255 0.06975357 0.06737136
[8] 0.05788189 0.05591928

$a1
[1] 702.3746 605.1290

> 
> 
> 
> 
> 
> cleanEx()
> nameEx("Inv_f3_gaussian")
> ### * Inv_f3_gaussian
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: Inv_f3_gaussian
> ### Title: Derives the inverse of the gradient vector.
> ### Aliases: Inv_f3_gaussian
> 
> ### ** Examples
> 
> ## ----dobson-------------------------------------------------------------------
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> 
> ## Prior mean vector 
> mu<-matrix(0,5)           
> mu[1,1]=log(mean(counts)) 
> ## Prior standard deviation and Variance
> mysd<-1           
> V=((mysd)^2)*diag(5)  
> ## Call to glmb
> glmb.D93<-glmb(n=1000,counts ~ outcome + treatment,
+                family = poisson(),pfamily=dNormal(mu=mu,Sigma=V))
Entering EnvelopeBuild_c: 2025-08-03 19:21:19
Entering Envelope Loop: 2025-08-03 19:21:19
> ## ----glmb extractAIC-------------------------------------------------------------
> extractAIC(glmb.D93)
      pD      DIC 
 4.98011 56.78541 
> 
> 
> 
> cleanEx()
> nameEx("Neg_logLik")
> ### * Neg_logLik
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: Neg_logLik
> ### Title: Negative Log-Likelihood for a Generalized Linear Model
> ### Aliases: Neg_logLik Neg_logLik2
> ### Keywords: internal
> 
> ### ** Examples
> 
> 1+1
[1] 2
> 10+1
[1] 11
> 
> 
> 
> cleanEx()
> nameEx("Normal_ct")
> ### * Normal_ct
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: Normal_ct
> ### Title: The Central Normal Distribution
> ### Aliases: Normal_ct pnorm_ct rnorm_ct
> ### Keywords: internal
> 
> ### ** Examples
> 
> pnorm_ct(0.2,0.4)
[1] -2.574892
> exp(pnorm_ct(0.2,0.4))
[1] 0.07616203
> pnorm_ct(0.2,0.4,log.p=FALSE)
[1] 0.07616203
> log(pnorm_ct(0.2,0.4,log.p=FALSE))
[1] -2.574892
> ## Example where difference between two pnorm calls fail
> ## but call to pnorm_ct works
> pnorm(0.5)-pnorm(0.4999999999999999)
[1] 0
> pnorm_ct(0.4999999999999999,0.5,log.p=FALSE)
[1] 3.90871e-17
> 
> 
> 
> cleanEx()
> nameEx("Prior_Check")
> ### * Prior_Check
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: Prior_Check
> ### Title: Checks for Prior-data conflicts
> ### Aliases: Prior_Check
> 
> ### ** Examples
> 
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> print(d.AD <- data.frame(treatment, outcome, counts))
  treatment outcome counts
1         1       1     18
2         1       2     17
3         1       3     15
4         2       1     20
5         2       2     10
6         2       3     20
7         3       1     25
8         3       2     13
9         3       3     12
> ## Step 1: Set up Prior
> ps=Prior_Setup(counts ~ outcome + treatment)
[1] "Variable names are:"
[1] "(Intercept)" "outcome2"    "outcome3"    "treatment2"  "treatment3" 
> mu=ps$mu
> V=ps$Sigma
> # Step2A: Check the Prior
> Prior_Check(counts ~ outcome + treatment,family = poisson(),
+             pfamily=dNormal(mu=mu,Sigma=V))
[1] "Variables in the Model Are:"
[1] "(Intercept)" "outcome2"    "outcome3"    "treatment2"  "treatment3" 
[1] "At least one of the maximum likelihood estimates appears to be inconsistent with the prior"
               abs_ratio
(Intercept) 7.072923e+00
outcome2    2.297241e-01
outcome3    1.493395e-01
treatment2  6.168282e-16
treatment3  4.274795e-16
> # Step2B: Update and Re-Check the Prior
> mu[1,1]=log(mean(counts))
> Prior_Check(counts ~ outcome + treatment,family = poisson(),
+             pfamily=dNormal(mu=mu,Sigma=V))
[1] "Variables in the Model Are:"
[1] "(Intercept)" "outcome2"    "outcome3"    "treatment2"  "treatment3" 
[1] "The maximum likelihood estimates for all coefficients appear to be roughly consistent with the prior."
               abs_ratio
(Intercept) 1.199984e-01
outcome2    2.297241e-01
outcome3    1.493395e-01
treatment2  6.168282e-16
treatment3  4.274795e-16
> 
> 
> 
> cleanEx()
> nameEx("Prior_Setup")
> ### * Prior_Setup
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: Prior_Setup
> ### Title: Setup Prior Objects
> ### Aliases: Prior_Setup
> 
> ### ** Examples
> 
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> print(d.AD <- data.frame(treatment, outcome, counts))
  treatment outcome counts
1         1       1     18
2         1       2     17
3         1       3     15
4         2       1     20
5         2       2     10
6         2       3     20
7         3       1     25
8         3       2     13
9         3       3     12
> ## Step 1: Set up Prior
> ps=Prior_Setup(counts ~ outcome + treatment)
[1] "Variable names are:"
[1] "(Intercept)" "outcome2"    "outcome3"    "treatment2"  "treatment3" 
> mu=ps$mu
> V=ps$Sigma
> print(ps)
$mu
                  mu
(Intercept) 16.66667
outcome2     0.00000
outcome3     0.00000
treatment2   0.00000
treatment3   0.00000

$Sigma
            (Intercept) outcome2 outcome3 treatment2 treatment3
(Intercept)           1        0        0          0          0
outcome2              0        1        0          0          0
outcome3              0        0        1          0          0
treatment2            0        0        0          1          0
treatment3            0        0        0          0          1

$model
  counts outcome treatment
1     18       1         1
2     17       2         1
3     15       3         1
4     20       1         2
5     10       2         2
6     20       3         2
7     25       1         3
8     13       2         3
9     12       3         3

$x
  (Intercept) outcome2 outcome3 treatment2 treatment3
1           1        0        0          0          0
2           1        1        0          0          0
3           1        0        1          0          0
4           1        0        0          1          0
5           1        1        0          1          0
6           1        0        1          1          0
7           1        0        0          0          1
8           1        1        0          0          1
9           1        0        1          0          1
attr(,"assign")
[1] 0 1 1 2 2
attr(,"contrasts")
attr(,"contrasts")$outcome
[1] "contr.treatment"

attr(,"contrasts")$treatment
[1] "contr.treatment"


> 
> 
> 
> cleanEx()
> nameEx("Set_Grid")
> ### * Set_Grid
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: Set_Grid
> ### Title: Calculate Log-densities for Grid Components
> ### Aliases: Set_Grid
> ### Keywords: internal
> 
> ### ** Examples
> 
> ## ----dobson-------------------------------------------------------------------
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> 
> ## Prior mean vector 
> mu<-matrix(0,5)           
> mu[1,1]=log(mean(counts)) 
> ## Prior standard deviation and Variance
> mysd<-1           
> V=((mysd)^2)*diag(5)  
> ## Call to glmb
> glmb.D93<-glmb(n=1000,counts ~ outcome + treatment,
+                family = poisson(),pfamily=dNormal(mu=mu,Sigma=V))
Entering EnvelopeBuild_c: 2025-08-03 19:21:19
Entering Envelope Loop: 2025-08-03 19:21:19
> ## ----glmb extractAIC-------------------------------------------------------------
> extractAIC(glmb.D93)
       pD       DIC 
 4.834527 56.503684 
> 
> 
> 
> cleanEx()
> nameEx("anova.glmb")
> ### * anova.glmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: anova.glmb
> ### Title: Analysis of Deviance for Bayesian Generalized Linear Model Fits
> ### Aliases: anova.glmb
> 
> ### ** Examples
> 
> data(menarche2)
> ## ----Analysis Setup-----------------------------------------------------------
> ## Number of variables in model
> Age=menarche2$Age
> nvars=2
> ## Reference Ages for setting of priors and Age_Difference
> ref_age1=13  # user can modify this
> ref_age2=15  ## user can modify this
> ## Define variables used later in analysis
> Age2=menarche2$Age-ref_age1
> Age_Diff=ref_age2-ref_age1
> mu1=as.matrix(c(0,1.098612),ncol=1)
> V1<-1*diag(nvars)
> V1[1,1]=0.18687882
> V1[2,2]=0.10576217
> V1[1,2]=-0.03389182
> V1[2,1]=-0.03389182
> Menarche_Model_Data=data.frame(Age=menarche2$Age,Total=menarche2$Total,
+                                Menarche=menarche2$Menarche,Age2)
> glmb.out1<-glmb(n=1000,cbind(Menarche, Total-Menarche) ~Age2,family=binomial(logit),
+                 pfamily=dNormal(mu=mu1,Sigma=V1),data=Menarche_Model_Data)
Entering EnvelopeBuild_c: 2025-08-03 19:21:20
Entering Envelope Loop: 2025-08-03 19:21:20
Initiating NegLL Calculations: 2025-08-03 19:21:20
Initiating Gradient Calculations: 2025-08-03 19:21:20
Warning in eval(family$initialize) :
  non-integer #successes in a binomial glm!
> 
> # Prediction from original model
> pred1=predict(glmb.out1,type="response")
> 
> ## Get Original Residuals, their means, and credible bounds
> res_out=residuals(glmb.out1)
> colMeans(res_out)
         1          2          3          4          5          6          7 
-1.2742381 -2.0771455 -1.9050637 -0.8505821 -1.0360266 -0.2035286  0.1839116 
         8          9         10         11         12         13         14 
 0.7369305 -0.5730619  1.3511970  1.2009759  0.9342433 -1.0630999  0.1197622 
        15         16         17         18         19         20         21 
 1.3025799 -0.9885725 -1.1561353  1.1369948  0.6478868 -0.8141819 -0.4115774 
        22         23         24         25 
-0.8494593 -0.4329189 -0.6878146  1.1452959 
> 
> ## Set up to simulate new data and residuals
> res_mean=colMeans(res_out)
> res_low1=apply(res_out,2,FUN=quantile,probs=c(0.025))
> res_high1=apply(res_out,2,FUN=quantile,probs=c(0.975))
> 
> ## Simulate new data and get residuals for simulated data
> 
> ysim1=simulate(glmb.out1,nsim=1,seed=NULL,pred=pred1,family="binomial",
+                prior.weights=weights(glmb.out1))
> 
> 
> res_ysim_out1=residuals(glmb.out1,ysim=ysim1)
> res_low=apply(res_ysim_out1,2,FUN=quantile,probs=c(0.025))
> res_high=apply(res_ysim_out1,2,FUN=quantile,probs=c(0.975))
> 
> # Plot Credible Interval bounds for Deviance Residuals
> 
> plot(res_mean~Age,ylim=c(-2.5,2.5),
+ main="Credible Interval Bound for Menarche - Logit Model Deviance Residuals",
+ xlab = "Age", ylab = "Avg. Dev. Res")
> lines(Age, 0*res_mean,lty=1)
> lines(Age, res_low,lty=1)
> lines(Age, res_high,lty=1)
> lines(Age, res_low1,lty=2)
> lines(Age, res_high1,lty=2)
> 
> 
> 
> 
> cleanEx()
> nameEx("carinsca")
> ### * carinsca
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: carinsca
> ### Title: Canadian Automobile Insurance Claims for 1957-1958
> ### Aliases: carinsca
> ### Keywords: datasets, Bayesian Poisson Regression, Bayesian Gamma
> ###   Regression
> 
> ### ** Examples
> 
> data(carinsca)
> ## maybe str(carinsca) ; plot(carinsca) ...
> 
> 
> 
> cleanEx()
> nameEx("case.names.glmb")
> ### * case.names.glmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: case.names.glmb
> ### Title: Case and Variable Names of Fitted Models
> ### Aliases: case.names.glmb variable.names.glmb
> 
> ### ** Examples
> 
> ## ----dobson-------------------------------------------------------------------
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> 
> ## Prior mean vector 
> mu<-matrix(0,5)           
> mu[1,1]=log(mean(counts)) 
> ## Prior standard deviation and Variance
> mysd<-1           
> V=((mysd)^2)*diag(5)  
> ## Call to glmb
> glmb.D93<-glmb(n=1000,counts ~ outcome + treatment,
+                family = poisson(),pfamily=dNormal(mu=mu,Sigma=V))
Entering EnvelopeBuild_c: 2025-08-03 19:21:20
Entering Envelope Loop: 2025-08-03 19:21:20
> 
> ## ----glmb vcov----------------------------------------------------------------
> case.names(glmb.D93)
[1] "1" "2" "3" "4" "5" "6" "7" "8" "9"
> 
> 
> 
> 
> cleanEx()
> nameEx("confint.glmb")
> ### * confint.glmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: confint.glmb
> ### Title: Credible Intervals for Model Parameters
> ### Aliases: confint.glmb
> 
> ### ** Examples
> 
> 
> ## ----dobson-------------------------------------------------------------------
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> 
> ## Prior mean vector 
> mu<-matrix(0,5)           
> mu[1,1]=log(mean(counts)) 
> ## Prior standard deviation and Variance
> mysd<-1           
> V=((mysd)^2)*diag(5)  
> ## Call to glmb
> glmb.D93<-glmb(n=1000,counts ~ outcome + treatment,
+                family = poisson(),pfamily=dNormal(mu=mu,Sigma=V))
Entering EnvelopeBuild_c: 2025-08-03 19:21:20
Entering Envelope Loop: 2025-08-03 19:21:20
> ## ----glmb confint-------------------------------------------------------------
> confint(glmb.D93)
                  2.5%       97.5%
(Intercept)  2.6786970  3.33675042
outcome2    -0.8474068 -0.05212656
outcome3    -0.6556415  0.07824333
treatment2  -0.3762215  0.38039945
treatment3  -0.3547563  0.39655105
> 
> 
> 
> cleanEx()
> nameEx("deviance.rglmb")
> ### * deviance.rglmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: deviance.rglmb
> ### Title: Model Deviance
> ### Aliases: deviance.rglmb
> 
> ### ** Examples
> 
> ## ----dobson-------------------------------------------------------------------
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> 
> ## Prior mean vector 
> mu<-matrix(0,5)           
> mu[1,1]=log(mean(counts)) 
> ## Prior standard deviation and Variance
> mysd<-1           
> V=((mysd)^2)*diag(5)  
> ## Call to glmb
> glmb.D93<-glmb(n=1000,counts ~ outcome + treatment,
+                family = poisson(),pfamily=dNormal(mu=mu,Sigma=V))
Entering EnvelopeBuild_c: 2025-08-03 19:21:20
Entering Envelope Loop: 2025-08-03 19:21:20
> ## ----glmb extractAIC-------------------------------------------------------------
> extractAIC(glmb.D93)
       pD       DIC 
 4.856454 56.533471 
> 
> 
> 
> cleanEx()
> nameEx("dummy.coef.glmb")
> ### * dummy.coef.glmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: dummy.coef.glmb
> ### Title: Extract Coefficients in Original Coding
> ### Aliases: dummy.coef.glmb print.dummy_coef.glmb
> 
> ### ** Examples
> 
> set.seed(333)
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> mysd<-1
> mu<-matrix(0,5)
> mu[1]=log(mean(counts))
> V0<-((mysd)^2)*diag(5)
> glmb.D93<-glmb(n=1000,counts ~ outcome + treatment, 
+ family = poisson(),pfamily=dNormal(mu=mu,Sigma=V0))
Entering EnvelopeBuild_c: 2025-08-03 19:21:20
Entering Envelope Loop: 2025-08-03 19:21:20
> summary(glmb.D93)
Call
glmb(formula = counts ~ outcome + treatment, family = poisson(), 
    pfamily = dNormal(mu = mu, Sigma = V0), n = 1000)

Expected Deviance Residuals:
       1        2        3        4        5        6        7        8 
-0.56512  0.98226 -0.14326 -0.14820 -0.96859  1.04189  0.97173 -0.06236 
       9 
-0.93307 

Prior and Maximum Likelihood Estimates with Standard Deviations

                         Prior.sd  Max Like. Like.sd
(Intercept)  2.813e+00  1.000e+00  3.045e+00   0.171
outcome2     0.000e+00  1.000e+00 -4.543e-01   0.202
outcome3     0.000e+00  1.000e+00 -2.930e-01   0.193
treatment2   0.000e+00  1.000e+00  1.217e-15   0.200
treatment3   0.000e+00  1.000e+00  8.438e-16   0.200

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean   Post.Sd MC Error Pr(tail)  
(Intercept)  3.027191  3.015990  0.166169        0   0.1159  
outcome2    -0.428954 -0.436705  0.199134        0   0.0160 *
outcome3    -0.272569 -0.276592  0.192718        0   0.0739 .
treatment2   0.004042  0.008457  0.188418        0   0.4765  
treatment3   0.004042 -0.002867  0.195848        0   0.4915  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Distribution Percentiles

                 1.0%      2.5%      5.0%    Median     95.0%     97.5% 99.0%
(Intercept)  2.642934  2.692254  2.741456  3.022090  3.285405  3.325530 3.385
outcome2    -0.897249 -0.830710 -0.780706 -0.437691 -0.132681 -0.050630 0.040
outcome3    -0.714098 -0.636196 -0.605399 -0.273270  0.042306  0.075708 0.141
treatment2  -0.462866 -0.361432 -0.290362  0.012984  0.300794  0.375197 0.443
treatment3  -0.461068 -0.383640 -0.327180  0.003795  0.329267  0.385339 0.470

Effective Number of Parameters: 4.717731 
Expected Residual Deviance: 9.902958 
DIC: 56.25287 

Expected Mean dispersion: 1 
Sq.root of Expected Mean dispersion: 1 

Mean Likelihood Subgradient Candidates Per iid sample: 1.853 

> 
> 
> myd=dummy.coef(glmb.D93)
> print(myd)

Printing coefficients (first 5 records)
(Intercept) 
[1] 2.973352 2.913470 3.077731 3.119980 3.267128
outcome 
     1          2          3
[1,] 0 -0.4664635 -0.6260646
[2,] 0 -0.6275587  0.1058970
[3,] 0 -0.6127934 -0.3704300
[4,] 0 -0.6492993 -0.1194091
[5,] 0 -0.4728143 -0.3362339
treatment 
     1           2           3
[1,] 0  0.07993508  0.45011327
[2,] 0  0.12586741  0.02506838
[3,] 0  0.38657746  0.07266186
[4,] 0 -0.09192774  0.12169530
[5,] 0 -0.46957432 -0.18865323
coef.means: 
Full coefficients are 
                                                      
(Intercept):         3.01599                          
outcome:                   1            2            3
                   0.0000000   -0.4367047   -0.2765918
treatment:                 1            2            3
                 0.000000000  0.008457207 -0.002867353
coef.mode: 
Full coefficients are 
                                                   
(Intercept):       3.027191                        
outcome:                  1           2           3
                  0.0000000  -0.4289537  -0.2725692
treatment:                1           2           3
                0.000000000 0.004041969 0.004041974
> 
> 
> 
> cleanEx()
> nameEx("extractAIC.glmb")
> ### * extractAIC.glmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: extractAIC.glmb
> ### Title: Extract DIC from a Fitted Bayesian Model
> ### Aliases: extractAIC.glmb extractDIC
> 
> ### ** Examples
> 
> ## ----dobson-------------------------------------------------------------------
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> 
> ## Prior mean vector 
> mu<-matrix(0,5)           
> mu[1,1]=log(mean(counts)) 
> ## Prior standard deviation and Variance
> mysd<-1           
> V=((mysd)^2)*diag(5)  
> ## Call to glmb
> glmb.D93<-glmb(n=1000,counts ~ outcome + treatment,
+                family = poisson(),pfamily=dNormal(mu=mu,Sigma=V))
Entering EnvelopeBuild_c: 2025-08-03 19:21:20
Entering Envelope Loop: 2025-08-03 19:21:20
> ## ----glmb extractAIC-------------------------------------------------------------
> extractAIC(glmb.D93)
      pD      DIC 
 4.89682 56.61252 
> 
> 
> 
> cleanEx()
> nameEx("extractAIC.rglmb")
> ### * extractAIC.rglmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: extractAIC.rglmb
> ### Title: Extract DIC from a Fitted Bayesian Model
> ### Aliases: extractAIC.rglmb
> 
> ### ** Examples
> 
> ## ----dobson-------------------------------------------------------------------
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> 
> ## Prior mean vector 
> mu<-matrix(0,5)           
> mu[1,1]=log(mean(counts)) 
> ## Prior standard deviation and Variance
> mysd<-1           
> V=((mysd)^2)*diag(5)  
> ## Call to glmb
> glmb.D93<-glmb(n=1000,counts ~ outcome + treatment,
+                family = poisson(),pfamily=dNormal(mu=mu,Sigma=V))
Entering EnvelopeBuild_c: 2025-08-03 19:21:20
Entering Envelope Loop: 2025-08-03 19:21:20
> ## ----glmb extractAIC-------------------------------------------------------------
> extractAIC(glmb.D93)
       pD       DIC 
 4.769159 56.341879 
> 
> 
> 
> cleanEx()
> nameEx("f2_gaussian_vector")
> ### * f2_gaussian_vector
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: f2_gaussian_vector
> ### Title: Derives the inverse of the gradient vector.
> ### Aliases: f2_gaussian_vector
> 
> ### ** Examples
> 
> ## ----dobson-------------------------------------------------------------------
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> 
> ## Prior mean vector 
> mu<-matrix(0,5)           
> mu[1,1]=log(mean(counts)) 
> ## Prior standard deviation and Variance
> mysd<-1           
> V=((mysd)^2)*diag(5)  
> ## Call to glmb
> glmb.D93<-glmb(n=1000,counts ~ outcome + treatment,
+                family = poisson(),pfamily=dNormal(mu=mu,Sigma=V))
Entering EnvelopeBuild_c: 2025-08-03 19:21:20
Entering Envelope Loop: 2025-08-03 19:21:20
> ## ----glmb extractAIC-------------------------------------------------------------
> extractAIC(glmb.D93)
      pD      DIC 
 4.87241 56.56692 
> 
> 
> 
> cleanEx()
> nameEx("formula.summary.rglmb")
> ### * formula.summary.rglmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: formula.summary.rglmb
> ### Title: Extract Log-Likelihood
> ### Aliases: formula.summary.rglmb
> 
> ### ** Examples
> 
> ## ----dobson-------------------------------------------------------------------
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> 
> ## Prior mean vector 
> mu<-matrix(0,5)           
> mu[1,1]=log(mean(counts)) 
> ## Prior standard deviation and Variance
> mysd<-1           
> V=((mysd)^2)*diag(5)  
> ## Call to glmb
> glmb.D93<-glmb(n=1000,counts ~ outcome + treatment,
+                family = poisson(),pfamily=dNormal(mu=mu,Sigma=V))
Entering EnvelopeBuild_c: 2025-08-03 19:21:20
Entering Envelope Loop: 2025-08-03 19:21:20
> ## ----glmb logLik-------------------------------------------------------------
> colMeans(logLik(glmb.D93))
[1] -25.848
> 
> 
> 
> cleanEx()
> nameEx("glmb")
> ### * glmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: glmb
> ### Title: Fitting Bayesian Generalized Linear Models
> ### Aliases: glmb print.glmb
> 
> ### ** Examples
> 
> set.seed(333)
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> mysd<-1
> mu<-matrix(0,5)
> mu[1]=log(mean(counts))
> V0<-((mysd)^2)*diag(5)
> glmb.D93<-glmb(counts ~ outcome + treatment, family = poisson(),pfamily=dNormal(mu=mu,Sigma=V0))
Entering EnvelopeBuild_c: 2025-08-03 19:21:20
Entering Envelope Loop: 2025-08-03 19:21:20
> summary(glmb.D93)
Call
glmb(formula = counts ~ outcome + treatment, family = poisson(), 
    pfamily = dNormal(mu = mu, Sigma = V0))

Expected Deviance Residuals:
       1        2        3        4        5        6        7        8 
-0.51405  0.96423 -0.12759 -0.09567 -0.98628  1.06193  0.98743 -0.11404 
       9 
-0.94777 

Prior and Maximum Likelihood Estimates with Standard Deviations

                         Prior.sd  Max Like. Like.sd
(Intercept)  2.813e+00  1.000e+00  3.045e+00   0.171
outcome2     0.000e+00  1.000e+00 -4.543e-01   0.202
outcome3     0.000e+00  1.000e+00 -2.930e-01   0.193
treatment2   0.000e+00  1.000e+00  1.217e-15   0.200
treatment3   0.000e+00  1.000e+00  8.438e-16   0.200

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean   Post.Sd MC Error Pr(tail)  
(Intercept)  3.027191  3.004298  0.169057        0   0.1239  
outcome2    -0.428954 -0.420043  0.200697        0   0.0160 *
outcome3    -0.272569 -0.269373  0.187561        0   0.0859 .
treatment2   0.004042  0.008183  0.201160        0   0.4975  
treatment3   0.004042  0.005918  0.193540        0   0.4875  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Distribution Percentiles

                  1.0%       2.5%       5.0%     Median      95.0%      97.5%
(Intercept)  2.6039954  2.6722954  2.7216210  3.0068640  3.2687290  3.3252889
outcome2    -0.9052089 -0.8143116 -0.7456582 -0.4177417 -0.0916327 -0.0254476
outcome3    -0.6981394 -0.6160156 -0.5647051 -0.2779524  0.0455166  0.0953591
treatment2  -0.4929303 -0.3838895 -0.3202432  0.0006314  0.3504243  0.4121178
treatment3  -0.4239416 -0.3632733 -0.3186206  0.0076599  0.3131663  0.3811060
            99.0%
(Intercept) 3.381
outcome2    0.031
outcome3    0.174
treatment2  0.464
treatment3  0.441

Effective Number of Parameters: 4.758765 
Expected Residual Deviance: 9.974935 
DIC: 56.36588 

Expected Mean dispersion: 1 
Sq.root of Expected Mean dispersion: 1 

Mean Likelihood Subgradient Candidates Per iid sample: 1.811 

> 
> # Menarche Binomial Data Example 
> data(menarche2)
> Age2=menarche2$Age-13
> 
> #Priors Are Derived in Vignette
> nvars=2
> ## Logit Prior and Model
> mu1=as.matrix(c(0,1.098612),ncol=1)
> V1<-1*diag(nvars)
> V1[1,1]=0.18687882
> V1[2,2]=0.10576217
> V1[1,2]=-0.03389182
> V1[2,1]=-0.03389182
> glmb.out1<-glmb(cbind(Menarche, Total-Menarche) ~ Age2,
+ family=binomial(logit),pfamily=dNormal(mu=mu1,Sigma=V1), data=menarche2)
Entering EnvelopeBuild_c: 2025-08-03 19:21:20
Entering Envelope Loop: 2025-08-03 19:21:20
Initiating NegLL Calculations: 2025-08-03 19:21:20
Initiating Gradient Calculations: 2025-08-03 19:21:20
Warning in eval(family$initialize) :
  non-integer #successes in a binomial glm!
> summary(glmb.out1)
Call
glmb(formula = cbind(Menarche, Total - Menarche) ~ Age2, family = binomial(logit), 
    pfamily = dNormal(mu = mu1, Sigma = V1), data = menarche2)

Expected Deviance Residuals:
      1       2       3       4       5       6       7       8       9      10 
-1.2758 -2.0796 -1.9073 -0.8545 -1.0400 -0.2086  0.1773  0.7290 -0.5812  1.3421 
     11      12      13      14      15      16      17      18      19      20 
 1.1910  0.9236 -1.0732  0.1098  1.2936 -0.9973 -1.1631  1.1316  0.6428 -0.8184 
     21      22      23      24      25 
-0.4153 -0.8524 -0.4351 -0.6898  1.1444 

Prior and Maximum Likelihood Estimates with Standard Deviations

                     Prior.sd Max Like. Like.sd
(Intercept)  0.00000  0.43229  -0.01081   0.063
Age2         1.09861  0.32521   1.63197   0.059

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean  Post.Sd MC Error Pr(tail)    
(Intercept)  -0.01369  -0.01469  0.06206        0 0.408591    
Age2          1.61438   1.61791  0.05533        0 0.000999 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Distribution Percentiles

                1.0%     2.5%     5.0%   Median    95.0%    97.5% 99.0%
(Intercept) -0.14835 -0.13433 -0.11977 -0.01277  0.08812  0.10833 0.125
Age2         1.49231  1.51098  1.52884  1.61750  1.70858  1.72326 1.747

Effective Number of Parameters: 1.878222 
Expected Residual Deviance: 28.6437 
DIC: 114.5737 

Expected Mean dispersion: 1 
Sq.root of Expected Mean dispersion: 1 

Mean Likelihood Subgradient Candidates Per iid sample: 1.246 

> 
> ## Probit Prior and Model
> mu2=as.matrix(c(0,0.6407758),ncol=1)
> V2<-1*diag(nvars)
> V2[1,1]=0.07158369
> V2[2,2]=0.03453205
> V2[1,2]=-0.01512075
> V2[2,1]=-0.01512075
> glmb.out2<-glmb(cbind(Menarche, Total-Menarche) ~ Age2,
+ family=binomial(probit),pfamily=dNormal(mu=mu2,Sigma=V2), data=menarche2)
Entering EnvelopeBuild_c: 2025-08-03 19:21:20
Entering Envelope Loop: 2025-08-03 19:21:20
Warning in eval(family$initialize) :
  non-integer #successes in a binomial glm!
> summary(glmb.out2)
Call
glmb(formula = cbind(Menarche, Total - Menarche) ~ Age2, family = binomial(probit), 
    pfamily = dNormal(mu = mu2, Sigma = V2), data = menarche2)

Expected Deviance Residuals:
       1        2        3        4        5        6        7        8 
-0.47761 -1.50682 -1.61316 -0.55880 -0.93526 -0.26130 -0.04969  0.36078 
       9       10       11       12       13       14       15       16 
-0.97083  0.98065  0.93974  0.86058 -0.91434  0.48371  1.80334 -0.37175 
      17       18       19       20       21       22       23       24 
-0.61513  1.52898  0.91978 -0.74305 -0.55423 -1.19310 -0.89229 -1.34772 
      25 
 0.21096 

Prior and Maximum Likelihood Estimates with Standard Deviations

                     Prior.sd Max Like. Like.sd
(Intercept)  0.00000  0.26755  -0.01724   0.035
Age2         0.64078  0.18583   0.90782   0.030

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean  Post.Sd MC Error Pr(tail)    
(Intercept)  -0.01863  -0.02030  0.03285        0 0.278721    
Age2          0.90071   0.90199  0.02824        0 0.000999 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Distribution Percentiles

                1.0%     2.5%     5.0%   Median    95.0%    97.5% 99.0%
(Intercept) -0.09945 -0.08568 -0.07212 -0.02108  0.03325  0.04215 0.054
Age2         0.83463  0.84804  0.85819  0.90262  0.94863  0.95627 0.966

Effective Number of Parameters: 1.812227 
Expected Residual Deviance: 24.74851 
DIC: 110.6125 

Expected Mean dispersion: 1 
Sq.root of Expected Mean dispersion: 1 

Mean Likelihood Subgradient Candidates Per iid sample: 1.256 

> 
> ## clog-log Prior and Model
> mu2=as.matrix(c(-0.3665129,0.6002727),ncol=1)
> V2<-1*diag(nvars)
> V2[1,1]=0.11491322
> V2[2,2]=0.03365986
> V2[1,2]=-0.03502783
> V2[2,1]=-0.03502783
> glmb.out3<-glmb(cbind(Menarche, Total-Menarche) ~ Age2,
+                 family=binomial(cloglog),pfamily=dNormal(mu=mu2,Sigma=V2), data=menarche2)
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Entering EnvelopeBuild_c: 2025-08-03 19:21:20
Entering Envelope Loop: 2025-08-03 19:21:20
Warning in eval(family$initialize) :
  non-integer #successes in a binomial glm!
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
> summary(glmb.out3)
Call
glmb(formula = cbind(Menarche, Total - Menarche) ~ Age2, family = binomial(cloglog), 
    pfamily = dNormal(mu = mu2, Sigma = V2), data = menarche2)

Expected Deviance Residuals:
         1          2          3          4          5          6          7 
-3.414e+00 -3.989e+00 -3.239e+00 -2.683e+00 -2.552e+00 -1.687e+00 -1.244e+00 
         8          9         10         11         12         13         14 
-4.098e-01 -1.200e+00  1.238e+00  1.678e+00  2.042e+00  5.062e-01  2.116e+00 
        15         16         17         18         19         20         21 
 3.400e+00  1.199e+00  5.288e-01  2.180e+00  1.120e+00 -1.106e+00 -1.511e+00 
        22         23         24         25 
-2.640e+00 -2.503e+00 -3.461e+00  8.550e-07 

Prior and Maximum Likelihood Estimates with Standard Deviations

                    Prior.sd Max Like. Like.sd
(Intercept) -0.3665   0.3390   -0.5960   0.041
Age2         0.6003   0.1835    0.9530   0.031

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean  Post.Sd MC Error Pr(tail)    
(Intercept)  -0.59224  -0.59208  0.04284        0  < 2e-16 ***
Age2          0.94419   0.94457  0.03023        0 0.000999 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Distribution Percentiles

               1.0%    2.5%    5.0%  Median   95.0%   97.5%  99.0%
(Intercept) -0.6976 -0.6777 -0.6627 -0.5937 -0.5213 -0.5088 -0.495
Age2         0.8818  0.8899  0.8967  0.9425  0.9951  1.0053  1.021

Effective Number of Parameters: 2.131576 
Expected Residual Deviance: 121.0421 
DIC: 207.2255 

Expected Mean dispersion: 1 
Sq.root of Expected Mean dispersion: 1 

Mean Likelihood Subgradient Candidates Per iid sample: 1.256 

> 
> DIC_Out=rbind(extractAIC(glmb.out1),extractAIC(glmb.out2),extractAIC(glmb.out3))
> rownames(DIC_Out)=c("logit","probit","clog-log")
> colnames(DIC_Out)=c("pD","DIC")
> DIC_Out
               pD      DIC
logit    1.878222 114.5737
probit   1.812227 110.6125
clog-log 2.131576 207.2255
> 
> 
> 
> cleanEx()
> nameEx("glmb.influence.measures")
> ### * glmb.influence.measures
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: glmb.influence.measures
> ### Title: Bayesian Regression Diagnostics
> ### Aliases: glmb.influence.measures rstandard.glmb rstudent.glmb
> ###   glmb.dffits dfbetas.glmb glmb.covratio cooks.distance.glmb
> 
> ### ** Examples
> 
> set.seed(333)
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> mysd<-1
> mu<-matrix(0,5)
> mu[1]=log(mean(counts))
> V0<-((mysd)^2)*diag(5)
> glmb.D93<-glmb(counts ~ outcome + treatment, family = poisson(),pfamily=dNormal(mu=mu,Sigma=V0))
Entering EnvelopeBuild_c: 2025-08-03 19:21:21
Entering Envelope Loop: 2025-08-03 19:21:21
> 
> ## Start setup here [First output from earlier optim optimization]
> betastar=glmb.D93$coef.mode  # Posterior mode from optim
> x=glmb.D93$x
> y=glmb.D93$y
> #offset=glmb.D93$offset   # not present in the output --> For now set to 0 vector
> offset2=0*y   # Should return this from lower level functions
> weights2=glmb.D93$prior.weights
> 
> ## Check influence measures for original model
> fit=glmb.wfit(x,y,weights2,offset2,family=poisson(),Bbar=mu,P=solve(V0),betastar)
> influence.measures(fit)
Influence measures of
	 NULL :

      dfb.1_  dfb.otc2  dfb.otc3  dfb.trt2  dfb.trt3     dffit cov.r   cook.d
1  -1.318724  5.99e-01  6.28e-01  0.753402  0.753402 -1.318724 1.933 3.36e-01
2   0.795705  1.27e+00 -9.70e-03 -1.001576 -1.001576  1.993449 0.449 5.91e-01
3  -0.138294  1.14e-03 -1.99e-01  0.174801  0.174801 -0.331235 3.540 2.44e-02
4  -0.117060  1.64e-01  1.72e-01 -0.213707  0.002200 -0.361356 4.154 2.91e-02
5   0.358257 -1.24e+00  2.50e-02 -1.014497  0.025485 -1.985656 0.486 5.94e-01
6  -0.508208 -2.98e-02  1.56e+00  1.426174 -0.035901  2.659421 0.214 8.93e-01
7   0.883999 -1.24e+00 -1.30e+00 -0.016613  1.613845  2.728848 0.363 1.02e+00
8   0.041628 -1.44e-01  2.91e-03  0.002961 -0.117879 -0.230723 3.487 1.19e-02
9   0.423238  2.48e-02 -1.30e+00  0.029899 -1.187724 -2.214776 0.440 7.16e-01
10 -0.044212  2.01e-02  2.11e-02  0.025259  0.025259 -0.044212 1.775 4.36e-04
11 -0.049053  1.08e-01  4.28e-02 -0.000792 -0.000792  0.108065 1.570 2.54e-03
12 -0.030840  2.57e-02  6.47e-02 -0.000498 -0.000498  0.064742 1.741 9.30e-04
13  0.000564  7.23e-06  7.59e-06 -0.000987 -0.000475 -0.000987 1.873 2.19e-07
14  0.000564  7.23e-06  7.59e-06 -0.000475 -0.000987 -0.000987 1.873 2.19e-07
      hat inf
1  0.5673   *
2  0.4923   *
3  0.5218   *
4  0.5900   *
5  0.5000   *
6  0.5306   *
7  0.5900   *
8  0.5000   *
9  0.5306   *
10 0.0275    
11 0.0388    
12 0.0355    
13 0.0378    
14 0.0378    
> 
> print(fit)

Call:
NULL

Coefficients:
(Intercept)     outcome2     outcome3   treatment2   treatment3  
   3.027191    -0.428953    -0.272569     0.004042     0.004042  

> print(glmb.D93$coef.mode)
[1]  3.027191119 -0.428953693 -0.272569221  0.004041969  0.004041974
> 
> ### Now try a strong prior with poorly chosen intercept
> mu1=0*mu
> V1=0.1*V0
> glmb2.D93<-glmb(counts ~ outcome + treatment, family = poisson(),pfamily=dNormal(mu=mu1,Sigma=V1))
Entering EnvelopeBuild_c: 2025-08-03 19:21:21
Entering Envelope Loop: 2025-08-03 19:21:21
> 
> Bbar2=mu1  # Prior mean
> betastar2=glmb2.D93$coef.mode  # Posterior mode from optim
> fit2=glmb.wfit(x,y,weights2,offset2,family=poisson(),Bbar2,P=solve(V1),betastar2)
> 
> influence.measures(fit2)
Influence measures of
	 NULL :

     dfb.1_ dfb.otc2 dfb.otc3  dfb.trt2  dfb.trt3    dffit    cov.r   cook.d
1   0.48766 -0.20271 -0.21342 -0.240330 -0.240332  0.48766 1.54e+00 4.90e-02
2   0.25187  0.34436 -0.02125 -0.268551 -0.268553  0.55427 1.83e+00 6.40e-02
3   0.11359 -0.00723  0.14755 -0.124322 -0.124323  0.24705 2.57e+00 1.35e-02
4   0.18233 -0.19873 -0.20922  0.259999 -0.019529  0.44148 2.50e+00 4.23e-02
5   0.01203 -0.28107  0.05047 -0.243283  0.050505 -0.50068 2.78e+00 5.44e-02
6  -0.01170 -0.02982  0.17499  0.164955 -0.034869  0.32841 3.28e+00 2.39e-02
7   0.38365 -0.41815 -0.44024 -0.041091  0.547077  0.92895 1.41e+00 1.67e-01
8   0.00442 -0.10329  0.01855  0.018560 -0.089404 -0.18399 3.25e+00 7.58e-03
9   0.01849  0.04714 -0.27655  0.055108 -0.260697 -0.51903 2.95e+00 5.85e-02
10 -4.69067  1.94983  2.05283  2.311656  2.311671 -4.69067 2.11e-05 4.85e-01
11 -0.00315  0.00758  0.00262 -0.000464 -0.000464  0.00758 2.56e+00 1.29e-05
12  0.03962 -0.03131 -0.09053  0.005832  0.005832 -0.09053 2.48e+00 1.84e-03
13  0.12891  0.01601  0.01685 -0.261580 -0.103342 -0.26158 2.30e+00 1.51e-02
14  0.12891  0.01601  0.01685 -0.103342 -0.261578 -0.26158 2.30e+00 1.51e-02
     hat inf
1  0.244    
2  0.326    
3  0.347    
4  0.398    
5  0.459   *
6  0.487   *
7  0.398    
8  0.459   *
9  0.487   *
10 0.230   *
11 0.297    
12 0.282    
13 0.292    
14 0.292    
> 
> print(fit2)

Call:
NULL

Coefficients:
(Intercept)     outcome2     outcome3   treatment2   treatment3  
   2.363486    -0.009802     0.122589     0.340056     0.340056  

> print(glmb2.D93$coef.mode)
[1]  2.363485555 -0.009797081  0.122587885  0.340049094  0.340066361
> 
> 
> 
> influence(glmb2.D93)
$hat
 [1] 0.2444410 0.3261137 0.3472719 0.3981078 0.4590068 0.4873046 0.3981108
 [8] 0.4590107 0.4873085 0.2299986 0.2972437 0.2819494 0.2920672 0.2920654

$coefficients
       (Intercept)     outcome2     outcome3    treatment2   treatment3
 [1,]  0.224411797 -0.106047652 -0.108739010 -0.1246270805 -0.124627461
 [2,]  0.116574001  0.181193322 -0.010889800 -0.1400676089 -0.140068036
 [3,]  0.054232896 -0.003922223  0.077998224 -0.0668881167 -0.066888321
 [4,]  0.086102519 -0.106686056 -0.109393616  0.1383594288 -0.010392459
 [5,]  0.005679600 -0.150887167  0.026385000 -0.1294578825  0.026875121
 [6,] -0.005584718 -0.016189238  0.092508268  0.0887561061 -0.018761790
 [7,]  0.171058886 -0.211952863 -0.217331965 -0.0206460063  0.274874462
 [8,]  0.002120262 -0.056324513  0.009849251  0.0100320421 -0.048324469
 [9,]  0.008735668  0.025322331 -0.144696084  0.0293456930 -0.138825075
[10,] -0.705971062  0.333612468  0.342079140  0.3920609940  0.392062190
[11,] -0.001516008  0.004146042  0.001396417 -0.0002514792 -0.000251480
[12,]  0.019026658 -0.017091950 -0.048135857  0.0031561892  0.003156199
[13,]  0.061355020  0.008660426  0.008880217 -0.1402945633 -0.055425896
[14,]  0.061355050  0.008660430  0.008880221 -0.0554257549 -0.140293337

$sigma
 [1] 3.0343276 3.0518910 3.1481778 3.1138402 3.1136942 3.1484196 2.9399904
 [8] 3.1627920 3.1159546 0.9924051 3.1706425 3.1665412 3.1383056 3.1383057

$wt.res
 [1]  2.26133260  1.99614294  0.86147034  1.31137191 -1.24484255  0.75939034
 [7]  2.60526193 -0.46467873 -1.18777571 -7.47400044  0.03099743 -0.38766144
[13] -1.07535074 -1.07535074

> influence(glmb2.D93,do.coef=TRUE)
$hat
 [1] 0.2444410 0.3261137 0.3472719 0.3981078 0.4590068 0.4873046 0.3981108
 [8] 0.4590107 0.4873085 0.2299986 0.2972437 0.2819494 0.2920672 0.2920654

$coefficients
       (Intercept)     outcome2     outcome3    treatment2   treatment3
 [1,]  0.224411797 -0.106047652 -0.108739010 -0.1246270805 -0.124627461
 [2,]  0.116574001  0.181193322 -0.010889800 -0.1400676089 -0.140068036
 [3,]  0.054232896 -0.003922223  0.077998224 -0.0668881167 -0.066888321
 [4,]  0.086102519 -0.106686056 -0.109393616  0.1383594288 -0.010392459
 [5,]  0.005679600 -0.150887167  0.026385000 -0.1294578825  0.026875121
 [6,] -0.005584718 -0.016189238  0.092508268  0.0887561061 -0.018761790
 [7,]  0.171058886 -0.211952863 -0.217331965 -0.0206460063  0.274874462
 [8,]  0.002120262 -0.056324513  0.009849251  0.0100320421 -0.048324469
 [9,]  0.008735668  0.025322331 -0.144696084  0.0293456930 -0.138825075
[10,] -0.705971062  0.333612468  0.342079140  0.3920609940  0.392062190
[11,] -0.001516008  0.004146042  0.001396417 -0.0002514792 -0.000251480
[12,]  0.019026658 -0.017091950 -0.048135857  0.0031561892  0.003156199
[13,]  0.061355020  0.008660426  0.008880217 -0.1402945633 -0.055425896
[14,]  0.061355050  0.008660430  0.008880221 -0.0554257549 -0.140293337

$sigma
 [1] 3.0343276 3.0518910 3.1481778 3.1138402 3.1136942 3.1484196 2.9399904
 [8] 3.1627920 3.1159546 0.9924051 3.1706425 3.1665412 3.1383056 3.1383057

$wt.res
 [1]  2.26133260  1.99614294  0.86147034  1.31137191 -1.24484255  0.75939034
 [7]  2.60526193 -0.46467873 -1.18777571 -7.47400044  0.03099743 -0.38766144
[13] -1.07535074 -1.07535074

> influence(glmb2.D93,do.coef=FALSE)
$hat
 [1] 0.2444410 0.3261137 0.3472719 0.3981078 0.4590068 0.4873046 0.3981108
 [8] 0.4590107 0.4873085 0.2299986 0.2972437 0.2819494 0.2920672 0.2920654

$<NA>
NULL

$sigma
 [1] 3.0343276 3.0518910 3.1481778 3.1138402 3.1136942 3.1484196 2.9399904
 [8] 3.1627920 3.1159546 0.9924051 3.1706425 3.1665412 3.1383056 3.1383057

$wt.res
 [1]  2.26133260  1.99614294  0.86147034  1.31137191 -1.24484255  0.75939034
 [7]  2.60526193 -0.46467873 -1.18777571 -7.47400044  0.03099743 -0.38766144
[13] -1.07535074 -1.07535074

> 
> #glmb2.D93$qr=glmb2.D93$fit$qr
> #influence.measures(glmb2.D93,influence(glmb2.D93))
> #influence.measures(glmb2.D93$fit,influence(glmb2.D93))
> #influence.measures(glmb2.D93$fit,influence(glmb2.D93,do.coef=FALSE))
> glmb.influence.measures(glmb2.D93,influence(glmb2.D93))
Influence measures of
	 NULL :

     dfb.1_ dfb.otc2 dfb.otc3  dfb.trt2  dfb.trt3    dffit    cov.r   cook.d
1   0.48766 -0.20271 -0.21342 -0.240330 -0.240332  0.48766 1.54e+00 4.90e-02
2   0.25187  0.34436 -0.02125 -0.268551 -0.268553  0.55427 1.83e+00 6.40e-02
3   0.11359 -0.00723  0.14755 -0.124322 -0.124323  0.24705 2.57e+00 1.35e-02
4   0.18233 -0.19873 -0.20922  0.259999 -0.019529  0.44148 2.50e+00 4.23e-02
5   0.01203 -0.28107  0.05047 -0.243283  0.050505 -0.50068 2.78e+00 5.44e-02
6  -0.01170 -0.02982  0.17499  0.164955 -0.034869  0.32841 3.28e+00 2.39e-02
7   0.38365 -0.41815 -0.44024 -0.041091  0.547077  0.92895 1.41e+00 1.67e-01
8   0.00442 -0.10329  0.01855  0.018560 -0.089404 -0.18399 3.25e+00 7.58e-03
9   0.01849  0.04714 -0.27655  0.055108 -0.260697 -0.51903 2.95e+00 5.85e-02
10 -4.69067  1.94983  2.05283  2.311656  2.311671 -4.69067 2.11e-05 4.85e-01
11 -0.00315  0.00758  0.00262 -0.000464 -0.000464  0.00758 2.56e+00 1.29e-05
12  0.03962 -0.03131 -0.09053  0.005832  0.005832 -0.09053 2.48e+00 1.84e-03
13  0.12891  0.01601  0.01685 -0.261580 -0.103342 -0.26158 2.30e+00 1.51e-02
14  0.12891  0.01601  0.01685 -0.103342 -0.261578 -0.26158 2.30e+00 1.51e-02
     hat inf
1  0.244    
2  0.326    
3  0.347    
4  0.398    
5  0.459   *
6  0.487   *
7  0.398    
8  0.459   *
9  0.487   *
10 0.230   *
11 0.297    
12 0.282    
13 0.292    
14 0.292    
> 
> 
> ## Do not need method functions
> dfbeta(glmb2.D93,influence(glmb2.D93))
       (Intercept)     outcome2     outcome3    treatment2   treatment3
 [1,]  0.224411797 -0.106047652 -0.108739010 -0.1246270805 -0.124627461
 [2,]  0.116574001  0.181193322 -0.010889800 -0.1400676089 -0.140068036
 [3,]  0.054232896 -0.003922223  0.077998224 -0.0668881167 -0.066888321
 [4,]  0.086102519 -0.106686056 -0.109393616  0.1383594288 -0.010392459
 [5,]  0.005679600 -0.150887167  0.026385000 -0.1294578825  0.026875121
 [6,] -0.005584718 -0.016189238  0.092508268  0.0887561061 -0.018761790
 [7,]  0.171058886 -0.211952863 -0.217331965 -0.0206460063  0.274874462
 [8,]  0.002120262 -0.056324513  0.009849251  0.0100320421 -0.048324469
 [9,]  0.008735668  0.025322331 -0.144696084  0.0293456930 -0.138825075
[10,] -0.705971062  0.333612468  0.342079140  0.3920609940  0.392062190
[11,] -0.001516008  0.004146042  0.001396417 -0.0002514792 -0.000251480
[12,]  0.019026658 -0.017091950 -0.048135857  0.0031561892  0.003156199
[13,]  0.061355020  0.008660426  0.008880217 -0.1402945633 -0.055425896
[14,]  0.061355050  0.008660430  0.008880221 -0.0554257549 -0.140293337
> dfbeta(glmb2.D93$fit,influence(glmb2.D93))
       (Intercept)     outcome2     outcome3    treatment2   treatment3
 [1,]  0.224411797 -0.106047652 -0.108739010 -0.1246270805 -0.124627461
 [2,]  0.116574001  0.181193322 -0.010889800 -0.1400676089 -0.140068036
 [3,]  0.054232896 -0.003922223  0.077998224 -0.0668881167 -0.066888321
 [4,]  0.086102519 -0.106686056 -0.109393616  0.1383594288 -0.010392459
 [5,]  0.005679600 -0.150887167  0.026385000 -0.1294578825  0.026875121
 [6,] -0.005584718 -0.016189238  0.092508268  0.0887561061 -0.018761790
 [7,]  0.171058886 -0.211952863 -0.217331965 -0.0206460063  0.274874462
 [8,]  0.002120262 -0.056324513  0.009849251  0.0100320421 -0.048324469
 [9,]  0.008735668  0.025322331 -0.144696084  0.0293456930 -0.138825075
[10,] -0.705971062  0.333612468  0.342079140  0.3920609940  0.392062190
[11,] -0.001516008  0.004146042  0.001396417 -0.0002514792 -0.000251480
[12,]  0.019026658 -0.017091950 -0.048135857  0.0031561892  0.003156199
[13,]  0.061355020  0.008660426  0.008880217 -0.1402945633 -0.055425896
[14,]  0.061355050  0.008660430  0.008880221 -0.0554257549 -0.140293337
> hatvalues(glmb2.D93,influence(glmb2.D93))
 [1] 0.2444410 0.3261137 0.3472719 0.3981078 0.4590068 0.4873046 0.3981108
 [8] 0.4590107 0.4873085 0.2299986 0.2972437 0.2819494 0.2920672 0.2920654
> hatvalues(glmb2.D93$fit,influence(glmb2.D93))
 [1] 0.2444410 0.3261137 0.3472719 0.3981078 0.4590068 0.4873046 0.3981108
 [8] 0.4590107 0.4873085 0.2299986 0.2972437 0.2819494 0.2920672 0.2920654
> 
> # Methods (implmented)
> 
> rstandard(glmb2.D93,infl=influence(glmb2.D93))
 [1]  0.8702731  0.8134364  0.3566970  0.5654469 -0.5661660  0.3547813
 [7]  1.1233586 -0.2113410 -0.5549216 -2.8492639  0.0123694 -0.1530384
[13] -0.4275426 -0.4275421
> rstandard(glmb2.D93)
 [1]  0.8702731  0.8134364  0.3566970  0.5654469 -0.5661660  0.3547813
 [7]  1.1233586 -0.2113410 -0.5549216 -2.8492639  0.0123694 -0.1530384
[13] -0.4275426 -0.4275421
> 
> 
> # Need Metods
> 
> ## Needs a method function
> #dfbetas(glmb2.D93,influence(glmb2.D93))
> dfbetas(glmb2.D93)
       (Intercept)     outcome2     outcome3    treatment2    treatment3
 [1,]  0.487663863 -0.202713301 -0.213421085 -0.2403303236 -0.2403318006
 [2,]  0.251866292  0.344363277 -0.021250312 -0.2685513379 -0.2685529883
 [3,]  0.113590211 -0.007226311  0.147550227 -0.1243221005 -0.1243228645
 [4,]  0.182329482 -0.198726141 -0.209223314  0.2599986322 -0.0195290885
 [5,]  0.012027606 -0.281073566  0.050465613 -0.2432826631  0.0505050064
 [6,] -0.011696234 -0.029824794  0.174985621  0.1649545337 -0.0348691713
 [7,]  0.383651673 -0.418154757 -0.440242655 -0.0410911950  0.5470769954
 [8,]  0.004420345 -0.103292902  0.018545861  0.0185599731 -0.0894038938
 [9,]  0.018485975  0.047136380 -0.276554087  0.0551076484 -0.2606974420
[10,] -4.690674224  1.949830875  2.052825436  2.3116563291  2.3116705356
[11,] -0.003152766  0.007584554  0.002622903 -0.0004641021 -0.0004641049
[12,]  0.039620024 -0.031307625 -0.090531139  0.0058322551  0.0058322910
[13,]  0.128911668  0.016006179  0.016851663 -0.2615798167 -0.1033421421
[14,]  0.128911729  0.016006187  0.016851671 -0.1033415557 -0.2615783324
> dfbetas(glmb2.D93,influence(glmb2.D93,do.coef=TRUE))
       (Intercept)     outcome2     outcome3    treatment2    treatment3
 [1,]  0.487663863 -0.202713301 -0.213421085 -0.2403303236 -0.2403318006
 [2,]  0.251866292  0.344363277 -0.021250312 -0.2685513379 -0.2685529883
 [3,]  0.113590211 -0.007226311  0.147550227 -0.1243221005 -0.1243228645
 [4,]  0.182329482 -0.198726141 -0.209223314  0.2599986322 -0.0195290885
 [5,]  0.012027606 -0.281073566  0.050465613 -0.2432826631  0.0505050064
 [6,] -0.011696234 -0.029824794  0.174985621  0.1649545337 -0.0348691713
 [7,]  0.383651673 -0.418154757 -0.440242655 -0.0410911950  0.5470769954
 [8,]  0.004420345 -0.103292902  0.018545861  0.0185599731 -0.0894038938
 [9,]  0.018485975  0.047136380 -0.276554087  0.0551076484 -0.2606974420
[10,] -4.690674224  1.949830875  2.052825436  2.3116563291  2.3116705356
[11,] -0.003152766  0.007584554  0.002622903 -0.0004641021 -0.0004641049
[12,]  0.039620024 -0.031307625 -0.090531139  0.0058322551  0.0058322910
[13,]  0.128911668  0.016006179  0.016851663 -0.2615798167 -0.1033421421
[14,]  0.128911729  0.016006187  0.016851671 -0.1033415557 -0.2615783324
> dfbetas(glmb2.D93$fit,influence(glmb2.D93))
       (Intercept)     outcome2     outcome3    treatment2    treatment3
 [1,]  0.487663863 -0.202713301 -0.213421085 -0.2403303236 -0.2403318006
 [2,]  0.251866292  0.344363277 -0.021250312 -0.2685513379 -0.2685529883
 [3,]  0.113590211 -0.007226311  0.147550227 -0.1243221005 -0.1243228645
 [4,]  0.182329482 -0.198726141 -0.209223314  0.2599986322 -0.0195290885
 [5,]  0.012027606 -0.281073566  0.050465613 -0.2432826631  0.0505050064
 [6,] -0.011696234 -0.029824794  0.174985621  0.1649545337 -0.0348691713
 [7,]  0.383651673 -0.418154757 -0.440242655 -0.0410911950  0.5470769954
 [8,]  0.004420345 -0.103292902  0.018545861  0.0185599731 -0.0894038938
 [9,]  0.018485975  0.047136380 -0.276554087  0.0551076484 -0.2606974420
[10,] -4.690674224  1.949830875  2.052825436  2.3116563291  2.3116705356
[11,] -0.003152766  0.007584554  0.002622903 -0.0004641021 -0.0004641049
[12,]  0.039620024 -0.031307625 -0.090531139  0.0058322551  0.0058322910
[13,]  0.128911668  0.016006179  0.016851663 -0.2615798167 -0.1033421421
[14,]  0.128911729  0.016006187  0.016851671 -0.1033415557 -0.2615783324
> 
> 
> 
> 
> # Needs a method function
> cooks.distance(glmb2.D93)
 [1] 4.900571e-02 6.404122e-02 1.353837e-02 4.229564e-02 5.439324e-02
 [6] 2.392723e-02 1.669376e-01 7.579345e-03 5.853844e-02 4.849859e-01
[11] 1.294301e-05 1.839276e-03 1.508271e-02 1.508254e-02
> cooks.distance(glmb2.D93$fit,influence(glmb2.D93))
 [1] 4.900571e-02 6.404122e-02 1.353837e-02 4.229564e-02 5.439324e-02
 [6] 2.392723e-02 1.669376e-01 7.579345e-03 5.853844e-02 4.849859e-01
[11] 1.294301e-05 1.839276e-03 1.508271e-02 1.508254e-02
> 
> 
> 
> # Needs a method function (now works)
> #rstandard(glmb2.D93$fit,influence(glmb2.D93))
> 
> 
> # Needs a method function
> rstudent(glmb2.D93)
 [1]  0.85736899  0.79676325  0.33869979  0.54283794 -0.54355382  0.33685481
 [7]  1.14221329 -0.19975048 -0.53237206 -8.58259030  0.01166208 -0.14447408
[13] -0.40724792 -0.40724739
> rstudent(glmb2.D93$fit,influence(glmb2.D93))
 [1]  0.85736899  0.79676325  0.33869979  0.54283794 -0.54355382  0.33685481
 [7]  1.14221329 -0.19975048 -0.53237206 -8.58259030  0.01166208 -0.14447408
[13] -0.40724792 -0.40724739
> 
> 
> # Not a method, separate function
> glmb.dffits(glmb2.D93)
 [1]  0.487663863  0.554268853  0.247049279  0.441480129 -0.500675335
 [6]  0.328407686  0.928946937 -0.183994536 -0.519026058 -4.690674224
[11]  0.007584554 -0.090531139 -0.261579817 -0.261578332
> dffits(glmb2.D93$fit,influence(glmb2.D93)) 
 [1]  0.487663863  0.554268853  0.247049279  0.441480129 -0.500675335
 [6]  0.328407686  0.928946937 -0.183994536 -0.519026058 -4.690674224
[11]  0.007584554 -0.090531139 -0.261579817 -0.261578332
> 
> # Not a method - separate function
> glmb.covratio(glmb2.D93)  
 [1] 1.536772e+00 1.825394e+00 2.571066e+00 2.498604e+00 2.778566e+00
 [6] 3.275817e+00 1.406681e+00 3.249156e+00 2.953303e+00 2.111793e-05
[11] 2.564017e+00 2.477133e+00 2.297277e+00 2.297271e+00
> covratio(glmb2.D93$fit,influence(glmb2.D93))  
 [1] 1.536772e+00 1.825394e+00 2.571066e+00 2.498604e+00 2.778566e+00
 [6] 3.275817e+00 1.406681e+00 3.249156e+00 2.953303e+00 2.111793e-05
[11] 2.564017e+00 2.477133e+00 2.297277e+00 2.297271e+00
> 
> 
> 
> # Needs a method function but requires a different approach
> # The influence function actually stores this measure
> ## This seems to require more work to create a method function
> ## Should 
> #hat(glmb2.D93,influence(glmb2.D93))
> #hat(glmb2.D93$fit,influence(glmb2.D93))
> 
> infl=influence(glmb2.D93)
> hat2=infl$hat               
> hat2               
 [1] 0.2444410 0.3261137 0.3472719 0.3981078 0.4590068 0.4873046 0.3981108
 [8] 0.4590107 0.4873085 0.2299986 0.2972437 0.2819494 0.2920672 0.2920654
> 
> 
> 
> cleanEx()
> nameEx("glmb.wfit")
> ### * glmb.wfit
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: glmb.wfit
> ### Title: Fitter Function for Bayesian Generalized Linear Models
> ### Aliases: glmb.wfit
> 
> ### ** Examples
> 
> set.seed(333)
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> mysd<-1
> mu<-matrix(0,5)
> mu[1]=log(mean(counts))
> V0<-((mysd)^2)*diag(5)
> glmb.D93<-glmb(counts ~ outcome + treatment, family = poisson(),pfamily=dNormal(mu=mu,Sigma=V0))
Entering EnvelopeBuild_c: 2025-08-03 19:21:21
Entering Envelope Loop: 2025-08-03 19:21:21
> 
> ## Start setup here [First output from earlier optim optimization]
> betastar=glmb.D93$coef.mode  # Posterior mode from optim
> x=glmb.D93$x
> y=glmb.D93$y
> #offset=glmb.D93$offset   # not present in the output --> For now set to 0 vector
> offset2=0*y   # Should return this from lower level functions
> weights2=glmb.D93$prior.weights
> 
> ## Check influence measures for original model
> fit=glmb.wfit(x,y,weights2,offset2,family=poisson(),Bbar=mu,P=solve(V0),betastar)
> influence.measures(fit)
Influence measures of
	 NULL :

      dfb.1_  dfb.otc2  dfb.otc3  dfb.trt2  dfb.trt3     dffit cov.r   cook.d
1  -1.318724  5.99e-01  6.28e-01  0.753402  0.753402 -1.318724 1.933 3.36e-01
2   0.795705  1.27e+00 -9.70e-03 -1.001576 -1.001576  1.993449 0.449 5.91e-01
3  -0.138294  1.14e-03 -1.99e-01  0.174801  0.174801 -0.331235 3.540 2.44e-02
4  -0.117060  1.64e-01  1.72e-01 -0.213707  0.002200 -0.361356 4.154 2.91e-02
5   0.358257 -1.24e+00  2.50e-02 -1.014497  0.025485 -1.985656 0.486 5.94e-01
6  -0.508208 -2.98e-02  1.56e+00  1.426174 -0.035901  2.659421 0.214 8.93e-01
7   0.883999 -1.24e+00 -1.30e+00 -0.016613  1.613845  2.728848 0.363 1.02e+00
8   0.041628 -1.44e-01  2.91e-03  0.002961 -0.117879 -0.230723 3.487 1.19e-02
9   0.423238  2.48e-02 -1.30e+00  0.029899 -1.187724 -2.214776 0.440 7.16e-01
10 -0.044212  2.01e-02  2.11e-02  0.025259  0.025259 -0.044212 1.775 4.36e-04
11 -0.049053  1.08e-01  4.28e-02 -0.000792 -0.000792  0.108065 1.570 2.54e-03
12 -0.030840  2.57e-02  6.47e-02 -0.000498 -0.000498  0.064742 1.741 9.30e-04
13  0.000564  7.23e-06  7.59e-06 -0.000987 -0.000475 -0.000987 1.873 2.19e-07
14  0.000564  7.23e-06  7.59e-06 -0.000475 -0.000987 -0.000987 1.873 2.19e-07
      hat inf
1  0.5673   *
2  0.4923   *
3  0.5218   *
4  0.5900   *
5  0.5000   *
6  0.5306   *
7  0.5900   *
8  0.5000   *
9  0.5306   *
10 0.0275    
11 0.0388    
12 0.0355    
13 0.0378    
14 0.0378    
> 
> print(fit)

Call:
NULL

Coefficients:
(Intercept)     outcome2     outcome3   treatment2   treatment3  
   3.027191    -0.428953    -0.272569     0.004042     0.004042  

> print(glmb.D93$coef.mode)
[1]  3.027191119 -0.428953693 -0.272569221  0.004041969  0.004041974
> 
> ### Now try a strong prior with poorly chosen intercept
> mu1=0*mu
> V1=0.1*V0
> glmb2.D93<-glmb(counts ~ outcome + treatment, family = poisson(),pfamily=dNormal(mu=mu1,Sigma=V1))
Entering EnvelopeBuild_c: 2025-08-03 19:21:21
Entering Envelope Loop: 2025-08-03 19:21:21
> 
> Bbar2=mu1  # Prior mean
> betastar2=glmb2.D93$coef.mode  # Posterior mode from optim
> fit2=glmb.wfit(x,y,weights2,offset2,family=poisson(),Bbar2,P=solve(V1),betastar2)
> 
> influence.measures(fit2)
Influence measures of
	 NULL :

     dfb.1_ dfb.otc2 dfb.otc3  dfb.trt2  dfb.trt3    dffit    cov.r   cook.d
1   0.48766 -0.20271 -0.21342 -0.240330 -0.240332  0.48766 1.54e+00 4.90e-02
2   0.25187  0.34436 -0.02125 -0.268551 -0.268553  0.55427 1.83e+00 6.40e-02
3   0.11359 -0.00723  0.14755 -0.124322 -0.124323  0.24705 2.57e+00 1.35e-02
4   0.18233 -0.19873 -0.20922  0.259999 -0.019529  0.44148 2.50e+00 4.23e-02
5   0.01203 -0.28107  0.05047 -0.243283  0.050505 -0.50068 2.78e+00 5.44e-02
6  -0.01170 -0.02982  0.17499  0.164955 -0.034869  0.32841 3.28e+00 2.39e-02
7   0.38365 -0.41815 -0.44024 -0.041091  0.547077  0.92895 1.41e+00 1.67e-01
8   0.00442 -0.10329  0.01855  0.018560 -0.089404 -0.18399 3.25e+00 7.58e-03
9   0.01849  0.04714 -0.27655  0.055108 -0.260697 -0.51903 2.95e+00 5.85e-02
10 -4.69067  1.94983  2.05283  2.311656  2.311671 -4.69067 2.11e-05 4.85e-01
11 -0.00315  0.00758  0.00262 -0.000464 -0.000464  0.00758 2.56e+00 1.29e-05
12  0.03962 -0.03131 -0.09053  0.005832  0.005832 -0.09053 2.48e+00 1.84e-03
13  0.12891  0.01601  0.01685 -0.261580 -0.103342 -0.26158 2.30e+00 1.51e-02
14  0.12891  0.01601  0.01685 -0.103342 -0.261578 -0.26158 2.30e+00 1.51e-02
     hat inf
1  0.244    
2  0.326    
3  0.347    
4  0.398    
5  0.459   *
6  0.487   *
7  0.398    
8  0.459   *
9  0.487   *
10 0.230   *
11 0.297    
12 0.282    
13 0.292    
14 0.292    
> 
> print(fit2)

Call:
NULL

Coefficients:
(Intercept)     outcome2     outcome3   treatment2   treatment3  
   2.363486    -0.009802     0.122589     0.340056     0.340056  

> print(glmb2.D93$coef.mode)
[1]  2.363485555 -0.009797081  0.122587885  0.340049094  0.340066361
> 
> 
> 
> influence(glmb2.D93)
$hat
 [1] 0.2444410 0.3261137 0.3472719 0.3981078 0.4590068 0.4873046 0.3981108
 [8] 0.4590107 0.4873085 0.2299986 0.2972437 0.2819494 0.2920672 0.2920654

$coefficients
       (Intercept)     outcome2     outcome3    treatment2   treatment3
 [1,]  0.224411797 -0.106047652 -0.108739010 -0.1246270805 -0.124627461
 [2,]  0.116574001  0.181193322 -0.010889800 -0.1400676089 -0.140068036
 [3,]  0.054232896 -0.003922223  0.077998224 -0.0668881167 -0.066888321
 [4,]  0.086102519 -0.106686056 -0.109393616  0.1383594288 -0.010392459
 [5,]  0.005679600 -0.150887167  0.026385000 -0.1294578825  0.026875121
 [6,] -0.005584718 -0.016189238  0.092508268  0.0887561061 -0.018761790
 [7,]  0.171058886 -0.211952863 -0.217331965 -0.0206460063  0.274874462
 [8,]  0.002120262 -0.056324513  0.009849251  0.0100320421 -0.048324469
 [9,]  0.008735668  0.025322331 -0.144696084  0.0293456930 -0.138825075
[10,] -0.705971062  0.333612468  0.342079140  0.3920609940  0.392062190
[11,] -0.001516008  0.004146042  0.001396417 -0.0002514792 -0.000251480
[12,]  0.019026658 -0.017091950 -0.048135857  0.0031561892  0.003156199
[13,]  0.061355020  0.008660426  0.008880217 -0.1402945633 -0.055425896
[14,]  0.061355050  0.008660430  0.008880221 -0.0554257549 -0.140293337

$sigma
 [1] 3.0343276 3.0518910 3.1481778 3.1138402 3.1136942 3.1484196 2.9399904
 [8] 3.1627920 3.1159546 0.9924051 3.1706425 3.1665412 3.1383056 3.1383057

$wt.res
 [1]  2.26133260  1.99614294  0.86147034  1.31137191 -1.24484255  0.75939034
 [7]  2.60526193 -0.46467873 -1.18777571 -7.47400044  0.03099743 -0.38766144
[13] -1.07535074 -1.07535074

> influence(glmb2.D93,do.coef=TRUE)
$hat
 [1] 0.2444410 0.3261137 0.3472719 0.3981078 0.4590068 0.4873046 0.3981108
 [8] 0.4590107 0.4873085 0.2299986 0.2972437 0.2819494 0.2920672 0.2920654

$coefficients
       (Intercept)     outcome2     outcome3    treatment2   treatment3
 [1,]  0.224411797 -0.106047652 -0.108739010 -0.1246270805 -0.124627461
 [2,]  0.116574001  0.181193322 -0.010889800 -0.1400676089 -0.140068036
 [3,]  0.054232896 -0.003922223  0.077998224 -0.0668881167 -0.066888321
 [4,]  0.086102519 -0.106686056 -0.109393616  0.1383594288 -0.010392459
 [5,]  0.005679600 -0.150887167  0.026385000 -0.1294578825  0.026875121
 [6,] -0.005584718 -0.016189238  0.092508268  0.0887561061 -0.018761790
 [7,]  0.171058886 -0.211952863 -0.217331965 -0.0206460063  0.274874462
 [8,]  0.002120262 -0.056324513  0.009849251  0.0100320421 -0.048324469
 [9,]  0.008735668  0.025322331 -0.144696084  0.0293456930 -0.138825075
[10,] -0.705971062  0.333612468  0.342079140  0.3920609940  0.392062190
[11,] -0.001516008  0.004146042  0.001396417 -0.0002514792 -0.000251480
[12,]  0.019026658 -0.017091950 -0.048135857  0.0031561892  0.003156199
[13,]  0.061355020  0.008660426  0.008880217 -0.1402945633 -0.055425896
[14,]  0.061355050  0.008660430  0.008880221 -0.0554257549 -0.140293337

$sigma
 [1] 3.0343276 3.0518910 3.1481778 3.1138402 3.1136942 3.1484196 2.9399904
 [8] 3.1627920 3.1159546 0.9924051 3.1706425 3.1665412 3.1383056 3.1383057

$wt.res
 [1]  2.26133260  1.99614294  0.86147034  1.31137191 -1.24484255  0.75939034
 [7]  2.60526193 -0.46467873 -1.18777571 -7.47400044  0.03099743 -0.38766144
[13] -1.07535074 -1.07535074

> influence(glmb2.D93,do.coef=FALSE)
$hat
 [1] 0.2444410 0.3261137 0.3472719 0.3981078 0.4590068 0.4873046 0.3981108
 [8] 0.4590107 0.4873085 0.2299986 0.2972437 0.2819494 0.2920672 0.2920654

$<NA>
NULL

$sigma
 [1] 3.0343276 3.0518910 3.1481778 3.1138402 3.1136942 3.1484196 2.9399904
 [8] 3.1627920 3.1159546 0.9924051 3.1706425 3.1665412 3.1383056 3.1383057

$wt.res
 [1]  2.26133260  1.99614294  0.86147034  1.31137191 -1.24484255  0.75939034
 [7]  2.60526193 -0.46467873 -1.18777571 -7.47400044  0.03099743 -0.38766144
[13] -1.07535074 -1.07535074

> 
> #glmb2.D93$qr=glmb2.D93$fit$qr
> #influence.measures(glmb2.D93,influence(glmb2.D93))
> #influence.measures(glmb2.D93$fit,influence(glmb2.D93))
> #influence.measures(glmb2.D93$fit,influence(glmb2.D93,do.coef=FALSE))
> glmb.influence.measures(glmb2.D93,influence(glmb2.D93))
Influence measures of
	 NULL :

     dfb.1_ dfb.otc2 dfb.otc3  dfb.trt2  dfb.trt3    dffit    cov.r   cook.d
1   0.48766 -0.20271 -0.21342 -0.240330 -0.240332  0.48766 1.54e+00 4.90e-02
2   0.25187  0.34436 -0.02125 -0.268551 -0.268553  0.55427 1.83e+00 6.40e-02
3   0.11359 -0.00723  0.14755 -0.124322 -0.124323  0.24705 2.57e+00 1.35e-02
4   0.18233 -0.19873 -0.20922  0.259999 -0.019529  0.44148 2.50e+00 4.23e-02
5   0.01203 -0.28107  0.05047 -0.243283  0.050505 -0.50068 2.78e+00 5.44e-02
6  -0.01170 -0.02982  0.17499  0.164955 -0.034869  0.32841 3.28e+00 2.39e-02
7   0.38365 -0.41815 -0.44024 -0.041091  0.547077  0.92895 1.41e+00 1.67e-01
8   0.00442 -0.10329  0.01855  0.018560 -0.089404 -0.18399 3.25e+00 7.58e-03
9   0.01849  0.04714 -0.27655  0.055108 -0.260697 -0.51903 2.95e+00 5.85e-02
10 -4.69067  1.94983  2.05283  2.311656  2.311671 -4.69067 2.11e-05 4.85e-01
11 -0.00315  0.00758  0.00262 -0.000464 -0.000464  0.00758 2.56e+00 1.29e-05
12  0.03962 -0.03131 -0.09053  0.005832  0.005832 -0.09053 2.48e+00 1.84e-03
13  0.12891  0.01601  0.01685 -0.261580 -0.103342 -0.26158 2.30e+00 1.51e-02
14  0.12891  0.01601  0.01685 -0.103342 -0.261578 -0.26158 2.30e+00 1.51e-02
     hat inf
1  0.244    
2  0.326    
3  0.347    
4  0.398    
5  0.459   *
6  0.487   *
7  0.398    
8  0.459   *
9  0.487   *
10 0.230   *
11 0.297    
12 0.282    
13 0.292    
14 0.292    
> 
> 
> ## Do not need method functions
> dfbeta(glmb2.D93,influence(glmb2.D93))
       (Intercept)     outcome2     outcome3    treatment2   treatment3
 [1,]  0.224411797 -0.106047652 -0.108739010 -0.1246270805 -0.124627461
 [2,]  0.116574001  0.181193322 -0.010889800 -0.1400676089 -0.140068036
 [3,]  0.054232896 -0.003922223  0.077998224 -0.0668881167 -0.066888321
 [4,]  0.086102519 -0.106686056 -0.109393616  0.1383594288 -0.010392459
 [5,]  0.005679600 -0.150887167  0.026385000 -0.1294578825  0.026875121
 [6,] -0.005584718 -0.016189238  0.092508268  0.0887561061 -0.018761790
 [7,]  0.171058886 -0.211952863 -0.217331965 -0.0206460063  0.274874462
 [8,]  0.002120262 -0.056324513  0.009849251  0.0100320421 -0.048324469
 [9,]  0.008735668  0.025322331 -0.144696084  0.0293456930 -0.138825075
[10,] -0.705971062  0.333612468  0.342079140  0.3920609940  0.392062190
[11,] -0.001516008  0.004146042  0.001396417 -0.0002514792 -0.000251480
[12,]  0.019026658 -0.017091950 -0.048135857  0.0031561892  0.003156199
[13,]  0.061355020  0.008660426  0.008880217 -0.1402945633 -0.055425896
[14,]  0.061355050  0.008660430  0.008880221 -0.0554257549 -0.140293337
> dfbeta(glmb2.D93$fit,influence(glmb2.D93))
       (Intercept)     outcome2     outcome3    treatment2   treatment3
 [1,]  0.224411797 -0.106047652 -0.108739010 -0.1246270805 -0.124627461
 [2,]  0.116574001  0.181193322 -0.010889800 -0.1400676089 -0.140068036
 [3,]  0.054232896 -0.003922223  0.077998224 -0.0668881167 -0.066888321
 [4,]  0.086102519 -0.106686056 -0.109393616  0.1383594288 -0.010392459
 [5,]  0.005679600 -0.150887167  0.026385000 -0.1294578825  0.026875121
 [6,] -0.005584718 -0.016189238  0.092508268  0.0887561061 -0.018761790
 [7,]  0.171058886 -0.211952863 -0.217331965 -0.0206460063  0.274874462
 [8,]  0.002120262 -0.056324513  0.009849251  0.0100320421 -0.048324469
 [9,]  0.008735668  0.025322331 -0.144696084  0.0293456930 -0.138825075
[10,] -0.705971062  0.333612468  0.342079140  0.3920609940  0.392062190
[11,] -0.001516008  0.004146042  0.001396417 -0.0002514792 -0.000251480
[12,]  0.019026658 -0.017091950 -0.048135857  0.0031561892  0.003156199
[13,]  0.061355020  0.008660426  0.008880217 -0.1402945633 -0.055425896
[14,]  0.061355050  0.008660430  0.008880221 -0.0554257549 -0.140293337
> hatvalues(glmb2.D93,influence(glmb2.D93))
 [1] 0.2444410 0.3261137 0.3472719 0.3981078 0.4590068 0.4873046 0.3981108
 [8] 0.4590107 0.4873085 0.2299986 0.2972437 0.2819494 0.2920672 0.2920654
> hatvalues(glmb2.D93$fit,influence(glmb2.D93))
 [1] 0.2444410 0.3261137 0.3472719 0.3981078 0.4590068 0.4873046 0.3981108
 [8] 0.4590107 0.4873085 0.2299986 0.2972437 0.2819494 0.2920672 0.2920654
> 
> # Methods (implmented)
> 
> rstandard(glmb2.D93,infl=influence(glmb2.D93))
 [1]  0.8702731  0.8134364  0.3566970  0.5654469 -0.5661660  0.3547813
 [7]  1.1233586 -0.2113410 -0.5549216 -2.8492639  0.0123694 -0.1530384
[13] -0.4275426 -0.4275421
> rstandard(glmb2.D93)
 [1]  0.8702731  0.8134364  0.3566970  0.5654469 -0.5661660  0.3547813
 [7]  1.1233586 -0.2113410 -0.5549216 -2.8492639  0.0123694 -0.1530384
[13] -0.4275426 -0.4275421
> 
> 
> # Need Metods
> 
> ## Needs a method function
> #dfbetas(glmb2.D93,influence(glmb2.D93))
> dfbetas(glmb2.D93)
       (Intercept)     outcome2     outcome3    treatment2    treatment3
 [1,]  0.487663863 -0.202713301 -0.213421085 -0.2403303236 -0.2403318006
 [2,]  0.251866292  0.344363277 -0.021250312 -0.2685513379 -0.2685529883
 [3,]  0.113590211 -0.007226311  0.147550227 -0.1243221005 -0.1243228645
 [4,]  0.182329482 -0.198726141 -0.209223314  0.2599986322 -0.0195290885
 [5,]  0.012027606 -0.281073566  0.050465613 -0.2432826631  0.0505050064
 [6,] -0.011696234 -0.029824794  0.174985621  0.1649545337 -0.0348691713
 [7,]  0.383651673 -0.418154757 -0.440242655 -0.0410911950  0.5470769954
 [8,]  0.004420345 -0.103292902  0.018545861  0.0185599731 -0.0894038938
 [9,]  0.018485975  0.047136380 -0.276554087  0.0551076484 -0.2606974420
[10,] -4.690674224  1.949830875  2.052825436  2.3116563291  2.3116705356
[11,] -0.003152766  0.007584554  0.002622903 -0.0004641021 -0.0004641049
[12,]  0.039620024 -0.031307625 -0.090531139  0.0058322551  0.0058322910
[13,]  0.128911668  0.016006179  0.016851663 -0.2615798167 -0.1033421421
[14,]  0.128911729  0.016006187  0.016851671 -0.1033415557 -0.2615783324
> dfbetas(glmb2.D93,influence(glmb2.D93,do.coef=TRUE))
       (Intercept)     outcome2     outcome3    treatment2    treatment3
 [1,]  0.487663863 -0.202713301 -0.213421085 -0.2403303236 -0.2403318006
 [2,]  0.251866292  0.344363277 -0.021250312 -0.2685513379 -0.2685529883
 [3,]  0.113590211 -0.007226311  0.147550227 -0.1243221005 -0.1243228645
 [4,]  0.182329482 -0.198726141 -0.209223314  0.2599986322 -0.0195290885
 [5,]  0.012027606 -0.281073566  0.050465613 -0.2432826631  0.0505050064
 [6,] -0.011696234 -0.029824794  0.174985621  0.1649545337 -0.0348691713
 [7,]  0.383651673 -0.418154757 -0.440242655 -0.0410911950  0.5470769954
 [8,]  0.004420345 -0.103292902  0.018545861  0.0185599731 -0.0894038938
 [9,]  0.018485975  0.047136380 -0.276554087  0.0551076484 -0.2606974420
[10,] -4.690674224  1.949830875  2.052825436  2.3116563291  2.3116705356
[11,] -0.003152766  0.007584554  0.002622903 -0.0004641021 -0.0004641049
[12,]  0.039620024 -0.031307625 -0.090531139  0.0058322551  0.0058322910
[13,]  0.128911668  0.016006179  0.016851663 -0.2615798167 -0.1033421421
[14,]  0.128911729  0.016006187  0.016851671 -0.1033415557 -0.2615783324
> dfbetas(glmb2.D93$fit,influence(glmb2.D93))
       (Intercept)     outcome2     outcome3    treatment2    treatment3
 [1,]  0.487663863 -0.202713301 -0.213421085 -0.2403303236 -0.2403318006
 [2,]  0.251866292  0.344363277 -0.021250312 -0.2685513379 -0.2685529883
 [3,]  0.113590211 -0.007226311  0.147550227 -0.1243221005 -0.1243228645
 [4,]  0.182329482 -0.198726141 -0.209223314  0.2599986322 -0.0195290885
 [5,]  0.012027606 -0.281073566  0.050465613 -0.2432826631  0.0505050064
 [6,] -0.011696234 -0.029824794  0.174985621  0.1649545337 -0.0348691713
 [7,]  0.383651673 -0.418154757 -0.440242655 -0.0410911950  0.5470769954
 [8,]  0.004420345 -0.103292902  0.018545861  0.0185599731 -0.0894038938
 [9,]  0.018485975  0.047136380 -0.276554087  0.0551076484 -0.2606974420
[10,] -4.690674224  1.949830875  2.052825436  2.3116563291  2.3116705356
[11,] -0.003152766  0.007584554  0.002622903 -0.0004641021 -0.0004641049
[12,]  0.039620024 -0.031307625 -0.090531139  0.0058322551  0.0058322910
[13,]  0.128911668  0.016006179  0.016851663 -0.2615798167 -0.1033421421
[14,]  0.128911729  0.016006187  0.016851671 -0.1033415557 -0.2615783324
> 
> 
> 
> 
> # Needs a method function
> cooks.distance(glmb2.D93)
 [1] 4.900571e-02 6.404122e-02 1.353837e-02 4.229564e-02 5.439324e-02
 [6] 2.392723e-02 1.669376e-01 7.579345e-03 5.853844e-02 4.849859e-01
[11] 1.294301e-05 1.839276e-03 1.508271e-02 1.508254e-02
> cooks.distance(glmb2.D93$fit,influence(glmb2.D93))
 [1] 4.900571e-02 6.404122e-02 1.353837e-02 4.229564e-02 5.439324e-02
 [6] 2.392723e-02 1.669376e-01 7.579345e-03 5.853844e-02 4.849859e-01
[11] 1.294301e-05 1.839276e-03 1.508271e-02 1.508254e-02
> 
> 
> 
> # Needs a method function (now works)
> #rstandard(glmb2.D93$fit,influence(glmb2.D93))
> 
> 
> # Needs a method function
> rstudent(glmb2.D93)
 [1]  0.85736899  0.79676325  0.33869979  0.54283794 -0.54355382  0.33685481
 [7]  1.14221329 -0.19975048 -0.53237206 -8.58259030  0.01166208 -0.14447408
[13] -0.40724792 -0.40724739
> rstudent(glmb2.D93$fit,influence(glmb2.D93))
 [1]  0.85736899  0.79676325  0.33869979  0.54283794 -0.54355382  0.33685481
 [7]  1.14221329 -0.19975048 -0.53237206 -8.58259030  0.01166208 -0.14447408
[13] -0.40724792 -0.40724739
> 
> 
> # Not a method, separate function
> glmb.dffits(glmb2.D93)
 [1]  0.487663863  0.554268853  0.247049279  0.441480129 -0.500675335
 [6]  0.328407686  0.928946937 -0.183994536 -0.519026058 -4.690674224
[11]  0.007584554 -0.090531139 -0.261579817 -0.261578332
> dffits(glmb2.D93$fit,influence(glmb2.D93)) 
 [1]  0.487663863  0.554268853  0.247049279  0.441480129 -0.500675335
 [6]  0.328407686  0.928946937 -0.183994536 -0.519026058 -4.690674224
[11]  0.007584554 -0.090531139 -0.261579817 -0.261578332
> 
> # Not a method - separate function
> glmb.covratio(glmb2.D93)  
 [1] 1.536772e+00 1.825394e+00 2.571066e+00 2.498604e+00 2.778566e+00
 [6] 3.275817e+00 1.406681e+00 3.249156e+00 2.953303e+00 2.111793e-05
[11] 2.564017e+00 2.477133e+00 2.297277e+00 2.297271e+00
> covratio(glmb2.D93$fit,influence(glmb2.D93))  
 [1] 1.536772e+00 1.825394e+00 2.571066e+00 2.498604e+00 2.778566e+00
 [6] 3.275817e+00 1.406681e+00 3.249156e+00 2.953303e+00 2.111793e-05
[11] 2.564017e+00 2.477133e+00 2.297277e+00 2.297271e+00
> 
> 
> 
> # Needs a method function but requires a different approach
> # The influence function actually stores this measure
> ## This seems to require more work to create a method function
> ## Should 
> #hat(glmb2.D93,influence(glmb2.D93))
> #hat(glmb2.D93$fit,influence(glmb2.D93))
> 
> infl=influence(glmb2.D93)
> hat2=infl$hat               
> hat2               
 [1] 0.2444410 0.3261137 0.3472719 0.3981078 0.4590068 0.4873046 0.3981108
 [8] 0.4590107 0.4873085 0.2299986 0.2972437 0.2819494 0.2920672 0.2920654
> 
> 
> 
> cleanEx()
> nameEx("glmb_Standardize_Model")
> ### * glmb_Standardize_Model
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: glmb_Standardize_Model
> ### Title: Standardize A Non-Gaussian Model
> ### Aliases: glmb_Standardize_Model
> ### Keywords: internal
> 
> ### ** Examples
> 
> data(menarche2)
> 
> summary(menarche2)
      Age            Total           Menarche      
 Min.   : 9.21   Min.   :  88.0   Min.   :   0.00  
 1st Qu.:11.58   1st Qu.:  98.0   1st Qu.:  10.00  
 Median :13.08   Median : 105.0   Median :  51.00  
 Mean   :13.10   Mean   : 156.7   Mean   :  92.32  
 3rd Qu.:14.58   3rd Qu.: 117.0   3rd Qu.:  92.00  
 Max.   :17.58   Max.   :1049.0   Max.   :1049.00  
> plot(Menarche/Total ~ Age, data=menarche2)
> 
> Age2=menarche2$Age-13
> 
> x<-matrix(as.numeric(1.0),nrow=length(Age2),ncol=2)
> x[,2]=Age2
> 
> y=menarche2$Menarche/menarche2$Total
> wt=menarche2$Total
> 
> mu<-matrix(as.numeric(0.0),nrow=2,ncol=1)
> mu[2,1]=(log(0.9/0.1)-log(0.5/0.5))/3
> 
> V1<-1*diag(as.numeric(2.0))
> 
> # 2 standard deviations for prior estimate at age 13 between 0.1 and 0.9
> ## Specifies uncertainty around the point estimates
> 
> V1[1,1]<-((log(0.9/0.1)-log(0.5/0.5))/2)^2 
> V1[2,2]=(3*mu[2,1]/2)^2  # Allows slope to be up to 1 times as large as point estimate 
> 
> famfunc<-glmbfamfunc(binomial(logit))
> 
> f1<-famfunc$f1
> f2<-famfunc$f2
> f3<-famfunc$f3
> f5<-famfunc$f5
> f6<-famfunc$f6
> 
> dispersion2<-as.numeric(1.0)
> start <- mu
> offset2=rep(as.numeric(0.0),length(y))
> P=solve(V1)
> n=1000
> 
> ## Appears that the type for some of these arguments are important/problematic
> 
> 
> 
> ###### Adjust weight for dispersion
> 
> wt2=wt/dispersion2
> 
> ######################### Shift mean vector to offset so that adjusted model has 0 mean
> 
> alpha=x%*%as.vector(mu)+offset2
> mu2=0*as.vector(mu)
> P2=P
> x2=x
> 
> 
> #####  Optimization step to find posterior mode and associated Precision
> 
> parin=start-mu
> 
> opt_out=optim(parin,f2,f3,y=as.vector(y),x=as.matrix(x),mu=as.vector(mu2),
+               P=as.matrix(P),alpha=as.vector(alpha),wt=as.vector(wt2),
+               method="BFGS",hessian=TRUE
+ )
> 
> bstar=opt_out$par  ## Posterior mode for adjusted model
> bstar
            [,1]
[1,] -0.01069645
[2,]  0.89698197
> bstar+as.vector(mu)  # mode for actual model
            [,1]
[1,] -0.01069645
[2,]  1.62939016
> A1=opt_out$hessian # Approximate Precision at mode
> 
> ## Standardize Model
> 
> Standard_Mod=glmb_Standardize_Model(y=as.vector(y), x=as.matrix(x),P=as.matrix(P),
+                                     bstar=as.matrix(bstar,ncol=1), A1=as.matrix(A1))
> 
> bstar2=Standard_Mod$bstar2  
> A=Standard_Mod$A
> x2=Standard_Mod$x2
> mu2=Standard_Mod$mu2
> P2=Standard_Mod$P2
> L2Inv=Standard_Mod$L2Inv
> L3Inv=Standard_Mod$L3Inv
> 
> 
> 
> cleanEx()
> nameEx("glmbayes")
> ### * glmbayes
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: glmbayes
> ### Title: Bayesian Generalized Linear Models (iid Samples)
> ### Aliases: glmbayes PackageOverview
> ### Keywords: internal
> 
> ### ** Examples
> 
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> print(d.AD <- data.frame(treatment, outcome, counts))
  treatment outcome counts
1         1       1     18
2         1       2     17
3         1       3     15
4         2       1     20
5         2       2     10
6         2       3     20
7         3       1     25
8         3       2     13
9         3       3     12
> 
> ## Call to glm
> glm.D93 <- glm(counts ~ outcome + treatment, 
+                family = poisson())
> 
> ## Using glmb
> ## Step 1: Set up Prior
> ps=Prior_Setup(counts ~ outcome + treatment)
[1] "Variable names are:"
[1] "(Intercept)" "outcome2"    "outcome3"    "treatment2"  "treatment3" 
> mu=ps$mu
> V=ps$Sigma
> # Step2A: Check the Prior
> Prior_Check(counts ~ outcome + treatment,family = poisson(),
+             pfamily=dNormal(mu=mu,Sigma=V))
[1] "Variables in the Model Are:"
[1] "(Intercept)" "outcome2"    "outcome3"    "treatment2"  "treatment3" 
[1] "At least one of the maximum likelihood estimates appears to be inconsistent with the prior"
               abs_ratio
(Intercept) 7.072923e+00
outcome2    2.297241e-01
outcome3    1.493395e-01
treatment2  6.168282e-16
treatment3  4.274795e-16
> # Step2B: Update and Re-Check the Prior
> mu[1,1]=log(mean(counts))
> Prior_Check(counts ~ outcome + treatment,family = poisson(),
+             pfamily=dNormal(mu=mu,Sigma=V))
[1] "Variables in the Model Are:"
[1] "(Intercept)" "outcome2"    "outcome3"    "treatment2"  "treatment3" 
[1] "The maximum likelihood estimates for all coefficients appear to be roughly consistent with the prior."
               abs_ratio
(Intercept) 1.199984e-01
outcome2    2.297241e-01
outcome3    1.493395e-01
treatment2  6.168282e-16
treatment3  4.274795e-16
> # Step 3: Call the glmb function
> glmb.D93<-glmb(counts ~ outcome + treatment, family=poisson(), 
+                pfamily=dNormal(mu=mu,Sigma=V))
Entering EnvelopeBuild_c: 2025-08-03 19:21:21
Entering Envelope Loop: 2025-08-03 19:21:21
> 
> ## ----Printed_Views------------------------------------------------------------
> ## Printed view of the output from the glm function 
> print(glm.D93)

Call:  glm(formula = counts ~ outcome + treatment, family = poisson())

Coefficients:
(Intercept)     outcome2     outcome3   treatment2   treatment3  
  3.045e+00   -4.543e-01   -2.930e-01    1.218e-15    8.438e-16  

Degrees of Freedom: 8 Total (i.e. Null);  4 Residual
Null Deviance:	    10.58 
Residual Deviance: 5.129 	AIC: 56.76
> ## Printed view of the output from the glmb function 
> print(glmb.D93)

Call:  glmb(formula = counts ~ outcome + treatment, family = poisson(), 
    pfamily = dNormal(mu = mu, Sigma = V))

Posterior Mean Coefficients:
(Intercept)     outcome2     outcome3   treatment2   treatment3  
   3.017000    -0.434800    -0.287550    -0.001401     0.009702  

Effective Number of Parameters: 4.758146 
Expected Residual Deviance: 9.947723 
DIC: 56.33805 

> 
> ## ----Methods---------------------------------------------------------------
> ## Methods for class "lm"
> methods(class="lm")
 [1] add1           addterm        alias          anova          boxcox        
 [6] case.names     coerce         confint        cooks.distance deviance      
[11] dfbeta         dfbetas        drop1          dropterm       dummy.coef    
[16] effects        extractAIC     family         formula        hatvalues     
[21] influence      initialize     kappa          labels         logLik        
[26] logtrans       model.frame    model.matrix   nobs           plot          
[31] predict        print          proj           qr             residuals     
[36] rstandard      rstudent       show           simulate       slotsFromS3   
[41] summary        variable.names vcov          
see '?methods' for accessing help and source code
> 
> ## Methods for class "glm"
> methods(class="glm")
 [1] add1           addterm        anova          coerce         confint       
 [6] cooks.distance deviance       drop1          dropterm       effects       
[11] extractAIC     family         formula        gamma.shape    influence     
[16] initialize     logLik         model.frame    nobs           predict       
[21] print          profile        residuals      rstandard      rstudent      
[26] show           sigma          slotsFromS3    summary        vcov          
[31] weights       
see '?methods' for accessing help and source code
> 
> ## Methods for class "glmb"
> methods(class="glmb")
 [1] anova          case.names     confint        cooks.distance dfbetas       
 [6] dummy.coef     extractAIC     influence      logLik         predict       
[11] print          residuals      rstandard      rstudent       simulate      
[16] summary        variable.names vcov          
see '?methods' for accessing help and source code
> 
> ## ----summary--------------------------------------------------------------
> ## summary output for the "glm" class
> summary(glm.D93)

Call:
glm(formula = counts ~ outcome + treatment, family = poisson())

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept)  3.045e+00  1.709e-01  17.815   <2e-16 ***
outcome2    -4.543e-01  2.022e-01  -2.247   0.0246 *  
outcome3    -2.930e-01  1.927e-01  -1.520   0.1285    
treatment2   1.217e-15  2.000e-01   0.000   1.0000    
treatment3   8.438e-16  2.000e-01   0.000   1.0000    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 10.5814  on 8  degrees of freedom
Residual deviance:  5.1291  on 4  degrees of freedom
AIC: 56.761

Number of Fisher Scoring iterations: 4

> 
> ## summary output for the "glm" class
> summary(glmb.D93)
Call
glmb(formula = counts ~ outcome + treatment, family = poisson(), 
    pfamily = dNormal(mu = mu, Sigma = V))

Expected Deviance Residuals:
      1       2       3       4       5       6       7       8       9 
-0.5693  0.9719 -0.1044 -0.1107 -0.9458  1.1243  0.9089 -0.1211 -0.9408 

Prior and Maximum Likelihood Estimates with Standard Deviations

                    mu   Prior.sd  Max Like. Like.sd
(Intercept)  2.813e+00  1.000e+00  3.045e+00   0.171
outcome2     0.000e+00  1.000e+00 -4.543e-01   0.202
outcome3     0.000e+00  1.000e+00 -2.930e-01   0.193
treatment2   0.000e+00  1.000e+00  1.217e-15   0.200
treatment3   0.000e+00  1.000e+00  8.438e-16   0.200

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean   Post.Sd MC Error Pr(tail)  
(Intercept)  3.027191  3.017000  0.164735        0   0.1049  
outcome2    -0.428954 -0.434800  0.202182        0   0.0180 *
outcome3    -0.272569 -0.287550  0.187742        0   0.0559 .
treatment2   0.004042 -0.001401  0.195914        0   0.4965  
treatment3   0.004042  0.009702  0.196239        0   0.4765  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Distribution Percentiles

                 1.0%      2.5%      5.0%    Median     95.0%     97.5% 99.0%
(Intercept)  2.630138  2.689414  2.746579  3.010937  3.296038  3.351224 3.387
outcome2    -0.889797 -0.830809 -0.773730 -0.434640 -0.111458 -0.044066 0.033
outcome3    -0.699283 -0.662802 -0.611005 -0.279424  0.016081  0.075053 0.122
treatment2  -0.467498 -0.386503 -0.318533 -0.001869  0.314874  0.400117 0.448
treatment3  -0.404372 -0.360106 -0.309063  0.012786  0.318745  0.387855 0.474

Effective Number of Parameters: 4.758146 
Expected Residual Deviance: 9.947723 
DIC: 56.33805 

Expected Mean dispersion: 1 
Sq.root of Expected Mean dispersion: 1 

Mean Likelihood Subgradient Candidates Per iid sample: 1.786 

> 
> ## ----fitted outputs-------------------------------------------------------
> ## fitted outputs for the glm function
> fitted(glm.D93)
       1        2        3        4        5        6        7        8 
21.00000 13.33333 15.66667 21.00000 13.33333 15.66667 21.00000 13.33333 
       9 
15.66667 
> 
> ## ----glmb fitted outputs------------------------------------------------------
> ## mean of fitted outputs for the glm function
> colMeans(fitted(glmb.D93))
       1        2        3        4        5        6        7        8 
20.70958 13.46158 15.57478 20.69420 13.46196 15.55839 20.93179 13.61420 
       9 
15.72329 
> 
> ## ----predictions----------------------------------------------------------
> ## predictions for the glm function
> predict(glm.D93)
       1        2        3        4        5        6        7        8 
3.044522 2.590267 2.751535 3.044522 2.590267 2.751535 3.044522 2.590267 
       9 
2.751535 
> 
> ## predictions for the glmb function
> colMeans(predict(glmb.D93)) 
       1        2        3        4        5        6        7        8 
3.017000 2.582200 2.729450 3.015599 2.580799 2.728049 3.026702 2.591902 
       9 
2.739152 
> 
> ## ----residuals------------------------------------------------------------
> ## residuals for the glm function
> residuals(glm.D93)
          1           2           3           4           5           6 
-0.67124923  0.96272360 -0.16964662 -0.21998507 -0.95552353  1.04938637 
          7           8           9 
 0.84715368 -0.09167147 -0.96656372 
> 
> ## residuals for the glmb function
> colMeans(residuals(glmb.D93))
         1          2          3          4          5          6          7 
-0.5693138  0.9719327 -0.1044445 -0.1106713 -0.9457893  1.1243217  0.9089016 
         8          9 
-0.1211246 -0.9407801 
> 
> ## ----vcov-----------------------------------------------------------------
> ## vcov for the glm function
> vcov(glm.D93)
            (Intercept)      outcome2      outcome3    treatment2    treatment3
(Intercept)  0.02920635 -1.587302e-02 -1.587302e-02 -2.000000e-02 -2.000000e-02
outcome2    -0.01587302  4.087301e-02  1.587302e-02 -7.889764e-18 -7.435533e-18
outcome3    -0.01587302  1.587302e-02  3.714961e-02 -5.991636e-18 -6.847584e-18
treatment2  -0.02000000 -7.889764e-18 -5.991636e-18  4.000000e-02  2.000000e-02
treatment3  -0.02000000 -7.435533e-18 -6.847584e-18  2.000000e-02  4.000000e-02
> 
> ## vcov for the glm function
> vcov(glmb.D93)
            (Intercept)      outcome2      outcome3    treatment2    treatment3
(Intercept)  0.02713764 -0.0163006859 -0.0148572821 -0.0184547241 -0.0181790758
outcome2    -0.01630069  0.0408773767  0.0151586020  0.0007670780  0.0005210264
outcome3    -0.01485728  0.0151586020  0.0352470628 -0.0004384944 -0.0013034802
treatment2  -0.01845472  0.0007670780 -0.0004384944  0.0383823033  0.0192098281
treatment3  -0.01817908  0.0005210264 -0.0013034802  0.0192098281  0.0385099062
> 
> ## ----confint--------------------------------------------------------------
> ## confint for the glm function
> confint(glm.D93)
Waiting for profiling to be done...
                 2.5 %      97.5 %
(Intercept)  2.6958215  3.36655581
outcome2    -0.8577018 -0.06255840
outcome3    -0.6753696  0.08244089
treatment2  -0.3932548  0.39325483
treatment3  -0.3932548  0.39325483
> 
> ## confint for the glm function
> confint(glmb.D93)
                  2.5%       97.5%
(Intercept)  2.6894139  3.35122441
outcome2    -0.8308085 -0.04406642
outcome3    -0.6628016  0.07505254
treatment2  -0.3865027  0.40011663
treatment3  -0.3601064  0.38785469
> 
> ## ----AIC/DIC------------------------------------------------------------------
> ## AIC for the glm function (equivalent degrees of freedom and the AIC)
> extractAIC(glm.D93)
[1]  5.00000 56.76132
> 
> ## DIC for the glmb function (estimated effective number of parameters and the DIC)
> extractAIC(glmb.D93)
       pD       DIC 
 4.758146 56.338046 
> 
> ## ----Deviance-------------------------------------------------------------
> ## Deviance for the glm function
> deviance(glm.D93)
[1] 5.129141
> 
> ## Deviance for the glmb function
> mean(deviance(glmb.D93))
[1] 9.947723
> 
> ## ----logLik---------------------------------------------------------------
> ## Deviance for the glm function
> logLik(glm.D93)
'log Lik.' -23.38066 (df=5)
> 
> ## Deviance for the glmb function
> mean(logLik(glmb.D93))
[1] -25.78995
> 
> ## ----Model Frame----------------------------------------------------------
> ## Model Frame for the glm function
> model.frame(glm.D93)
  counts outcome treatment
1     18       1         1
2     17       2         1
3     15       3         1
4     20       1         2
5     10       2         2
6     20       3         2
7     25       1         3
8     13       2         3
9     12       3         3
> 
> ## Model Frame for the glmb function
> model.frame(glmb.D93$glm)
  counts outcome treatment
1     18       1         1
2     17       2         1
3     15       3         1
4     20       1         2
5     10       2         2
6     20       3         2
7     25       1         3
8     13       2         3
9     12       3         3
> 
> ## ----formula--------------------------------------------------------------
> ## formula for the glm function
> formula(glm.D93)
counts ~ outcome + treatment
> 
> ## ----formula-------------------------------------------------------------
> ## formula for the glmb function
> formula(glmb.D93)
counts ~ outcome + treatment
> 
> ## ----family--------------------------------------------------------------
> ## family for the glm function
> family(glm.D93)

Family: poisson 
Link function: log 

> 
> ## family for the glmb function
> family(glmb.D93$glm)

Family: poisson 
Link function: log 

> 
> ## ----nobs-----------------------------------------------------------------
> ## nobs for the glm function
> nobs(glm.D93)
[1] 9
> 
> ## nobs for the glmb function
> nobs(glmb.D93)
[1] 9
> 
> ## ----show-----------------------------------------------------------------
> ## show for the glm function
> show(glm.D93)

Call:  glm(formula = counts ~ outcome + treatment, family = poisson())

Coefficients:
(Intercept)     outcome2     outcome3   treatment2   treatment3  
  3.045e+00   -4.543e-01   -2.930e-01    1.218e-15    8.438e-16  

Degrees of Freedom: 8 Total (i.e. Null);  4 Residual
Null Deviance:	    10.58 
Residual Deviance: 5.129 	AIC: 56.76
> 
> ## show for the glmb function
> show(glmb.D93)

Call:  glmb(formula = counts ~ outcome + treatment, family = poisson(), 
    pfamily = dNormal(mu = mu, Sigma = V))

Posterior Mean Coefficients:
(Intercept)     outcome2     outcome3   treatment2   treatment3  
   3.017000    -0.434800    -0.287550    -0.001401     0.009702  

Effective Number of Parameters: 4.758146 
Expected Residual Deviance: 9.947723 
DIC: 56.33805 

> 
> 
> 
> cleanEx()
> nameEx("glmbfamfunc")
> ### * glmbfamfunc
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: glmbfamfunc
> ### Title: Return family functions used during simulation and post
> ###   processing
> ### Aliases: glmbfamfunc print.glmbfamfunc
> ### Keywords: internal
> 
> ### ** Examples
> 
> famfunc<-glmbfamfunc(binomial(logit))
> 
> print(famfunc)
$f1
function (b, y, x, alpha = 0, wt = 1) 
{
    lambda <- t(exp(alpha + x %*% b))
    p <- lambda/(1 + lambda)
    -sum(dbinom(round(wt * y), round(wt), p, log = TRUE))
}
<bytecode: 0x0000026930c30350>
<environment: 0x00000269336c2d28>

$f2
function (b, y, x, mu, P, alpha = 0, wt = 1) 
{
    lambda <- t(exp(alpha + x %*% b))
    p <- lambda/(1 + lambda)
    -sum(dbinom(round(wt * y), round(wt), p, log = TRUE)) + 0.5 * 
        t((b - mu)) %*% P %*% (b - mu)
}
<bytecode: 0x0000026930c3d508>
<environment: 0x00000269336c2d28>

$f3
function (b, y, x, mu, P, alpha = 0, wt = 1) 
{
    p <- 1/(1 + t(exp(-alpha - x %*% b)))
    t(x) %*% ((t(p) - y) * wt) + P %*% (b - mu)
}
<bytecode: 0x0000026930c3c200>
<environment: 0x00000269336c2d28>

$f4
function (b, y, x, alpha = 0, wt = 1, dispersion = 1) 
{
    (2 * f1(b, y, x, alpha, wt/dispersion) + 2 * sum(dbinom(round((wt/dispersion) * 
        y), round(wt/dispersion), y, log = TRUE)))
}
<bytecode: 0x0000026930c5c230>
<environment: 0x00000269336c2d28>

$f7
function (b, y, x, mu, P, alpha = 0, wt = 1) 
{
    l2 <- length(y)
    l1 <- length(b)
    ltemp <- length(wt)
    if (ltemp == 1) {
        Ptemp <- wt * diag(l2)
    }
    else {
        Ptemp <- diag(wt)
    }
    p <- 1/(1 + t(exp(-alpha - x %*% b)))
    Pout <- matrix(0, nrow = l1, ncol = l1)
    for (i in 1:l2) {
        Pout <- Pout + Ptemp[i, i] * p[i] * (1 - p[i]) * x[i, 
            ] %*% t(x[i, ])
    }
    Pout
}
<bytecode: 0x0000026930c5b318>
<environment: 0x00000269336c2d28>

$call
glmbfamfunc(family = binomial(logit))

attr(,"class")
[1] "glmbfamfunc"
> 
> f1<-famfunc$f1
> f2<-famfunc$f2
> f3<-famfunc$f3
> f5<-famfunc$f5
> f6<-famfunc$f6
> 
> 
> 
> cleanEx()
> nameEx("influence.glmb")
> ### * influence.glmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: influence.glmb
> ### Title: Bayesian Regression Diagnostics
> ### Aliases: influence.glmb
> 
> ### ** Examples
> 
> set.seed(333)
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> mysd<-1
> mu<-matrix(0,5)
> mu[1]=log(mean(counts))
> V0<-((mysd)^2)*diag(5)
> glmb.D93<-glmb(counts ~ outcome + treatment, family = poisson(),pfamily=dNormal(mu=mu,Sigma=V0))
Entering EnvelopeBuild_c: 2025-08-03 19:21:21
Entering Envelope Loop: 2025-08-03 19:21:21
> 
> ## Start setup here [First output from earlier optim optimization]
> betastar=glmb.D93$coef.mode  # Posterior mode from optim
> x=glmb.D93$x
> y=glmb.D93$y
> #offset=glmb.D93$offset   # not present in the output --> For now set to 0 vector
> offset2=0*y   # Should return this from lower level functions
> weights2=glmb.D93$prior.weights
> 
> ## Check influence measures for original model
> fit=glmb.wfit(x,y,weights2,offset2,family=poisson(),Bbar=mu,P=solve(V0),betastar)
> influence.measures(fit)
Influence measures of
	 NULL :

      dfb.1_  dfb.otc2  dfb.otc3  dfb.trt2  dfb.trt3     dffit cov.r   cook.d
1  -1.318724  5.99e-01  6.28e-01  0.753402  0.753402 -1.318724 1.933 3.36e-01
2   0.795705  1.27e+00 -9.70e-03 -1.001576 -1.001576  1.993449 0.449 5.91e-01
3  -0.138294  1.14e-03 -1.99e-01  0.174801  0.174801 -0.331235 3.540 2.44e-02
4  -0.117060  1.64e-01  1.72e-01 -0.213707  0.002200 -0.361356 4.154 2.91e-02
5   0.358257 -1.24e+00  2.50e-02 -1.014497  0.025485 -1.985656 0.486 5.94e-01
6  -0.508208 -2.98e-02  1.56e+00  1.426174 -0.035901  2.659421 0.214 8.93e-01
7   0.883999 -1.24e+00 -1.30e+00 -0.016613  1.613845  2.728848 0.363 1.02e+00
8   0.041628 -1.44e-01  2.91e-03  0.002961 -0.117879 -0.230723 3.487 1.19e-02
9   0.423238  2.48e-02 -1.30e+00  0.029899 -1.187724 -2.214776 0.440 7.16e-01
10 -0.044212  2.01e-02  2.11e-02  0.025259  0.025259 -0.044212 1.775 4.36e-04
11 -0.049053  1.08e-01  4.28e-02 -0.000792 -0.000792  0.108065 1.570 2.54e-03
12 -0.030840  2.57e-02  6.47e-02 -0.000498 -0.000498  0.064742 1.741 9.30e-04
13  0.000564  7.23e-06  7.59e-06 -0.000987 -0.000475 -0.000987 1.873 2.19e-07
14  0.000564  7.23e-06  7.59e-06 -0.000475 -0.000987 -0.000987 1.873 2.19e-07
      hat inf
1  0.5673   *
2  0.4923   *
3  0.5218   *
4  0.5900   *
5  0.5000   *
6  0.5306   *
7  0.5900   *
8  0.5000   *
9  0.5306   *
10 0.0275    
11 0.0388    
12 0.0355    
13 0.0378    
14 0.0378    
> 
> print(fit)

Call:
NULL

Coefficients:
(Intercept)     outcome2     outcome3   treatment2   treatment3  
   3.027191    -0.428953    -0.272569     0.004042     0.004042  

> print(glmb.D93$coef.mode)
[1]  3.027191119 -0.428953693 -0.272569221  0.004041969  0.004041974
> 
> ### Now try a strong prior with poorly chosen intercept
> mu1=0*mu
> V1=0.1*V0
> glmb2.D93<-glmb(counts ~ outcome + treatment, family = poisson(),pfamily=dNormal(mu=mu1,Sigma=V1))
Entering EnvelopeBuild_c: 2025-08-03 19:21:21
Entering Envelope Loop: 2025-08-03 19:21:21
> 
> Bbar2=mu1  # Prior mean
> betastar2=glmb2.D93$coef.mode  # Posterior mode from optim
> fit2=glmb.wfit(x,y,weights2,offset2,family=poisson(),Bbar2,P=solve(V1),betastar2)
> 
> influence.measures(fit2)
Influence measures of
	 NULL :

     dfb.1_ dfb.otc2 dfb.otc3  dfb.trt2  dfb.trt3    dffit    cov.r   cook.d
1   0.48766 -0.20271 -0.21342 -0.240330 -0.240332  0.48766 1.54e+00 4.90e-02
2   0.25187  0.34436 -0.02125 -0.268551 -0.268553  0.55427 1.83e+00 6.40e-02
3   0.11359 -0.00723  0.14755 -0.124322 -0.124323  0.24705 2.57e+00 1.35e-02
4   0.18233 -0.19873 -0.20922  0.259999 -0.019529  0.44148 2.50e+00 4.23e-02
5   0.01203 -0.28107  0.05047 -0.243283  0.050505 -0.50068 2.78e+00 5.44e-02
6  -0.01170 -0.02982  0.17499  0.164955 -0.034869  0.32841 3.28e+00 2.39e-02
7   0.38365 -0.41815 -0.44024 -0.041091  0.547077  0.92895 1.41e+00 1.67e-01
8   0.00442 -0.10329  0.01855  0.018560 -0.089404 -0.18399 3.25e+00 7.58e-03
9   0.01849  0.04714 -0.27655  0.055108 -0.260697 -0.51903 2.95e+00 5.85e-02
10 -4.69067  1.94983  2.05283  2.311656  2.311671 -4.69067 2.11e-05 4.85e-01
11 -0.00315  0.00758  0.00262 -0.000464 -0.000464  0.00758 2.56e+00 1.29e-05
12  0.03962 -0.03131 -0.09053  0.005832  0.005832 -0.09053 2.48e+00 1.84e-03
13  0.12891  0.01601  0.01685 -0.261580 -0.103342 -0.26158 2.30e+00 1.51e-02
14  0.12891  0.01601  0.01685 -0.103342 -0.261578 -0.26158 2.30e+00 1.51e-02
     hat inf
1  0.244    
2  0.326    
3  0.347    
4  0.398    
5  0.459   *
6  0.487   *
7  0.398    
8  0.459   *
9  0.487   *
10 0.230   *
11 0.297    
12 0.282    
13 0.292    
14 0.292    
> 
> print(fit2)

Call:
NULL

Coefficients:
(Intercept)     outcome2     outcome3   treatment2   treatment3  
   2.363486    -0.009802     0.122589     0.340056     0.340056  

> print(glmb2.D93$coef.mode)
[1]  2.363485555 -0.009797081  0.122587885  0.340049094  0.340066361
> 
> 
> 
> influence(glmb2.D93)
$hat
 [1] 0.2444410 0.3261137 0.3472719 0.3981078 0.4590068 0.4873046 0.3981108
 [8] 0.4590107 0.4873085 0.2299986 0.2972437 0.2819494 0.2920672 0.2920654

$coefficients
       (Intercept)     outcome2     outcome3    treatment2   treatment3
 [1,]  0.224411797 -0.106047652 -0.108739010 -0.1246270805 -0.124627461
 [2,]  0.116574001  0.181193322 -0.010889800 -0.1400676089 -0.140068036
 [3,]  0.054232896 -0.003922223  0.077998224 -0.0668881167 -0.066888321
 [4,]  0.086102519 -0.106686056 -0.109393616  0.1383594288 -0.010392459
 [5,]  0.005679600 -0.150887167  0.026385000 -0.1294578825  0.026875121
 [6,] -0.005584718 -0.016189238  0.092508268  0.0887561061 -0.018761790
 [7,]  0.171058886 -0.211952863 -0.217331965 -0.0206460063  0.274874462
 [8,]  0.002120262 -0.056324513  0.009849251  0.0100320421 -0.048324469
 [9,]  0.008735668  0.025322331 -0.144696084  0.0293456930 -0.138825075
[10,] -0.705971062  0.333612468  0.342079140  0.3920609940  0.392062190
[11,] -0.001516008  0.004146042  0.001396417 -0.0002514792 -0.000251480
[12,]  0.019026658 -0.017091950 -0.048135857  0.0031561892  0.003156199
[13,]  0.061355020  0.008660426  0.008880217 -0.1402945633 -0.055425896
[14,]  0.061355050  0.008660430  0.008880221 -0.0554257549 -0.140293337

$sigma
 [1] 3.0343276 3.0518910 3.1481778 3.1138402 3.1136942 3.1484196 2.9399904
 [8] 3.1627920 3.1159546 0.9924051 3.1706425 3.1665412 3.1383056 3.1383057

$wt.res
 [1]  2.26133260  1.99614294  0.86147034  1.31137191 -1.24484255  0.75939034
 [7]  2.60526193 -0.46467873 -1.18777571 -7.47400044  0.03099743 -0.38766144
[13] -1.07535074 -1.07535074

> influence(glmb2.D93,do.coef=TRUE)
$hat
 [1] 0.2444410 0.3261137 0.3472719 0.3981078 0.4590068 0.4873046 0.3981108
 [8] 0.4590107 0.4873085 0.2299986 0.2972437 0.2819494 0.2920672 0.2920654

$coefficients
       (Intercept)     outcome2     outcome3    treatment2   treatment3
 [1,]  0.224411797 -0.106047652 -0.108739010 -0.1246270805 -0.124627461
 [2,]  0.116574001  0.181193322 -0.010889800 -0.1400676089 -0.140068036
 [3,]  0.054232896 -0.003922223  0.077998224 -0.0668881167 -0.066888321
 [4,]  0.086102519 -0.106686056 -0.109393616  0.1383594288 -0.010392459
 [5,]  0.005679600 -0.150887167  0.026385000 -0.1294578825  0.026875121
 [6,] -0.005584718 -0.016189238  0.092508268  0.0887561061 -0.018761790
 [7,]  0.171058886 -0.211952863 -0.217331965 -0.0206460063  0.274874462
 [8,]  0.002120262 -0.056324513  0.009849251  0.0100320421 -0.048324469
 [9,]  0.008735668  0.025322331 -0.144696084  0.0293456930 -0.138825075
[10,] -0.705971062  0.333612468  0.342079140  0.3920609940  0.392062190
[11,] -0.001516008  0.004146042  0.001396417 -0.0002514792 -0.000251480
[12,]  0.019026658 -0.017091950 -0.048135857  0.0031561892  0.003156199
[13,]  0.061355020  0.008660426  0.008880217 -0.1402945633 -0.055425896
[14,]  0.061355050  0.008660430  0.008880221 -0.0554257549 -0.140293337

$sigma
 [1] 3.0343276 3.0518910 3.1481778 3.1138402 3.1136942 3.1484196 2.9399904
 [8] 3.1627920 3.1159546 0.9924051 3.1706425 3.1665412 3.1383056 3.1383057

$wt.res
 [1]  2.26133260  1.99614294  0.86147034  1.31137191 -1.24484255  0.75939034
 [7]  2.60526193 -0.46467873 -1.18777571 -7.47400044  0.03099743 -0.38766144
[13] -1.07535074 -1.07535074

> influence(glmb2.D93,do.coef=FALSE)
$hat
 [1] 0.2444410 0.3261137 0.3472719 0.3981078 0.4590068 0.4873046 0.3981108
 [8] 0.4590107 0.4873085 0.2299986 0.2972437 0.2819494 0.2920672 0.2920654

$<NA>
NULL

$sigma
 [1] 3.0343276 3.0518910 3.1481778 3.1138402 3.1136942 3.1484196 2.9399904
 [8] 3.1627920 3.1159546 0.9924051 3.1706425 3.1665412 3.1383056 3.1383057

$wt.res
 [1]  2.26133260  1.99614294  0.86147034  1.31137191 -1.24484255  0.75939034
 [7]  2.60526193 -0.46467873 -1.18777571 -7.47400044  0.03099743 -0.38766144
[13] -1.07535074 -1.07535074

> 
> #glmb2.D93$qr=glmb2.D93$fit$qr
> #influence.measures(glmb2.D93,influence(glmb2.D93))
> #influence.measures(glmb2.D93$fit,influence(glmb2.D93))
> #influence.measures(glmb2.D93$fit,influence(glmb2.D93,do.coef=FALSE))
> glmb.influence.measures(glmb2.D93,influence(glmb2.D93))
Influence measures of
	 NULL :

     dfb.1_ dfb.otc2 dfb.otc3  dfb.trt2  dfb.trt3    dffit    cov.r   cook.d
1   0.48766 -0.20271 -0.21342 -0.240330 -0.240332  0.48766 1.54e+00 4.90e-02
2   0.25187  0.34436 -0.02125 -0.268551 -0.268553  0.55427 1.83e+00 6.40e-02
3   0.11359 -0.00723  0.14755 -0.124322 -0.124323  0.24705 2.57e+00 1.35e-02
4   0.18233 -0.19873 -0.20922  0.259999 -0.019529  0.44148 2.50e+00 4.23e-02
5   0.01203 -0.28107  0.05047 -0.243283  0.050505 -0.50068 2.78e+00 5.44e-02
6  -0.01170 -0.02982  0.17499  0.164955 -0.034869  0.32841 3.28e+00 2.39e-02
7   0.38365 -0.41815 -0.44024 -0.041091  0.547077  0.92895 1.41e+00 1.67e-01
8   0.00442 -0.10329  0.01855  0.018560 -0.089404 -0.18399 3.25e+00 7.58e-03
9   0.01849  0.04714 -0.27655  0.055108 -0.260697 -0.51903 2.95e+00 5.85e-02
10 -4.69067  1.94983  2.05283  2.311656  2.311671 -4.69067 2.11e-05 4.85e-01
11 -0.00315  0.00758  0.00262 -0.000464 -0.000464  0.00758 2.56e+00 1.29e-05
12  0.03962 -0.03131 -0.09053  0.005832  0.005832 -0.09053 2.48e+00 1.84e-03
13  0.12891  0.01601  0.01685 -0.261580 -0.103342 -0.26158 2.30e+00 1.51e-02
14  0.12891  0.01601  0.01685 -0.103342 -0.261578 -0.26158 2.30e+00 1.51e-02
     hat inf
1  0.244    
2  0.326    
3  0.347    
4  0.398    
5  0.459   *
6  0.487   *
7  0.398    
8  0.459   *
9  0.487   *
10 0.230   *
11 0.297    
12 0.282    
13 0.292    
14 0.292    
> 
> 
> ## Do not need method functions
> dfbeta(glmb2.D93,influence(glmb2.D93))
       (Intercept)     outcome2     outcome3    treatment2   treatment3
 [1,]  0.224411797 -0.106047652 -0.108739010 -0.1246270805 -0.124627461
 [2,]  0.116574001  0.181193322 -0.010889800 -0.1400676089 -0.140068036
 [3,]  0.054232896 -0.003922223  0.077998224 -0.0668881167 -0.066888321
 [4,]  0.086102519 -0.106686056 -0.109393616  0.1383594288 -0.010392459
 [5,]  0.005679600 -0.150887167  0.026385000 -0.1294578825  0.026875121
 [6,] -0.005584718 -0.016189238  0.092508268  0.0887561061 -0.018761790
 [7,]  0.171058886 -0.211952863 -0.217331965 -0.0206460063  0.274874462
 [8,]  0.002120262 -0.056324513  0.009849251  0.0100320421 -0.048324469
 [9,]  0.008735668  0.025322331 -0.144696084  0.0293456930 -0.138825075
[10,] -0.705971062  0.333612468  0.342079140  0.3920609940  0.392062190
[11,] -0.001516008  0.004146042  0.001396417 -0.0002514792 -0.000251480
[12,]  0.019026658 -0.017091950 -0.048135857  0.0031561892  0.003156199
[13,]  0.061355020  0.008660426  0.008880217 -0.1402945633 -0.055425896
[14,]  0.061355050  0.008660430  0.008880221 -0.0554257549 -0.140293337
> dfbeta(glmb2.D93$fit,influence(glmb2.D93))
       (Intercept)     outcome2     outcome3    treatment2   treatment3
 [1,]  0.224411797 -0.106047652 -0.108739010 -0.1246270805 -0.124627461
 [2,]  0.116574001  0.181193322 -0.010889800 -0.1400676089 -0.140068036
 [3,]  0.054232896 -0.003922223  0.077998224 -0.0668881167 -0.066888321
 [4,]  0.086102519 -0.106686056 -0.109393616  0.1383594288 -0.010392459
 [5,]  0.005679600 -0.150887167  0.026385000 -0.1294578825  0.026875121
 [6,] -0.005584718 -0.016189238  0.092508268  0.0887561061 -0.018761790
 [7,]  0.171058886 -0.211952863 -0.217331965 -0.0206460063  0.274874462
 [8,]  0.002120262 -0.056324513  0.009849251  0.0100320421 -0.048324469
 [9,]  0.008735668  0.025322331 -0.144696084  0.0293456930 -0.138825075
[10,] -0.705971062  0.333612468  0.342079140  0.3920609940  0.392062190
[11,] -0.001516008  0.004146042  0.001396417 -0.0002514792 -0.000251480
[12,]  0.019026658 -0.017091950 -0.048135857  0.0031561892  0.003156199
[13,]  0.061355020  0.008660426  0.008880217 -0.1402945633 -0.055425896
[14,]  0.061355050  0.008660430  0.008880221 -0.0554257549 -0.140293337
> hatvalues(glmb2.D93,influence(glmb2.D93))
 [1] 0.2444410 0.3261137 0.3472719 0.3981078 0.4590068 0.4873046 0.3981108
 [8] 0.4590107 0.4873085 0.2299986 0.2972437 0.2819494 0.2920672 0.2920654
> hatvalues(glmb2.D93$fit,influence(glmb2.D93))
 [1] 0.2444410 0.3261137 0.3472719 0.3981078 0.4590068 0.4873046 0.3981108
 [8] 0.4590107 0.4873085 0.2299986 0.2972437 0.2819494 0.2920672 0.2920654
> 
> # Methods (implmented)
> 
> rstandard(glmb2.D93,infl=influence(glmb2.D93))
 [1]  0.8702731  0.8134364  0.3566970  0.5654469 -0.5661660  0.3547813
 [7]  1.1233586 -0.2113410 -0.5549216 -2.8492639  0.0123694 -0.1530384
[13] -0.4275426 -0.4275421
> rstandard(glmb2.D93)
 [1]  0.8702731  0.8134364  0.3566970  0.5654469 -0.5661660  0.3547813
 [7]  1.1233586 -0.2113410 -0.5549216 -2.8492639  0.0123694 -0.1530384
[13] -0.4275426 -0.4275421
> 
> 
> # Need Metods
> 
> ## Needs a method function
> #dfbetas(glmb2.D93,influence(glmb2.D93))
> dfbetas(glmb2.D93)
       (Intercept)     outcome2     outcome3    treatment2    treatment3
 [1,]  0.487663863 -0.202713301 -0.213421085 -0.2403303236 -0.2403318006
 [2,]  0.251866292  0.344363277 -0.021250312 -0.2685513379 -0.2685529883
 [3,]  0.113590211 -0.007226311  0.147550227 -0.1243221005 -0.1243228645
 [4,]  0.182329482 -0.198726141 -0.209223314  0.2599986322 -0.0195290885
 [5,]  0.012027606 -0.281073566  0.050465613 -0.2432826631  0.0505050064
 [6,] -0.011696234 -0.029824794  0.174985621  0.1649545337 -0.0348691713
 [7,]  0.383651673 -0.418154757 -0.440242655 -0.0410911950  0.5470769954
 [8,]  0.004420345 -0.103292902  0.018545861  0.0185599731 -0.0894038938
 [9,]  0.018485975  0.047136380 -0.276554087  0.0551076484 -0.2606974420
[10,] -4.690674224  1.949830875  2.052825436  2.3116563291  2.3116705356
[11,] -0.003152766  0.007584554  0.002622903 -0.0004641021 -0.0004641049
[12,]  0.039620024 -0.031307625 -0.090531139  0.0058322551  0.0058322910
[13,]  0.128911668  0.016006179  0.016851663 -0.2615798167 -0.1033421421
[14,]  0.128911729  0.016006187  0.016851671 -0.1033415557 -0.2615783324
> dfbetas(glmb2.D93,influence(glmb2.D93,do.coef=TRUE))
       (Intercept)     outcome2     outcome3    treatment2    treatment3
 [1,]  0.487663863 -0.202713301 -0.213421085 -0.2403303236 -0.2403318006
 [2,]  0.251866292  0.344363277 -0.021250312 -0.2685513379 -0.2685529883
 [3,]  0.113590211 -0.007226311  0.147550227 -0.1243221005 -0.1243228645
 [4,]  0.182329482 -0.198726141 -0.209223314  0.2599986322 -0.0195290885
 [5,]  0.012027606 -0.281073566  0.050465613 -0.2432826631  0.0505050064
 [6,] -0.011696234 -0.029824794  0.174985621  0.1649545337 -0.0348691713
 [7,]  0.383651673 -0.418154757 -0.440242655 -0.0410911950  0.5470769954
 [8,]  0.004420345 -0.103292902  0.018545861  0.0185599731 -0.0894038938
 [9,]  0.018485975  0.047136380 -0.276554087  0.0551076484 -0.2606974420
[10,] -4.690674224  1.949830875  2.052825436  2.3116563291  2.3116705356
[11,] -0.003152766  0.007584554  0.002622903 -0.0004641021 -0.0004641049
[12,]  0.039620024 -0.031307625 -0.090531139  0.0058322551  0.0058322910
[13,]  0.128911668  0.016006179  0.016851663 -0.2615798167 -0.1033421421
[14,]  0.128911729  0.016006187  0.016851671 -0.1033415557 -0.2615783324
> dfbetas(glmb2.D93$fit,influence(glmb2.D93))
       (Intercept)     outcome2     outcome3    treatment2    treatment3
 [1,]  0.487663863 -0.202713301 -0.213421085 -0.2403303236 -0.2403318006
 [2,]  0.251866292  0.344363277 -0.021250312 -0.2685513379 -0.2685529883
 [3,]  0.113590211 -0.007226311  0.147550227 -0.1243221005 -0.1243228645
 [4,]  0.182329482 -0.198726141 -0.209223314  0.2599986322 -0.0195290885
 [5,]  0.012027606 -0.281073566  0.050465613 -0.2432826631  0.0505050064
 [6,] -0.011696234 -0.029824794  0.174985621  0.1649545337 -0.0348691713
 [7,]  0.383651673 -0.418154757 -0.440242655 -0.0410911950  0.5470769954
 [8,]  0.004420345 -0.103292902  0.018545861  0.0185599731 -0.0894038938
 [9,]  0.018485975  0.047136380 -0.276554087  0.0551076484 -0.2606974420
[10,] -4.690674224  1.949830875  2.052825436  2.3116563291  2.3116705356
[11,] -0.003152766  0.007584554  0.002622903 -0.0004641021 -0.0004641049
[12,]  0.039620024 -0.031307625 -0.090531139  0.0058322551  0.0058322910
[13,]  0.128911668  0.016006179  0.016851663 -0.2615798167 -0.1033421421
[14,]  0.128911729  0.016006187  0.016851671 -0.1033415557 -0.2615783324
> 
> 
> 
> 
> # Needs a method function
> cooks.distance(glmb2.D93)
 [1] 4.900571e-02 6.404122e-02 1.353837e-02 4.229564e-02 5.439324e-02
 [6] 2.392723e-02 1.669376e-01 7.579345e-03 5.853844e-02 4.849859e-01
[11] 1.294301e-05 1.839276e-03 1.508271e-02 1.508254e-02
> cooks.distance(glmb2.D93$fit,influence(glmb2.D93))
 [1] 4.900571e-02 6.404122e-02 1.353837e-02 4.229564e-02 5.439324e-02
 [6] 2.392723e-02 1.669376e-01 7.579345e-03 5.853844e-02 4.849859e-01
[11] 1.294301e-05 1.839276e-03 1.508271e-02 1.508254e-02
> 
> 
> 
> # Needs a method function (now works)
> #rstandard(glmb2.D93$fit,influence(glmb2.D93))
> 
> 
> # Needs a method function
> rstudent(glmb2.D93)
 [1]  0.85736899  0.79676325  0.33869979  0.54283794 -0.54355382  0.33685481
 [7]  1.14221329 -0.19975048 -0.53237206 -8.58259030  0.01166208 -0.14447408
[13] -0.40724792 -0.40724739
> rstudent(glmb2.D93$fit,influence(glmb2.D93))
 [1]  0.85736899  0.79676325  0.33869979  0.54283794 -0.54355382  0.33685481
 [7]  1.14221329 -0.19975048 -0.53237206 -8.58259030  0.01166208 -0.14447408
[13] -0.40724792 -0.40724739
> 
> 
> # Not a method, separate function
> glmb.dffits(glmb2.D93)
 [1]  0.487663863  0.554268853  0.247049279  0.441480129 -0.500675335
 [6]  0.328407686  0.928946937 -0.183994536 -0.519026058 -4.690674224
[11]  0.007584554 -0.090531139 -0.261579817 -0.261578332
> dffits(glmb2.D93$fit,influence(glmb2.D93)) 
 [1]  0.487663863  0.554268853  0.247049279  0.441480129 -0.500675335
 [6]  0.328407686  0.928946937 -0.183994536 -0.519026058 -4.690674224
[11]  0.007584554 -0.090531139 -0.261579817 -0.261578332
> 
> # Not a method - separate function
> glmb.covratio(glmb2.D93)  
 [1] 1.536772e+00 1.825394e+00 2.571066e+00 2.498604e+00 2.778566e+00
 [6] 3.275817e+00 1.406681e+00 3.249156e+00 2.953303e+00 2.111793e-05
[11] 2.564017e+00 2.477133e+00 2.297277e+00 2.297271e+00
> covratio(glmb2.D93$fit,influence(glmb2.D93))  
 [1] 1.536772e+00 1.825394e+00 2.571066e+00 2.498604e+00 2.778566e+00
 [6] 3.275817e+00 1.406681e+00 3.249156e+00 2.953303e+00 2.111793e-05
[11] 2.564017e+00 2.477133e+00 2.297277e+00 2.297271e+00
> 
> 
> 
> # Needs a method function but requires a different approach
> # The influence function actually stores this measure
> ## This seems to require more work to create a method function
> ## Should 
> #hat(glmb2.D93,influence(glmb2.D93))
> #hat(glmb2.D93$fit,influence(glmb2.D93))
> 
> infl=influence(glmb2.D93)
> hat2=infl$hat               
> hat2               
 [1] 0.2444410 0.3261137 0.3472719 0.3981078 0.4590068 0.4873046 0.3981108
 [8] 0.4590107 0.4873085 0.2299986 0.2972437 0.2819494 0.2920672 0.2920654
> 
> 
> 
> cleanEx()
> nameEx("lmb")
> ### * lmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: lmb
> ### Title: Fitting Bayesian Linear Models
> ### Aliases: lmb print.lmb
> 
> ### ** Examples
> 
> ## Annette Dobson (1990) "An Introduction to Generalized Linear Models".
> ## Page 9: Plant Weight Data.
> ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
> trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
> group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
> weight <- c(ctl, trt)
> 
> ps=Prior_Setup(weight ~ group)
[1] "Variable names are:"
[1] "(Intercept)" "groupTrt"   
> mu=ps$mu
> V=ps$Sigma
> mu[1,1]=mean(weight)
> 
> Prior_Check(weight ~ group,family =gaussian(),
+            pfamily=dNormal(mu=mu,Sigma=V))
[1] "Variables in the Model Are:"
[1] "(Intercept)" "groupTrt"   
[1] "The maximum likelihood estimates for all coefficients appear to be roughly consistent with the prior."
             abs_ratio
(Intercept) 0.09242285
groupTrt    0.17198871
> 
> lm.D9 <- lm(weight ~ group,x=TRUE,y=TRUE)
> disp_ML=sigma(lm.D9)^2
> n_prior=2
> shape=n_prior/2
> rate= disp_ML*shape
> 
> # Conjugate Normal_Gamma Prior 
> lmb.D9=lmb(weight ~ group,dNormal_Gamma(mu,V/disp_ML,shape=shape,rate=rate))
> summary(lmb.D9)
Call
lmb(formula = weight ~ group, pfamily = dNormal_Gamma(mu, V/disp_ML, 
    shape = shape, rate = rate))

Expected Deviance Residuals:
        1         2         3         4         5         6         7         8 
-0.837811  0.572189  0.172189  1.102189 -0.507811 -0.397811  0.162189 -0.477811 
        9        10        11        12        13        14        15        16 
 0.322189  0.132189  0.126903 -0.513097 -0.273097 -1.093097  1.186903 -0.853097 
       17        18        19        20 
 1.346903  0.206903 -0.363097  0.006903 

Prior and Maximum Likelihood Estimates with Standard Deviations

            Prior Mean Prior.sd Max Like. Like.sd
(Intercept)      4.846    1.436     5.032   0.220
groupTrt         0.000    1.436    -0.371   0.311

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean Post.Sd MC Error Pr(tail)
(Intercept)    5.0081    5.0078  0.2110        0    0.218
groupTrt      -0.3311   -0.3247  0.2868        0    0.119

Distribution Percentiles

               1.0%    2.5%    5.0%  Median   95.0%   97.5% 99.0%
(Intercept)  4.5315  4.5952  4.6548  5.0063  5.3358  5.4354 5.530
groupTrt    -0.9929 -0.9164 -0.7829 -0.3232  0.1468  0.2673 0.388

Effective Number of Parameters: 2.617534 
Expected Residual Deviance: 21.24484 
DIC: 45.58812 

Expected Mean dispersion: 0.4956164 
Sq.root of Expected Mean dispersion: 0.7040003 

Mean Likelihood Subgradient Candidates Per iid sample: 1 

> 
> # Independent_Normal_Gamma_Prior
> lmb.D9_v2=lmb(weight ~ group,dIndependent_Normal_Gamma(mu,V,shape=shape,rate=rate))
Starting Simulation:
                                                                 0.000% [                                        ]                                                                 0.100% [                                        ]                                                                 0.200% [                                        ]                                                                 0.300% [                                        ]                                                                 0.400% [                                        ]                                                                 0.501% [                                        ]                                                                 0.601% [                                        ]                                                                 0.701% [                                        ]                                                                 0.801% [                                        ]                                                                 0.901% [                                        ]                                                                 1.001% [                                        ]                                                                 1.101% [                                        ]                                                                 1.201% [                                        ]                                                                 1.301% [=                                       ]                                                                 1.401% [=                                       ]                                                                 1.502% [=                                       ]                                                                 1.602% [=                                       ]                                                                 1.702% [=                                       ]                                                                 1.802% [=                                       ]                                                                 1.902% [=                                       ]                                                                 2.002% [=                                       ]                                                                 2.102% [=                                       ]                                                                 2.202% [=                                       ]                                                                 2.302% [=                                       ]                                                                 2.402% [=                                       ]                                                                 2.503% [=                                       ]                                                                 2.603% [=                                       ]                                                                 2.703% [=                                       ]                                                                 2.803% [=                                       ]                                                                 2.903% [=                                       ]                                                                 3.003% [=                                       ]                                                                 3.103% [=                                       ]                                                                 3.203% [=                                       ]                                                                 3.303% [=                                       ]                                                                 3.403% [=                                       ]                                                                 3.504% [=                                       ]                                                                 3.604% [=                                       ]                                                                 3.704% [=                                       ]                                                                 3.804% [==                                      ]                                                                 3.904% [==                                      ]                                                                 4.004% [==                                      ]                                                                 4.104% [==                                      ]                                                                 4.204% [==                                      ]                                                                 4.304% [==                                      ]                                                                 4.404% [==                                      ]                                                                 4.505% [==                                      ]                                                                 4.605% [==                                      ]                                                                 4.705% [==                                      ]                                                                 4.805% [==                                      ]                                                                 4.905% [==                                      ]                                                                 5.005% [==                                      ]                                                                 5.105% [==                                      ]                                                                 5.205% [==                                      ]                                                                 5.305% [==                                      ]                                                                 5.405% [==                                      ]                                                                 5.506% [==                                      ]                                                                 5.606% [==                                      ]                                                                 5.706% [==                                      ]                                                                 5.806% [==                                      ]                                                                 5.906% [==                                      ]                                                                 6.006% [==                                      ]                                                                 6.106% [==                                      ]                                                                 6.206% [==                                      ]                                                                 6.306% [===                                     ]                                                                 6.406% [===                                     ]                                                                 6.507% [===                                     ]                                                                 6.607% [===                                     ]                                                                 6.707% [===                                     ]                                                                 6.807% [===                                     ]                                                                 6.907% [===                                     ]                                                                 7.007% [===                                     ]                                                                 7.107% [===                                     ]                                                                 7.207% [===                                     ]                                                                 7.307% [===                                     ]                                                                 7.407% [===                                     ]                                                                 7.508% [===                                     ]                                                                 7.608% [===                                     ]                                                                 7.708% [===                                     ]                                                                 7.808% [===                                     ]                                                                 7.908% [===                                     ]                                                                 8.008% [===                                     ]                                                                 8.108% [===                                     ]                                                                 8.208% [===                                     ]                                                                 8.308% [===                                     ]                                                                 8.408% [===                                     ]                                                                 8.509% [===                                     ]                                                                 8.609% [===                                     ]                                                                 8.709% [===                                     ]                                                                 8.809% [====                                    ]                                                                 8.909% [====                                    ]                                                                 9.009% [====                                    ]                                                                 9.109% [====                                    ]                                                                 9.209% [====                                    ]                                                                 9.309% [====                                    ]                                                                 9.409% [====                                    ]                                                                 9.510% [====                                    ]                                                                 9.610% [====                                    ]                                                                 9.710% [====                                    ]                                                                 9.810% [====                                    ]                                                                 9.910% [====                                    ]                                                                 10.010% [====                                    ]                                                                 10.110% [====                                    ]                                                                 10.210% [====                                    ]                                                                 10.310% [====                                    ]                                                                 10.410% [====                                    ]                                                                 10.511% [====                                    ]                                                                 10.611% [====                                    ]                                                                 10.711% [====                                    ]                                                                 10.811% [====                                    ]                                                                 10.911% [====                                    ]                                                                 11.011% [====                                    ]                                                                 11.111% [====                                    ]                                                                 11.211% [====                                    ]                                                                 11.311% [=====                                   ]                                                                 11.411% [=====                                   ]                                                                 11.512% [=====                                   ]                                                                 11.612% [=====                                   ]                                                                 11.712% [=====                                   ]                                                                 11.812% [=====                                   ]                                                                 11.912% [=====                                   ]                                                                 12.012% [=====                                   ]                                                                 12.112% [=====                                   ]                                                                 12.212% [=====                                   ]                                                                 12.312% [=====                                   ]                                                                 12.412% [=====                                   ]                                                                 12.513% [=====                                   ]                                                                 12.613% [=====                                   ]                                                                 12.713% [=====                                   ]                                                                 12.813% [=====                                   ]                                                                 12.913% [=====                                   ]                                                                 13.013% [=====                                   ]                                                                 13.113% [=====                                   ]                                                                 13.213% [=====                                   ]                                                                 13.313% [=====                                   ]                                                                 13.413% [=====                                   ]                                                                 13.514% [=====                                   ]                                                                 13.614% [=====                                   ]                                                                 13.714% [=====                                   ]                                                                 13.814% [======                                  ]                                                                 13.914% [======                                  ]                                                                 14.014% [======                                  ]                                                                 14.114% [======                                  ]                                                                 14.214% [======                                  ]                                                                 14.314% [======                                  ]                                                                 14.414% [======                                  ]                                                                 14.515% [======                                  ]                                                                 14.615% [======                                  ]                                                                 14.715% [======                                  ]                                                                 14.815% [======                                  ]                                                                 14.915% [======                                  ]                                                                 15.015% [======                                  ]                                                                 15.115% [======                                  ]                                                                 15.215% [======                                  ]                                                                 15.315% [======                                  ]                                                                 15.415% [======                                  ]                                                                 15.516% [======                                  ]                                                                 15.616% [======                                  ]                                                                 15.716% [======                                  ]                                                                 15.816% [======                                  ]                                                                 15.916% [======                                  ]                                                                 16.016% [======                                  ]                                                                 16.116% [======                                  ]                                                                 16.216% [======                                  ]                                                                 16.316% [=======                                 ]                                                                 16.416% [=======                                 ]                                                                 16.517% [=======                                 ]                                                                 16.617% [=======                                 ]                                                                 16.717% [=======                                 ]                                                                 16.817% [=======                                 ]                                                                 16.917% [=======                                 ]                                                                 17.017% [=======                                 ]                                                                 17.117% [=======                                 ]                                                                 17.217% [=======                                 ]                                                                 17.317% [=======                                 ]                                                                 17.417% [=======                                 ]                                                                 17.518% [=======                                 ]                                                                 17.618% [=======                                 ]                                                                 17.718% [=======                                 ]                                                                 17.818% [=======                                 ]                                                                 17.918% [=======                                 ]                                                                 18.018% [=======                                 ]                                                                 18.118% [=======                                 ]                                                                 18.218% [=======                                 ]                                                                 18.318% [=======                                 ]                                                                 18.418% [=======                                 ]                                                                 18.519% [=======                                 ]                                                                 18.619% [=======                                 ]                                                                 18.719% [=======                                 ]                                                                 18.819% [========                                ]                                                                 18.919% [========                                ]                                                                 19.019% [========                                ]                                                                 19.119% [========                                ]                                                                 19.219% [========                                ]                                                                 19.319% [========                                ]                                                                 19.419% [========                                ]                                                                 19.520% [========                                ]                                                                 19.620% [========                                ]                                                                 19.720% [========                                ]                                                                 19.820% [========                                ]                                                                 19.920% [========                                ]                                                                 20.020% [========                                ]                                                                 20.120% [========                                ]                                                                 20.220% [========                                ]                                                                 20.320% [========                                ]                                                                 20.420% [========                                ]                                                                 20.521% [========                                ]                                                                 20.621% [========                                ]                                                                 20.721% [========                                ]                                                                 20.821% [========                                ]                                                                 20.921% [========                                ]                                                                 21.021% [========                                ]                                                                 21.121% [========                                ]                                                                 21.221% [========                                ]                                                                 21.321% [=========                               ]                                                                 21.421% [=========                               ]                                                                 21.522% [=========                               ]                                                                 21.622% [=========                               ]                                                                 21.722% [=========                               ]                                                                 21.822% [=========                               ]                                                                 21.922% [=========                               ]                                                                 22.022% [=========                               ]                                                                 22.122% [=========                               ]                                                                 22.222% [=========                               ]                                                                 22.322% [=========                               ]                                                                 22.422% [=========                               ]                                                                 22.523% [=========                               ]                                                                 22.623% [=========                               ]                                                                 22.723% [=========                               ]                                                                 22.823% [=========                               ]                                                                 22.923% [=========                               ]                                                                 23.023% [=========                               ]                                                                 23.123% [=========                               ]                                                                 23.223% [=========                               ]                                                                 23.323% [=========                               ]                                                                 23.423% [=========                               ]                                                                 23.524% [=========                               ]                                                                 23.624% [=========                               ]                                                                 23.724% [=========                               ]                                                                 23.824% [==========                              ]                                                                 23.924% [==========                              ]                                                                 24.024% [==========                              ]                                                                 24.124% [==========                              ]                                                                 24.224% [==========                              ]                                                                 24.324% [==========                              ]                                                                 24.424% [==========                              ]                                                                 24.525% [==========                              ]                                                                 24.625% [==========                              ]                                                                 24.725% [==========                              ]                                                                 24.825% [==========                              ]                                                                 24.925% [==========                              ]                                                                 25.025% [==========                              ]                                                                 25.125% [==========                              ]                                                                 25.225% [==========                              ]                                                                 25.325% [==========                              ]                                                                 25.425% [==========                              ]                                                                 25.526% [==========                              ]                                                                 25.626% [==========                              ]                                                                 25.726% [==========                              ]                                                                 25.826% [==========                              ]                                                                 25.926% [==========                              ]                                                                 26.026% [==========                              ]                                                                 26.126% [==========                              ]                                                                 26.226% [==========                              ]                                                                 26.326% [===========                             ]                                                                 26.426% [===========                             ]                                                                 26.527% [===========                             ]                                                                 26.627% [===========                             ]                                                                 26.727% [===========                             ]                                                                 26.827% [===========                             ]                                                                 26.927% [===========                             ]                                                                 27.027% [===========                             ]                                                                 27.127% [===========                             ]                                                                 27.227% [===========                             ]                                                                 27.327% [===========                             ]                                                                 27.427% [===========                             ]                                                                 27.528% [===========                             ]                                                                 27.628% [===========                             ]                                                                 27.728% [===========                             ]                                                                 27.828% [===========                             ]                                                                 27.928% [===========                             ]                                                                 28.028% [===========                             ]                                                                 28.128% [===========                             ]                                                                 28.228% [===========                             ]                                                                 28.328% [===========                             ]                                                                 28.428% [===========                             ]                                                                 28.529% [===========                             ]                                                                 28.629% [===========                             ]                                                                 28.729% [===========                             ]                                                                 28.829% [============                            ]                                                                 28.929% [============                            ]                                                                 29.029% [============                            ]                                                                 29.129% [============                            ]                                                                 29.229% [============                            ]                                                                 29.329% [============                            ]                                                                 29.429% [============                            ]                                                                 29.530% [============                            ]                                                                 29.630% [============                            ]                                                                 29.730% [============                            ]                                                                 29.830% [============                            ]                                                                 29.930% [============                            ]                                                                 30.030% [============                            ]                                                                 30.130% [============                            ]                                                                 30.230% [============                            ]                                                                 30.330% [============                            ]                                                                 30.430% [============                            ]                                                                 30.531% [============                            ]                                                                 30.631% [============                            ]                                                                 30.731% [============                            ]                                                                 30.831% [============                            ]                                                                 30.931% [============                            ]                                                                 31.031% [============                            ]                                                                 31.131% [============                            ]                                                                 31.231% [============                            ]                                                                 31.331% [=============                           ]                                                                 31.431% [=============                           ]                                                                 31.532% [=============                           ]                                                                 31.632% [=============                           ]                                                                 31.732% [=============                           ]                                                                 31.832% [=============                           ]                                                                 31.932% [=============                           ]                                                                 32.032% [=============                           ]                                                                 32.132% [=============                           ]                                                                 32.232% [=============                           ]                                                                 32.332% [=============                           ]                                                                 32.432% [=============                           ]                                                                 32.533% [=============                           ]                                                                 32.633% [=============                           ]                                                                 32.733% [=============                           ]                                                                 32.833% [=============                           ]                                                                 32.933% [=============                           ]                                                                 33.033% [=============                           ]                                                                 33.133% [=============                           ]                                                                 33.233% [=============                           ]                                                                 33.333% [=============                           ]                                                                 33.433% [=============                           ]                                                                 33.534% [=============                           ]                                                                 33.634% [=============                           ]                                                                 33.734% [=============                           ]                                                                 33.834% [==============                          ]                                                                 33.934% [==============                          ]                                                                 34.034% [==============                          ]                                                                 34.134% [==============                          ]                                                                 34.234% [==============                          ]                                                                 34.334% [==============                          ]                                                                 34.434% [==============                          ]                                                                 34.535% [==============                          ]                                                                 34.635% [==============                          ]                                                                 34.735% [==============                          ]                                                                 34.835% [==============                          ]                                                                 34.935% [==============                          ]                                                                 35.035% [==============                          ]                                                                 35.135% [==============                          ]                                                                 35.235% [==============                          ]                                                                 35.335% [==============                          ]                                                                 35.435% [==============                          ]                                                                 35.536% [==============                          ]                                                                 35.636% [==============                          ]                                                                 35.736% [==============                          ]                                                                 35.836% [==============                          ]                                                                 35.936% [==============                          ]                                                                 36.036% [==============                          ]                                                                 36.136% [==============                          ]                                                                 36.236% [==============                          ]                                                                 36.336% [===============                         ]                                                                 36.436% [===============                         ]                                                                 36.537% [===============                         ]                                                                 36.637% [===============                         ]                                                                 36.737% [===============                         ]                                                                 36.837% [===============                         ]                                                                 36.937% [===============                         ]                                                                 37.037% [===============                         ]                                                                 37.137% [===============                         ]                                                                 37.237% [===============                         ]                                                                 37.337% [===============                         ]                                                                 37.437% [===============                         ]                                                                 37.538% [===============                         ]                                                                 37.638% [===============                         ]                                                                 37.738% [===============                         ]                                                                 37.838% [===============                         ]                                                                 37.938% [===============                         ]                                                                 38.038% [===============                         ]                                                                 38.138% [===============                         ]                                                                 38.238% [===============                         ]                                                                 38.338% [===============                         ]                                                                 38.438% [===============                         ]                                                                 38.539% [===============                         ]                                                                 38.639% [===============                         ]                                                                 38.739% [===============                         ]                                                                 38.839% [================                        ]                                                                 38.939% [================                        ]                                                                 39.039% [================                        ]                                                                 39.139% [================                        ]                                                                 39.239% [================                        ]                                                                 39.339% [================                        ]                                                                 39.439% [================                        ]                                                                 39.540% [================                        ]                                                                 39.640% [================                        ]                                                                 39.740% [================                        ]                                                                 39.840% [================                        ]                                                                 39.940% [================                        ]                                                                 40.040% [================                        ]                                                                 40.140% [================                        ]                                                                 40.240% [================                        ]                                                                 40.340% [================                        ]                                                                 40.440% [================                        ]                                                                 40.541% [================                        ]                                                                 40.641% [================                        ]                                                                 40.741% [================                        ]                                                                 40.841% [================                        ]                                                                 40.941% [================                        ]                                                                 41.041% [================                        ]                                                                 41.141% [================                        ]                                                                 41.241% [================                        ]                                                                 41.341% [=================                       ]                                                                 41.441% [=================                       ]                                                                 41.542% [=================                       ]                                                                 41.642% [=================                       ]                                                                 41.742% [=================                       ]                                                                 41.842% [=================                       ]                                                                 41.942% [=================                       ]                                                                 42.042% [=================                       ]                                                                 42.142% [=================                       ]                                                                 42.242% [=================                       ]                                                                 42.342% [=================                       ]                                                                 42.442% [=================                       ]                                                                 42.543% [=================                       ]                                                                 42.643% [=================                       ]                                                                 42.743% [=================                       ]                                                                 42.843% [=================                       ]                                                                 42.943% [=================                       ]                                                                 43.043% [=================                       ]                                                                 43.143% [=================                       ]                                                                 43.243% [=================                       ]                                                                 43.343% [=================                       ]                                                                 43.443% [=================                       ]                                                                 43.544% [=================                       ]                                                                 43.644% [=================                       ]                                                                 43.744% [=================                       ]                                                                 43.844% [==================                      ]                                                                 43.944% [==================                      ]                                                                 44.044% [==================                      ]                                                                 44.144% [==================                      ]                                                                 44.244% [==================                      ]                                                                 44.344% [==================                      ]                                                                 44.444% [==================                      ]                                                                 44.545% [==================                      ]                                                                 44.645% [==================                      ]                                                                 44.745% [==================                      ]                                                                 44.845% [==================                      ]                                                                 44.945% [==================                      ]                                                                 45.045% [==================                      ]                                                                 45.145% [==================                      ]                                                                 45.245% [==================                      ]                                                                 45.345% [==================                      ]                                                                 45.445% [==================                      ]                                                                 45.546% [==================                      ]                                                                 45.646% [==================                      ]                                                                 45.746% [==================                      ]                                                                 45.846% [==================                      ]                                                                 45.946% [==================                      ]                                                                 46.046% [==================                      ]                                                                 46.146% [==================                      ]                                                                 46.246% [==================                      ]                                                                 46.346% [===================                     ]                                                                 46.446% [===================                     ]                                                                 46.547% [===================                     ]                                                                 46.647% [===================                     ]                                                                 46.747% [===================                     ]                                                                 46.847% [===================                     ]                                                                 46.947% [===================                     ]                                                                 47.047% [===================                     ]                                                                 47.147% [===================                     ]                                                                 47.247% [===================                     ]                                                                 47.347% [===================                     ]                                                                 47.447% [===================                     ]                                                                 47.548% [===================                     ]                                                                 47.648% [===================                     ]                                                                 47.748% [===================                     ]                                                                 47.848% [===================                     ]                                                                 47.948% [===================                     ]                                                                 48.048% [===================                     ]                                                                 48.148% [===================                     ]                                                                 48.248% [===================                     ]                                                                 48.348% [===================                     ]                                                                 48.448% [===================                     ]                                                                 48.549% [===================                     ]                                                                 48.649% [===================                     ]                                                                 48.749% [===================                     ]                                                                 48.849% [====================                    ]                                                                 48.949% [====================                    ]                                                                 49.049% [====================                    ]                                                                 49.149% [====================                    ]                                                                 49.249% [====================                    ]                                                                 49.349% [====================                    ]                                                                 49.449% [====================                    ]                                                                 49.550% [====================                    ]                                                                 49.650% [====================                    ]                                                                 49.750% [====================                    ]                                                                 49.850% [====================                    ]                                                                 49.950% [====================                    ]                                                                 50.050% [====================                    ]                                                                 50.150% [====================                    ]                                                                 50.250% [====================                    ]                                                                 50.350% [====================                    ]                                                                 50.450% [====================                    ]                                                                 50.551% [====================                    ]                                                                 50.651% [====================                    ]                                                                 50.751% [====================                    ]                                                                 50.851% [====================                    ]                                                                 50.951% [====================                    ]                                                                 51.051% [====================                    ]                                                                 51.151% [====================                    ]                                                                 51.251% [=====================                   ]                                                                 51.351% [=====================                   ]                                                                 51.451% [=====================                   ]                                                                 51.552% [=====================                   ]                                                                 51.652% [=====================                   ]                                                                 51.752% [=====================                   ]                                                                 51.852% [=====================                   ]                                                                 51.952% [=====================                   ]                                                                 52.052% [=====================                   ]                                                                 52.152% [=====================                   ]                                                                 52.252% [=====================                   ]                                                                 52.352% [=====================                   ]                                                                 52.452% [=====================                   ]                                                                 52.553% [=====================                   ]                                                                 52.653% [=====================                   ]                                                                 52.753% [=====================                   ]                                                                 52.853% [=====================                   ]                                                                 52.953% [=====================                   ]                                                                 53.053% [=====================                   ]                                                                 53.153% [=====================                   ]                                                                 53.253% [=====================                   ]                                                                 53.353% [=====================                   ]                                                                 53.453% [=====================                   ]                                                                 53.554% [=====================                   ]                                                                 53.654% [=====================                   ]                                                                 53.754% [======================                  ]                                                                 53.854% [======================                  ]                                                                 53.954% [======================                  ]                                                                 54.054% [======================                  ]                                                                 54.154% [======================                  ]                                                                 54.254% [======================                  ]                                                                 54.354% [======================                  ]                                                                 54.454% [======================                  ]                                                                 54.555% [======================                  ]                                                                 54.655% [======================                  ]                                                                 54.755% [======================                  ]                                                                 54.855% [======================                  ]                                                                 54.955% [======================                  ]                                                                 55.055% [======================                  ]                                                                 55.155% [======================                  ]                                                                 55.255% [======================                  ]                                                                 55.355% [======================                  ]                                                                 55.455% [======================                  ]                                                                 55.556% [======================                  ]                                                                 55.656% [======================                  ]                                                                 55.756% [======================                  ]                                                                 55.856% [======================                  ]                                                                 55.956% [======================                  ]                                                                 56.056% [======================                  ]                                                                 56.156% [======================                  ]                                                                 56.256% [=======================                 ]                                                                 56.356% [=======================                 ]                                                                 56.456% [=======================                 ]                                                                 56.557% [=======================                 ]                                                                 56.657% [=======================                 ]                                                                 56.757% [=======================                 ]                                                                 56.857% [=======================                 ]                                                                 56.957% [=======================                 ]                                                                 57.057% [=======================                 ]                                                                 57.157% [=======================                 ]                                                                 57.257% [=======================                 ]                                                                 57.357% [=======================                 ]                                                                 57.457% [=======================                 ]                                                                 57.558% [=======================                 ]                                                                 57.658% [=======================                 ]                                                                 57.758% [=======================                 ]                                                                 57.858% [=======================                 ]                                                                 57.958% [=======================                 ]                                                                 58.058% [=======================                 ]                                                                 58.158% [=======================                 ]                                                                 58.258% [=======================                 ]                                                                 58.358% [=======================                 ]                                                                 58.458% [=======================                 ]                                                                 58.559% [=======================                 ]                                                                 58.659% [=======================                 ]                                                                 58.759% [========================                ]                                                                 58.859% [========================                ]                                                                 58.959% [========================                ]                                                                 59.059% [========================                ]                                                                 59.159% [========================                ]                                                                 59.259% [========================                ]                                                                 59.359% [========================                ]                                                                 59.459% [========================                ]                                                                 59.560% [========================                ]                                                                 59.660% [========================                ]                                                                 59.760% [========================                ]                                                                 59.860% [========================                ]                                                                 59.960% [========================                ]                                                                 60.060% [========================                ]                                                                 60.160% [========================                ]                                                                 60.260% [========================                ]                                                                 60.360% [========================                ]                                                                 60.460% [========================                ]                                                                 60.561% [========================                ]                                                                 60.661% [========================                ]                                                                 60.761% [========================                ]                                                                 60.861% [========================                ]                                                                 60.961% [========================                ]                                                                 61.061% [========================                ]                                                                 61.161% [========================                ]                                                                 61.261% [=========================               ]                                                                 61.361% [=========================               ]                                                                 61.461% [=========================               ]                                                                 61.562% [=========================               ]                                                                 61.662% [=========================               ]                                                                 61.762% [=========================               ]                                                                 61.862% [=========================               ]                                                                 61.962% [=========================               ]                                                                 62.062% [=========================               ]                                                                 62.162% [=========================               ]                                                                 62.262% [=========================               ]                                                                 62.362% [=========================               ]                                                                 62.462% [=========================               ]                                                                 62.563% [=========================               ]                                                                 62.663% [=========================               ]                                                                 62.763% [=========================               ]                                                                 62.863% [=========================               ]                                                                 62.963% [=========================               ]                                                                 63.063% [=========================               ]                                                                 63.163% [=========================               ]                                                                 63.263% [=========================               ]                                                                 63.363% [=========================               ]                                                                 63.463% [=========================               ]                                                                 63.564% [=========================               ]                                                                 63.664% [=========================               ]                                                                 63.764% [==========================              ]                                                                 63.864% [==========================              ]                                                                 63.964% [==========================              ]                                                                 64.064% [==========================              ]                                                                 64.164% [==========================              ]                                                                 64.264% [==========================              ]                                                                 64.364% [==========================              ]                                                                 64.464% [==========================              ]                                                                 64.565% [==========================              ]                                                                 64.665% [==========================              ]                                                                 64.765% [==========================              ]                                                                 64.865% [==========================              ]                                                                 64.965% [==========================              ]                                                                 65.065% [==========================              ]                                                                 65.165% [==========================              ]                                                                 65.265% [==========================              ]                                                                 65.365% [==========================              ]                                                                 65.465% [==========================              ]                                                                 65.566% [==========================              ]                                                                 65.666% [==========================              ]                                                                 65.766% [==========================              ]                                                                 65.866% [==========================              ]                                                                 65.966% [==========================              ]                                                                 66.066% [==========================              ]                                                                 66.166% [==========================              ]                                                                 66.266% [===========================             ]                                                                 66.366% [===========================             ]                                                                 66.466% [===========================             ]                                                                 66.567% [===========================             ]                                                                 66.667% [===========================             ]                                                                 66.767% [===========================             ]                                                                 66.867% [===========================             ]                                                                 66.967% [===========================             ]                                                                 67.067% [===========================             ]                                                                 67.167% [===========================             ]                                                                 67.267% [===========================             ]                                                                 67.367% [===========================             ]                                                                 67.467% [===========================             ]                                                                 67.568% [===========================             ]                                                                 67.668% [===========================             ]                                                                 67.768% [===========================             ]                                                                 67.868% [===========================             ]                                                                 67.968% [===========================             ]                                                                 68.068% [===========================             ]                                                                 68.168% [===========================             ]                                                                 68.268% [===========================             ]                                                                 68.368% [===========================             ]                                                                 68.468% [===========================             ]                                                                 68.569% [===========================             ]                                                                 68.669% [===========================             ]                                                                 68.769% [============================            ]                                                                 68.869% [============================            ]                                                                 68.969% [============================            ]                                                                 69.069% [============================            ]                                                                 69.169% [============================            ]                                                                 69.269% [============================            ]                                                                 69.369% [============================            ]                                                                 69.469% [============================            ]                                                                 69.570% [============================            ]                                                                 69.670% [============================            ]                                                                 69.770% [============================            ]                                                                 69.870% [============================            ]                                                                 69.970% [============================            ]                                                                 70.070% [============================            ]                                                                 70.170% [============================            ]                                                                 70.270% [============================            ]                                                                 70.370% [============================            ]                                                                 70.470% [============================            ]                                                                 70.571% [============================            ]                                                                 70.671% [============================            ]                                                                 70.771% [============================            ]                                                                 70.871% [============================            ]                                                                 70.971% [============================            ]                                                                 71.071% [============================            ]                                                                 71.171% [============================            ]                                                                 71.271% [=============================           ]                                                                 71.371% [=============================           ]                                                                 71.471% [=============================           ]                                                                 71.572% [=============================           ]                                                                 71.672% [=============================           ]                                                                 71.772% [=============================           ]                                                                 71.872% [=============================           ]                                                                 71.972% [=============================           ]                                                                 72.072% [=============================           ]                                                                 72.172% [=============================           ]                                                                 72.272% [=============================           ]                                                                 72.372% [=============================           ]                                                                 72.472% [=============================           ]                                                                 72.573% [=============================           ]                                                                 72.673% [=============================           ]                                                                 72.773% [=============================           ]                                                                 72.873% [=============================           ]                                                                 72.973% [=============================           ]                                                                 73.073% [=============================           ]                                                                 73.173% [=============================           ]                                                                 73.273% [=============================           ]                                                                 73.373% [=============================           ]                                                                 73.473% [=============================           ]                                                                 73.574% [=============================           ]                                                                 73.674% [=============================           ]                                                                 73.774% [==============================          ]                                                                 73.874% [==============================          ]                                                                 73.974% [==============================          ]                                                                 74.074% [==============================          ]                                                                 74.174% [==============================          ]                                                                 74.274% [==============================          ]                                                                 74.374% [==============================          ]                                                                 74.474% [==============================          ]                                                                 74.575% [==============================          ]                                                                 74.675% [==============================          ]                                                                 74.775% [==============================          ]                                                                 74.875% [==============================          ]                                                                 74.975% [==============================          ]                                                                 75.075% [==============================          ]                                                                 75.175% [==============================          ]                                                                 75.275% [==============================          ]                                                                 75.375% [==============================          ]                                                                 75.475% [==============================          ]                                                                 75.576% [==============================          ]                                                                 75.676% [==============================          ]                                                                 75.776% [==============================          ]                                                                 75.876% [==============================          ]                                                                 75.976% [==============================          ]                                                                 76.076% [==============================          ]                                                                 76.176% [==============================          ]                                                                 76.276% [===============================         ]                                                                 76.376% [===============================         ]                                                                 76.476% [===============================         ]                                                                 76.577% [===============================         ]                                                                 76.677% [===============================         ]                                                                 76.777% [===============================         ]                                                                 76.877% [===============================         ]                                                                 76.977% [===============================         ]                                                                 77.077% [===============================         ]                                                                 77.177% [===============================         ]                                                                 77.277% [===============================         ]                                                                 77.377% [===============================         ]                                                                 77.477% [===============================         ]                                                                 77.578% [===============================         ]                                                                 77.678% [===============================         ]                                                                 77.778% [===============================         ]                                                                 77.878% [===============================         ]                                                                 77.978% [===============================         ]                                                                 78.078% [===============================         ]                                                                 78.178% [===============================         ]                                                                 78.278% [===============================         ]                                                                 78.378% [===============================         ]                                                                 78.478% [===============================         ]                                                                 78.579% [===============================         ]                                                                 78.679% [===============================         ]                                                                 78.779% [================================        ]                                                                 78.879% [================================        ]                                                                 78.979% [================================        ]                                                                 79.079% [================================        ]                                                                 79.179% [================================        ]                                                                 79.279% [================================        ]                                                                 79.379% [================================        ]                                                                 79.479% [================================        ]                                                                 79.580% [================================        ]                                                                 79.680% [================================        ]                                                                 79.780% [================================        ]                                                                 79.880% [================================        ]                                                                 79.980% [================================        ]                                                                 80.080% [================================        ]                                                                 80.180% [================================        ]                                                                 80.280% [================================        ]                                                                 80.380% [================================        ]                                                                 80.480% [================================        ]                                                                 80.581% [================================        ]                                                                 80.681% [================================        ]                                                                 80.781% [================================        ]                                                                 80.881% [================================        ]                                                                 80.981% [================================        ]                                                                 81.081% [================================        ]                                                                 81.181% [================================        ]                                                                 81.281% [=================================       ]                                                                 81.381% [=================================       ]                                                                 81.481% [=================================       ]                                                                 81.582% [=================================       ]                                                                 81.682% [=================================       ]                                                                 81.782% [=================================       ]                                                                 81.882% [=================================       ]                                                                 81.982% [=================================       ]                                                                 82.082% [=================================       ]                                                                 82.182% [=================================       ]                                                                 82.282% [=================================       ]                                                                 82.382% [=================================       ]                                                                 82.482% [=================================       ]                                                                 82.583% [=================================       ]                                                                 82.683% [=================================       ]                                                                 82.783% [=================================       ]                                                                 82.883% [=================================       ]                                                                 82.983% [=================================       ]                                                                 83.083% [=================================       ]                                                                 83.183% [=================================       ]                                                                 83.283% [=================================       ]                                                                 83.383% [=================================       ]                                                                 83.483% [=================================       ]                                                                 83.584% [=================================       ]                                                                 83.684% [=================================       ]                                                                 83.784% [==================================      ]                                                                 83.884% [==================================      ]                                                                 83.984% [==================================      ]                                                                 84.084% [==================================      ]                                                                 84.184% [==================================      ]                                                                 84.284% [==================================      ]                                                                 84.384% [==================================      ]                                                                 84.484% [==================================      ]                                                                 84.585% [==================================      ]                                                                 84.685% [==================================      ]                                                                 84.785% [==================================      ]                                                                 84.885% [==================================      ]                                                                 84.985% [==================================      ]                                                                 85.085% [==================================      ]                                                                 85.185% [==================================      ]                                                                 85.285% [==================================      ]                                                                 85.385% [==================================      ]                                                                 85.485% [==================================      ]                                                                 85.586% [==================================      ]                                                                 85.686% [==================================      ]                                                                 85.786% [==================================      ]                                                                 85.886% [==================================      ]                                                                 85.986% [==================================      ]                                                                 86.086% [==================================      ]                                                                 86.186% [==================================      ]                                                                 86.286% [===================================     ]                                                                 86.386% [===================================     ]                                                                 86.486% [===================================     ]                                                                 86.587% [===================================     ]                                                                 86.687% [===================================     ]                                                                 86.787% [===================================     ]                                                                 86.887% [===================================     ]                                                                 86.987% [===================================     ]                                                                 87.087% [===================================     ]                                                                 87.187% [===================================     ]                                                                 87.287% [===================================     ]                                                                 87.387% [===================================     ]                                                                 87.487% [===================================     ]                                                                 87.588% [===================================     ]                                                                 87.688% [===================================     ]                                                                 87.788% [===================================     ]                                                                 87.888% [===================================     ]                                                                 87.988% [===================================     ]                                                                 88.088% [===================================     ]                                                                 88.188% [===================================     ]                                                                 88.288% [===================================     ]                                                                 88.388% [===================================     ]                                                                 88.488% [===================================     ]                                                                 88.589% [===================================     ]                                                                 88.689% [===================================     ]                                                                 88.789% [====================================    ]                                                                 88.889% [====================================    ]                                                                 88.989% [====================================    ]                                                                 89.089% [====================================    ]                                                                 89.189% [====================================    ]                                                                 89.289% [====================================    ]                                                                 89.389% [====================================    ]                                                                 89.489% [====================================    ]                                                                 89.590% [====================================    ]                                                                 89.690% [====================================    ]                                                                 89.790% [====================================    ]                                                                 89.890% [====================================    ]                                                                 89.990% [====================================    ]                                                                 90.090% [====================================    ]                                                                 90.190% [====================================    ]                                                                 90.290% [====================================    ]                                                                 90.390% [====================================    ]                                                                 90.490% [====================================    ]                                                                 90.591% [====================================    ]                                                                 90.691% [====================================    ]                                                                 90.791% [====================================    ]                                                                 90.891% [====================================    ]                                                                 90.991% [====================================    ]                                                                 91.091% [====================================    ]                                                                 91.191% [====================================    ]                                                                 91.291% [=====================================   ]                                                                 91.391% [=====================================   ]                                                                 91.491% [=====================================   ]                                                                 91.592% [=====================================   ]                                                                 91.692% [=====================================   ]                                                                 91.792% [=====================================   ]                                                                 91.892% [=====================================   ]                                                                 91.992% [=====================================   ]                                                                 92.092% [=====================================   ]                                                                 92.192% [=====================================   ]                                                                 92.292% [=====================================   ]                                                                 92.392% [=====================================   ]                                                                 92.492% [=====================================   ]                                                                 92.593% [=====================================   ]                                                                 92.693% [=====================================   ]                                                                 92.793% [=====================================   ]                                                                 92.893% [=====================================   ]                                                                 92.993% [=====================================   ]                                                                 93.093% [=====================================   ]                                                                 93.193% [=====================================   ]                                                                 93.293% [=====================================   ]                                                                 93.393% [=====================================   ]                                                                 93.493% [=====================================   ]                                                                 93.594% [=====================================   ]                                                                 93.694% [=====================================   ]                                                                 93.794% [======================================  ]                                                                 93.894% [======================================  ]                                                                 93.994% [======================================  ]                                                                 94.094% [======================================  ]                                                                 94.194% [======================================  ]                                                                 94.294% [======================================  ]                                                                 94.394% [======================================  ]                                                                 94.494% [======================================  ]                                                                 94.595% [======================================  ]                                                                 94.695% [======================================  ]                                                                 94.795% [======================================  ]                                                                 94.895% [======================================  ]                                                                 94.995% [======================================  ]                                                                 95.095% [======================================  ]                                                                 95.195% [======================================  ]                                                                 95.295% [======================================  ]                                                                 95.395% [======================================  ]                                                                 95.495% [======================================  ]                                                                 95.596% [======================================  ]                                                                 95.696% [======================================  ]                                                                 95.796% [======================================  ]                                                                 95.896% [======================================  ]                                                                 95.996% [======================================  ]                                                                 96.096% [======================================  ]                                                                 96.196% [======================================  ]                                                                 96.296% [======================================= ]                                                                 96.396% [======================================= ]                                                                 96.496% [======================================= ]                                                                 96.597% [======================================= ]                                                                 96.697% [======================================= ]                                                                 96.797% [======================================= ]                                                                 96.897% [======================================= ]                                                                 96.997% [======================================= ]                                                                 97.097% [======================================= ]                                                                 97.197% [======================================= ]                                                                 97.297% [======================================= ]                                                                 97.397% [======================================= ]                                                                 97.497% [======================================= ]                                                                 97.598% [======================================= ]                                                                 97.698% [======================================= ]                                                                 97.798% [======================================= ]                                                                 97.898% [======================================= ]                                                                 97.998% [======================================= ]                                                                 98.098% [======================================= ]                                                                 98.198% [======================================= ]                                                                 98.298% [======================================= ]                                                                 98.398% [======================================= ]                                                                 98.498% [======================================= ]                                                                 98.599% [======================================= ]                                                                 98.699% [======================================= ]                                                                 98.799% [========================================]                                                                 98.899% [========================================]                                                                 98.999% [========================================]                                                                 99.099% [========================================]                                                                 99.199% [========================================]                                                                 99.299% [========================================]                                                                 99.399% [========================================]                                                                 99.499% [========================================]                                                                 99.600% [========================================]                                                                 99.700% [========================================]                                                                 99.800% [========================================]                                                                 99.900% [========================================]                                                                 100.000% [========================================]
> summary(lmb.D9_v2)
Call
lmb(formula = weight ~ group, pfamily = dIndependent_Normal_Gamma(mu, 
    V, shape = shape, rate = rate))

Expected Deviance Residuals:
        1         2         3         4         5         6         7         8 
-0.842030  0.567970  0.167970  1.097970 -0.512030 -0.402030  0.157970 -0.482030 
        9        10        11        12        13        14        15        16 
 0.317970  0.127970  0.126347 -0.513653 -0.273653 -1.093653  1.186347 -0.853653 
       17        18        19        20 
 1.346347  0.206347 -0.363653  0.006347 

Prior and Maximum Likelihood Estimates with Standard Deviations

            Prior Mean Prior.sd Max Like. Like.sd
(Intercept)      4.846    1.000     5.032   0.220
groupTrt         0.000    1.000    -0.371   0.311

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean Post.Sd MC Error Pr(tail)
(Intercept)    5.0059    5.0120  0.2237        0    0.231
groupTrt      -0.3274   -0.3284  0.3218        0    0.143

Distribution Percentiles

               1.0%    2.5%    5.0%  Median   95.0%   97.5% 99.0%
(Intercept)  4.5073  4.5840  4.6466  5.0071  5.3891  5.4396 5.548
groupTrt    -1.0638 -0.9718 -0.8670 -0.3263  0.1979  0.3126 0.442

Effective Number of Parameters: 2.564349 
Expected Residual Deviance: 19.86204 
DIC: 45.69118 

Expected Mean dispersion: 0.532249 
Sq.root of Expected Mean dispersion: 0.729554 

Mean Likelihood Subgradient Candidates Per iid sample: 23.354 

> 
> 
> 
> cleanEx()
> nameEx("logLik.glmb")
> ### * logLik.glmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: logLik.glmb
> ### Title: Extract Log-Likelihood
> ### Aliases: logLik.glmb
> 
> ### ** Examples
> 
> ## ----dobson-------------------------------------------------------------------
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> 
> ## Prior mean vector 
> mu<-matrix(0,5)           
> mu[1,1]=log(mean(counts)) 
> ## Prior standard deviation and Variance
> mysd<-1           
> V=((mysd)^2)*diag(5)  
> ## Call to glmb
> glmb.D93<-glmb(n=1000,counts ~ outcome + treatment,
+                family = poisson(),pfamily=dNormal(mu=mu,Sigma=V))
Entering EnvelopeBuild_c: 2025-08-03 19:21:22
Entering Envelope Loop: 2025-08-03 19:21:22
> ## ----glmb logLik-------------------------------------------------------------
> colMeans(logLik(glmb.D93))
[1] -25.9049
> 
> 
> 
> cleanEx()
> nameEx("menarche")
> ### * menarche
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: menarche2
> ### Title: Age Of Menarche In Warsaw
> ### Aliases: menarche2
> ### Keywords: datasets, Bayesian Binomial Regression
> 
> ### ** Examples
> 
> data(menarche2)
> 
> 
> 
> cleanEx()
> nameEx("pfamily")
> ### * pfamily
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: pfamily
> ### Title: Prior Family Objects for Bayesian Models
> ### Aliases: pfamily dNormal dGamma dNormal_Gamma dIndependent_Normal_Gamma
> ###   print.pfamily
> 
> ### ** Examples
> 
> mu=c(0,0)
> Sigma=diag(2)
> 
> npf<-dNormal(mu,Sigma)  # Normal pfamily
> str(dNormal(mu,Sigma))
List of 6
 $ pfamily   : chr "dNormal"
 $ prior_list:List of 3
  ..$ mu        : num [1:2, 1] 0 0
  ..$ Sigma     : num [1:2, 1:2] 1 0 0 1
  ..$ dispersion: num 1
  ..- attr(*, "Prior Type")= chr "dNormal"
 $ okfamilies: chr [1:6] "gaussian" "poisson" "binomial" "quasipoisson" ...
 $ plinks    :function (family)  
 $ simfun    :function (n, y, x, prior_list, offset = NULL, weights = 1, family = gaussian())  
 $ call      : language dNormal(mu = mu, Sigma = Sigma)
 - attr(*, "Prior Type")= chr "dNormal"
 - attr(*, "class")= chr "pfamily"
> 
> ## Example where # Normal pfamily is used
> 
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> mysd<-1
> mu<-matrix(0,5)
> mu[1]=log(mean(counts))
> V0<-((mysd)^2)*diag(5)
> glmb.D93<-glmb(counts ~ outcome + treatment, family = poisson(),pfamily=dNormal(mu=mu,Sigma=V0))
Entering EnvelopeBuild_c: 2025-08-03 19:21:22
Entering Envelope Loop: 2025-08-03 19:21:22
> summary(glmb.D93)
Call
glmb(formula = counts ~ outcome + treatment, family = poisson(), 
    pfamily = dNormal(mu = mu, Sigma = V0))

Expected Deviance Residuals:
      1       2       3       4       5       6       7       8       9 
-0.6047  0.9584 -0.1399 -0.1528 -0.9592  1.0865  0.9043 -0.1044 -0.9457 

Prior and Maximum Likelihood Estimates with Standard Deviations

                         Prior.sd  Max Like. Like.sd
(Intercept)  2.813e+00  1.000e+00  3.045e+00   0.171
outcome2     0.000e+00  1.000e+00 -4.543e-01   0.202
outcome3     0.000e+00  1.000e+00 -2.930e-01   0.193
treatment2   0.000e+00  1.000e+00  1.217e-15   0.200
treatment3   0.000e+00  1.000e+00  8.438e-16   0.200

Bayesian Estimates Based on 1000 iid draws

             Post.Mode  Post.Mean    Post.Sd MC Error Pr(tail)  
(Intercept)  3.0271911  3.0253203  0.1584447        0   0.0949 .
outcome2    -0.4289537 -0.4398217  0.2031081        0   0.0150 *
outcome3    -0.2725692 -0.2874882  0.1927010        0   0.0679 .
treatment2   0.0040420 -0.0006772  0.1929112        0   0.4995  
treatment3   0.0040420  0.0024326  0.1893351        0   0.4985  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Distribution Percentiles

                 1.0%      2.5%      5.0%    Median     95.0%     97.5% 99.0%
(Intercept)  2.645175  2.691852  2.761617  3.028352  3.285580  3.332938 3.366
outcome2    -0.877188 -0.845144 -0.772513 -0.436018 -0.094257 -0.034630 0.041
outcome3    -0.732693 -0.675876 -0.609567 -0.282736  0.020368  0.078234 0.173
treatment2  -0.448076 -0.369691 -0.317839  0.001988  0.303600  0.373875 0.444
treatment3  -0.439179 -0.354739 -0.292083 -0.002356  0.321250  0.384525 0.444

Effective Number of Parameters: 4.797473 
Expected Residual Deviance: 9.95733 
DIC: 56.38698 

Expected Mean dispersion: 1 
Sq.root of Expected Mean dispersion: 1 

Mean Likelihood Subgradient Candidates Per iid sample: 1.842 

> 
> 
> 
> cleanEx()
> nameEx("predict.glmb")
> ### * predict.glmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: predict.glmb
> ### Title: Predict Method for Bayesian GLM Fits
> ### Aliases: predict.glmb
> 
> ### ** Examples
> 
> data(menarche2)
> ## ----Analysis Setup-----------------------------------------------------------
> ## Number of variables in model
> Age=menarche2$Age
> nvars=2
> ## Reference Ages for setting of priors and Age_Difference
> ref_age1=13  # user can modify this
> ref_age2=15  ## user can modify this
> ## Define variables used later in analysis
> Age2=Age-ref_age1
> Age_Diff=ref_age2-ref_age1
> mu1=as.matrix(c(0,1.098612),ncol=1)
> V1<-1*diag(nvars)
> V1[1,1]=0.18687882
> V1[2,2]=0.10576217
> V1[1,2]=-0.03389182
> V1[2,1]=-0.03389182
> Menarche_Model_Data=data.frame(Age=menarche2$Age,Total=menarche2$Total,
+                                Menarche=menarche2$Menarche,Age2)
> glmb.out1<-glmb(n=1000,cbind(Menarche, Total-Menarche) ~Age2,family=binomial(logit),
+                 pfamily=dNormal(mu=mu1,Sigma=V1),data=Menarche_Model_Data)
Entering EnvelopeBuild_c: 2025-08-03 19:21:22
Entering Envelope Loop: 2025-08-03 19:21:22
Initiating NegLL Calculations: 2025-08-03 19:21:22
Initiating Gradient Calculations: 2025-08-03 19:21:22
Warning in eval(family$initialize) :
  non-integer #successes in a binomial glm!
> 
> # Prediction from original model
> pred0=predict(glmb.out1,type="link")
> colMeans(pred0)
         1          2          3          4          5          6          7 
-6.1422006 -4.5250612 -3.9267196 -3.5224348 -3.1181499 -2.7138651 -2.3095802 
         8          9         10         11         12         13         14 
-1.9052954 -1.5010105 -1.0967256 -0.6924408 -0.2881559  0.1161289  0.5204138 
        15         16         17         18         19         20         21 
 0.9246986  1.3289835  1.7332683  2.1375532  2.5418380  2.9461229  3.3504078 
        22         23         24         25 
 3.7546926  4.1589775  4.5632623  7.3932563 
> 
> pred1=predict(glmb.out1,type="response")
> colMeans(pred1)
          1           2           3           4           5           6 
0.002201174 0.010874865 0.019544467 0.028943384 0.042673069 0.062507461 
          7           8           9          10          11          12 
0.090703541 0.129879474 0.182609543 0.250621230 0.333666327 0.428529524 
         13          14          15          16          17          18 
0.528971159 0.627116861 0.715780128 0.790381341 0.849493797 0.894149506 
         19          20          21          22          23          24 
0.926685322 0.949772772 0.965851383 0.976903899 0.984433992 0.989533426 
         25 
0.999363125 
> 
> 
> ## Generate new data
> Age_New <- seq(8, 20, 0.25)
> Age2_New=Age_New-13
> mod_Object=glmb.out1
> obs_size=median(menarche2$Total) ## Counts for sim from Binomial
> olddata=data.frame(Age=menarche2$Age,
+                    Menarche=menarche2$Menarche,Total=menarche2$Total,Age2=Age2)
> 
> newdata=data.frame(Age=Age_New,Age2=Age2_New)
> 
> # Simulate for newdata
> 
> pred_menarche=predict(mod_Object,newdata=newdata,olddata=olddata,type="response")
> pred_m=colMeans(pred_menarche)
> 
> n=nrow(mod_Object$coefficients)
> pred_y=matrix(0,nrow=n,ncol=length(Age_New))
> for(i in 1:n){
+   pred_y[i,1:length(Age_New)]=rbinom(length(Age_New),size=obs_size,
+   prob=pred_menarche[i,1:length(Age_New)
+                                                                                       ])
+ }
> 
> # Produce various predictions
> pred_y_m=colMeans(pred_y/obs_size)
> quant1_m=apply(pred_menarche,2,FUN=quantile,probs=c(0.025))
> quant2_m=apply(pred_menarche,2,FUN=quantile,probs=c(0.975))
> quant1_m_y=apply(pred_y/obs_size,2,FUN=quantile,probs=c(0.025))
> quant2_m_y=apply(pred_y/obs_size,2,FUN=quantile,probs=c(0.975))
> 
> #Plot Predictions for newdata
> plot(Menarche/Total ~ Age, data=menarche2,
+ main="Percentage of girls Who have had their first period")
> lines(Age_New, pred_m,lty=1)
> lines(Age_New, quant1_m,lty=2)
> lines(Age_New, quant2_m,lty=2)
> lines(Age_New, quant1_m_y,lty=2)
> lines(Age_New, quant2_m_y,lty=2)
> 
> 
> 
> 
> cleanEx()
> nameEx("rGamma_reg")
> ### * rGamma_reg
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: rGamma_reg
> ### Title: The Bayesian Generalized Linear Model Dispersion Distribution
> ### Aliases: rGamma_reg print.rGamma_reg summary.rGamma_reg
> 
> ### ** Examples
> 
> ## Annette Dobson (1990) "An Introduction to Generalized Linear Models".
> ## Page 9: Plant Weight Data.
> ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
> trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
> group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
> weight <- c(ctl, trt)
> lm.D9 <- lm(weight ~ group,x=TRUE,y=TRUE)
> 
> lm_summary=summary(lm.D9)
> 
> lm_summary

Call:
lm(formula = weight ~ group, x = TRUE, y = TRUE)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.0710 -0.4938  0.0685  0.2462  1.3690 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)   5.0320     0.2202  22.850 9.55e-15 ***
groupTrt     -0.3710     0.3114  -1.191    0.249    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6964 on 18 degrees of freedom
Multiple R-squared:  0.07308,	Adjusted R-squared:  0.02158 
F-statistic: 1.419 on 1 and 18 DF,  p-value: 0.249

> lm.D9$coefficients
(Intercept)    groupTrt 
      5.032      -0.371 
> 
> n<-10000
> y<-lm.D9$y
> x<-as.matrix(lm.D9$x)
> 
> ### Set old regression and dispersion coefficients
> 
> b_old=lm.D9$coefficients
> v_old=lm_summary$sigma^2
> 
> #### Set up for rglmb_dispersion
> 
> n0=0.1
> shape=n0/2
> rate=shape*v_old
> 
> rate/(shape-1)
[1] -0.02552412
> rate/shape
[1] 0.4849583
> 
> #a1<-shape+n1/2
> #b1<-rate+sum(SS)/2
> 
> #out<-1/rgamma(n,shape=a1,rate=b1)
> ## v0=sum(SS)/n1 ~ (2*rate+sum(SS))/(2*shape+n1)=[(2*rate+sum(SS))/2]/((2*shape+n1)/2) 
> n1=length(y)
> SS=v_old*n1
> 
> n1 # This is equal to 20
[1] 20
> 
> 
> n0=2 # Prior observations
> v_prior=v_old  # Prior point estimate for variance (the mean of (1/dispersion=1/v_prior))
> wt0=(n0/n1)  
> 
> ## set shape=0.01*(n1/2)
> ## set rate= 0.01*SS/2
> 
> shape=wt0*(n1/2)   ###  Shape is prior observations /2
> rate=shape*v_prior  ### rate is essentiall prior SS - V in rmultireg should be this
> rate/shape ## Should match v_prior (currently also v_old)
[1] 0.4849583
> 
> ## We see that this currently matches 
> ### (test different v_prior with various prior observations below) 
> 
> prior_list=list(beta=b_old,shape=shape,rate=rate)
> 
> dispout<-rGamma_reg(n=n,y,x,prior_list=prior_list,
+ offset= rep(0, length(y)),family=gaussian())
> 
> mean(dispout$dispersion) 
[1] 0.4844839
> v_prior
[1] 0.4849583
> v_old
[1] 0.4849583
> #summary(dispout)  ## Summary function not working - need to write
> 
> ### Set up test rglmb regressions without and with prior for dispersion 
> 
> mu<-c(0,0)
> mu=b_old  ### For testing purposes, set prior=b_old
> P<-0.1*diag(2)
> wt2=rep(1,length(y))
> 
> ### Check
> prior=list(mu=mu,Sigma=solve(P),dispersion=v_old)
> outtemp1<-glmb(n = 1000, weight ~ group, family = gaussian(),
+ pfamily=dNormal(mu=mu,Sigma=solve(P),dispersion=v_old))
> ## Could use a residuals function here -- For now, maybe run the glmb function
> 
> summary(outtemp1)
Call
glmb(formula = weight ~ group, family = gaussian(), pfamily = dNormal(mu = mu, 
    Sigma = solve(P), dispersion = v_old), n = 1000)

Expected Deviance Residuals:
       1        2        3        4        5        6        7        8 
-0.85394  0.55606  0.15606  1.08606 -0.52394 -0.41394  0.14606 -0.49394 
       9       10       11       12       13       14       15       16 
 0.30606  0.11606  0.15618 -0.48382 -0.24382 -1.06382  1.21618 -0.82382 
      17       18       19       20 
 1.37618  0.23618 -0.33382  0.03618 

Prior and Maximum Likelihood Estimates with Standard Deviations

                   Prior.sd Max Like. Like.sd
(Intercept)  5.032    3.162     5.032   0.220
groupTrt    -0.371    3.162    -0.371   0.311

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean Post.Sd MC Error Pr(tail)
(Intercept)    5.0320    5.0239  0.2109        0    0.493
groupTrt      -0.3710   -0.3701  0.2934        0    0.495

Distribution Percentiles

               1.0%    2.5%    5.0%  Median   95.0%   97.5% 99.0%
(Intercept)  4.5358  4.6292  4.6822  5.0292  5.3804  5.4560 5.515
groupTrt    -1.0570 -0.9534 -0.8582 -0.3784  0.1155  0.2116 0.286

Effective Number of Parameters: 1.907136 
Expected Residual Deviance: 9.655296 
DIC: 21.38684 

Expected Mean dispersion: 0.4849583 
Sq.root of Expected Mean dispersion: 0.6963895 

Mean Likelihood Subgradient Candidates Per iid sample: 1 

> mean(colMeans(residuals(outtemp1)^2))
[1] 0.4827648
> v_old
[1] 0.4849583
> colMeans((outtemp1$coefficients))
(Intercept)    groupTrt 
   5.023944   -0.370122 
> b_old
(Intercept)    groupTrt 
      5.032      -0.371 
> prior=list(mu=mu,P=P,dispersion=v_old)
> outtemp2<-rglmb(n = 1000, y, x, family = gaussian(),
+ pfamily=dNormal(mu=mu,Sigma=solve(P),dispersion=v_old),
+ offset = rep(0, length(y)), weights = wt2)
> summary(outtemp2)
Call
NULL

Prior Estimates with Standard Deviations

                   Prior.sd Approx.Prior.wt
(Intercept)  5.032    3.162           0.005
groupTrt    -0.371    3.162           0.010

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean Post.Sd MC Error Pr(tail)
(Intercept)    5.0320    5.0345  0.2249        0    0.499
groupTrt      -0.3710   -0.3711  0.3119        0    0.498

Distribution Percentiles

               1.0%    2.5%    5.0%  Median   95.0%   97.5% 99.0%
(Intercept)  4.5096  4.5852  4.6634  5.0315  5.4121  5.4719  5.54
groupTrt    -1.0209 -0.9499 -0.8730 -0.3744  0.1585  0.2974  0.41
> colMeans((outtemp2$coefficients))
(Intercept)    groupTrt 
  5.0345399  -0.3711281 
> b_old
(Intercept)    groupTrt 
      5.032      -0.371 
> 
> prior=list(mu=mu,Sigma=solve(P),shape=shape,rate=rate)
> outtemp3<-glmb(n = 10000, weight ~ group,family = gaussian(),  
+                dNormal_Gamma(mu=mu,Sigma=solve(P),shape=shape,rate=rate))
> ## Could use a residuals function here -- For now, maybe run the glmb function
> 
> summary(outtemp3)
Call
glmb(formula = weight ~ group, family = gaussian(), pfamily = dNormal_Gamma(mu = mu, 
    Sigma = solve(P), shape = shape, rate = rate), n = 10000)

Expected Deviance Residuals:
       1        2        3        4        5        6        7        8 
-0.86187  0.54813  0.14813  1.07813 -0.53187 -0.42187  0.13813 -0.50187 
       9       10       11       12       13       14       15       16 
 0.29813  0.10813  0.15036 -0.48964 -0.24964 -1.06964  1.21036 -0.82964 
      17       18       19       20 
 1.37036  0.23036 -0.33964  0.03036 

Prior and Maximum Likelihood Estimates with Standard Deviations

                   Prior.sd Max Like. Like.sd
(Intercept)  5.032    3.162     5.032   0.220
groupTrt    -0.371    3.162    -0.371   0.311

Bayesian Estimates Based on 10000 iid draws

            Post.Mode Post.Mean Post.Sd MC Error Pr(tail)
(Intercept)    5.0320    5.0319  0.2187        0    0.500
groupTrt      -0.3710   -0.3722  0.3103        0    0.499

Distribution Percentiles

               1.0%    2.5%    5.0%  Median   95.0%   97.5% 99.0%
(Intercept)  4.5100  4.5940  4.6715  5.0320  5.3888  5.4595 5.549
groupTrt    -1.0978 -0.9805 -0.8800 -0.3707  0.1358  0.2387 0.371

Effective Number of Parameters: 2.841004 
Expected Residual Deviance: 21.94876 
DIC: 45.95394 

Expected Mean dispersion: 0.4820243 
Sq.root of Expected Mean dispersion: 0.6942797 

Mean Likelihood Subgradient Candidates Per iid sample: 1 

> mean(colMeans(residuals(outtemp3)^2))
[1] 0.4847703
> v_old
[1] 0.4849583
> colMeans((outtemp3$coefficients))
(Intercept)    groupTrt 
  5.0318690  -0.3722294 
> b_old
(Intercept)    groupTrt 
      5.032      -0.371 
> mean(outtemp3$dispersion)  ## Seems slightly smaller --> Needs qc
[1] 0.4820243
> v_old
[1] 0.4849583
> 
> 
> 
> cleanEx()
> nameEx("rNormal_Gamma_reg")
> ### * rNormal_Gamma_reg
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: rNormal_Gamma_reg
> ### Title: The Bayesian Normal-Gamma Regression Distribution
> ### Aliases: rNormal_Gamma_reg
> 
> ### ** Examples
> 
> ## Annette Dobson (1990) "An Introduction to Generalized Linear Models".
> ## Page 9: Plant Weight Data.
> ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
> trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
> group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
> weight <- c(ctl, trt)
> 
> ps=Prior_Setup(weight ~ group)
[1] "Variable names are:"
[1] "(Intercept)" "groupTrt"   
> mu=ps$mu
> V=ps$Sigma
> mu[1,1]=mean(weight)
> 
> Prior_Check(weight ~ group,family =gaussian(),
+            pfamily=dNormal(mu=mu,Sigma=V))
[1] "Variables in the Model Are:"
[1] "(Intercept)" "groupTrt"   
[1] "The maximum likelihood estimates for all coefficients appear to be roughly consistent with the prior."
             abs_ratio
(Intercept) 0.09242285
groupTrt    0.17198871
> 
> ## Will move this step inside the Prior_Check
> lm.D9 <- lm(weight ~ group,x=TRUE,y=TRUE)
> disp_ML=sigma(lm.D9)^2
> n_prior=2
> shape=n_prior/2
> rate= disp_ML*shape
> 
> lmb.D9=lmb(weight ~ group,dNormal_Gamma(mu,V/disp_ML,shape=shape,rate=rate))
> summary(lmb.D9)
Call
lmb(formula = weight ~ group, pfamily = dNormal_Gamma(mu, V/disp_ML, 
    shape = shape, rate = rate))

Expected Deviance Residuals:
        1         2         3         4         5         6         7         8 
-0.837811  0.572189  0.172189  1.102189 -0.507811 -0.397811  0.162189 -0.477811 
        9        10        11        12        13        14        15        16 
 0.322189  0.132189  0.126903 -0.513097 -0.273097 -1.093097  1.186903 -0.853097 
       17        18        19        20 
 1.346903  0.206903 -0.363097  0.006903 

Prior and Maximum Likelihood Estimates with Standard Deviations

            Prior Mean Prior.sd Max Like. Like.sd
(Intercept)      4.846    1.436     5.032   0.220
groupTrt         0.000    1.436    -0.371   0.311

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean Post.Sd MC Error Pr(tail)
(Intercept)    5.0081    5.0078  0.2110        0    0.218
groupTrt      -0.3311   -0.3247  0.2868        0    0.119

Distribution Percentiles

               1.0%    2.5%    5.0%  Median   95.0%   97.5% 99.0%
(Intercept)  4.5315  4.5952  4.6548  5.0063  5.3358  5.4354 5.530
groupTrt    -0.9929 -0.9164 -0.7829 -0.3232  0.1468  0.2673 0.388

Effective Number of Parameters: 2.617534 
Expected Residual Deviance: 21.24484 
DIC: 45.58812 

Expected Mean dispersion: 0.4956164 
Sq.root of Expected Mean dispersion: 0.7040003 

Mean Likelihood Subgradient Candidates Per iid sample: 1 

> 
> n<-10000
> y<-lmb.D9$y
> x<-as.matrix(lmb.D9$x)
> prior_list=list(mu=mu,Sigma=V/disp_ML,shape=shape,rate=rate)
> ngamma.D9=rNormal_Gamma_reg(n=1000,y=y,x=x,
+   prior_list=prior_list)
> summary(ngamma.D9$coefficients)
  (Intercept)       groupTrt      
 Min.   :4.134   Min.   :-1.3003  
 1st Qu.:4.864   1st Qu.:-0.5347  
 Median :5.008   Median :-0.3142  
 Mean   :5.004   Mean   :-0.3229  
 3rd Qu.:5.144   3rd Qu.:-0.1344  
 Max.   :5.729   Max.   : 0.8215  
> 
> 
> 
> 
> cleanEx()
> nameEx("rNormal_reg")
> ### * rNormal_reg
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: rNormal_reg
> ### Title: The Bayesian Generalized Linear Model with Normal Prior
> ###   Distribution
> ### Aliases: rNormal_reg
> 
> ### ** Examples
> 
> ## Annette Dobson (1990) "An Introduction to Generalized Linear Models".
> ## Page 9: Plant Weight Data.
> ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
> trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
> group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
> weight <- c(ctl, trt)
> 
> ps=Prior_Setup(weight ~ group)
[1] "Variable names are:"
[1] "(Intercept)" "groupTrt"   
> mu=ps$mu
> V=ps$Sigma
> mu[1,1]=mean(weight)
> 
> Prior_Check(weight ~ group,family =gaussian(),
+            pfamily=dNormal(mu=mu,Sigma=V))
[1] "Variables in the Model Are:"
[1] "(Intercept)" "groupTrt"   
[1] "The maximum likelihood estimates for all coefficients appear to be roughly consistent with the prior."
             abs_ratio
(Intercept) 0.09242285
groupTrt    0.17198871
> 
> ## Will move this step inside the Prior_Check
> lm.D9 <- lm(weight ~ group,x=TRUE,y=TRUE)
> disp_ML=sigma(lm.D9)^2
> n_prior=2
> shape=n_prior/2
> rate= disp_ML*shape
> 
> lmb.D9=lmb(weight ~ group,dNormal_Gamma(mu,V/disp_ML,shape=shape,rate=rate))
> summary(lmb.D9)
Call
lmb(formula = weight ~ group, pfamily = dNormal_Gamma(mu, V/disp_ML, 
    shape = shape, rate = rate))

Expected Deviance Residuals:
        1         2         3         4         5         6         7         8 
-0.837811  0.572189  0.172189  1.102189 -0.507811 -0.397811  0.162189 -0.477811 
        9        10        11        12        13        14        15        16 
 0.322189  0.132189  0.126903 -0.513097 -0.273097 -1.093097  1.186903 -0.853097 
       17        18        19        20 
 1.346903  0.206903 -0.363097  0.006903 

Prior and Maximum Likelihood Estimates with Standard Deviations

            Prior Mean Prior.sd Max Like. Like.sd
(Intercept)      4.846    1.436     5.032   0.220
groupTrt         0.000    1.436    -0.371   0.311

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean Post.Sd MC Error Pr(tail)
(Intercept)    5.0081    5.0078  0.2110        0    0.218
groupTrt      -0.3311   -0.3247  0.2868        0    0.119

Distribution Percentiles

               1.0%    2.5%    5.0%  Median   95.0%   97.5% 99.0%
(Intercept)  4.5315  4.5952  4.6548  5.0063  5.3358  5.4354 5.530
groupTrt    -0.9929 -0.9164 -0.7829 -0.3232  0.1468  0.2673 0.388

Effective Number of Parameters: 2.617534 
Expected Residual Deviance: 21.24484 
DIC: 45.58812 

Expected Mean dispersion: 0.4956164 
Sq.root of Expected Mean dispersion: 0.7040003 

Mean Likelihood Subgradient Candidates Per iid sample: 1 

> 
> n<-10000
> y<-lmb.D9$y
> x<-as.matrix(lmb.D9$x)
> prior_list=list(mu=mu,Sigma=V/disp_ML,shape=shape,rate=rate)
> ngamma.D9=rNormal_Gamma_reg(n=1000,y=y,x=x,
+   prior_list=prior_list)
> summary(ngamma.D9$coefficients)
  (Intercept)       groupTrt      
 Min.   :4.134   Min.   :-1.3003  
 1st Qu.:4.864   1st Qu.:-0.5347  
 Median :5.008   Median :-0.3142  
 Mean   :5.004   Mean   :-0.3229  
 3rd Qu.:5.144   3rd Qu.:-0.1344  
 Max.   :5.729   Max.   : 0.8215  
> 
> 
> 
> 
> cleanEx()
> nameEx("rNormal_reg.wfit")
> ### * rNormal_reg.wfit
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: rNormal_reg.wfit
> ### Title: Fitter Function for Bayesian Linear Models
> ### Aliases: rNormal_reg.wfit
> 
> ### ** Examples
> 
> 
> ## ----dobson-------------------------------------------------------------------
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> 
> ## Prior mean vector 
> mu<-matrix(0,5)           
> mu[1,1]=log(mean(counts)) 
> ## Prior standard deviation and Variance
> mysd<-1           
> V=((mysd)^2)*diag(5)  
> ## Call to glmb
> glmb.D93<-glmb(n=1000,counts ~ outcome + treatment,
+                family = poisson(),pfamily=dNormal(mu=mu,Sigma=V))
Entering EnvelopeBuild_c: 2025-08-03 19:21:22
Entering Envelope Loop: 2025-08-03 19:21:22
> ## ----glmb confint-------------------------------------------------------------
> confint(glmb.D93)
                  2.5%       97.5%
(Intercept)  2.6791637  3.32865690
outcome2    -0.8286411 -0.04548836
outcome3    -0.6549436  0.08806683
treatment2  -0.3956109  0.37392352
treatment3  -0.3495259  0.36724052
> 
> 
> 
> cleanEx()
> nameEx("residuals.glmb")
> ### * residuals.glmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: residuals.glmb
> ### Title: Accessing Bayesian Generalized Linear Model Fits
> ### Aliases: residuals.glmb residuals.lmb
> 
> ### ** Examples
> 
> data(menarche2)
> ## ----Analysis Setup-----------------------------------------------------------
> ## Number of variables in model
> Age=menarche2$Age
> nvars=2
> ## Reference Ages for setting of priors and Age_Difference
> ref_age1=13  # user can modify this
> ref_age2=15  ## user can modify this
> ## Define variables used later in analysis
> Age2=menarche2$Age-ref_age1
> Age_Diff=ref_age2-ref_age1
> mu1=as.matrix(c(0,1.098612),ncol=1)
> V1<-1*diag(nvars)
> V1[1,1]=0.18687882
> V1[2,2]=0.10576217
> V1[1,2]=-0.03389182
> V1[2,1]=-0.03389182
> Menarche_Model_Data=data.frame(Age=menarche2$Age,Total=menarche2$Total,
+                                Menarche=menarche2$Menarche,Age2)
> glmb.out1<-glmb(n=1000,cbind(Menarche, Total-Menarche) ~Age2,family=binomial(logit),
+                 pfamily=dNormal(mu=mu1,Sigma=V1),data=Menarche_Model_Data)
Entering EnvelopeBuild_c: 2025-08-03 19:21:22
Entering Envelope Loop: 2025-08-03 19:21:22
Initiating NegLL Calculations: 2025-08-03 19:21:22
Initiating Gradient Calculations: 2025-08-03 19:21:22
Warning in eval(family$initialize) :
  non-integer #successes in a binomial glm!
> 
> # Prediction from original model
> pred1=predict(glmb.out1,type="response")
> 
> ## Get Original Residuals, their means, and credible bounds
> res_out=residuals(glmb.out1)
> colMeans(res_out)
          1           2           3           4           5           6 
-1.28235486 -2.08846563 -1.91479803 -0.86716302 -1.05244724 -0.22367780 
          7           8           9          10          11          12 
 0.15835878  0.70703474 -0.60296318  1.31905234  1.16684255  0.89917310 
         13          14          15          16          17          18 
-1.09513241  0.08945705  1.27662684 -1.01275408 -1.17453410  1.12365172 
         19          20          21          22          23          24 
 0.63610751 -0.82321788 -0.41881955 -0.85479213 -0.43636657 -0.69059345 
         25 
 1.14580337 
> 
> ## Set up to simulate new data and residuals
> res_mean=colMeans(res_out)
> res_low1=apply(res_out,2,FUN=quantile,probs=c(0.025))
> res_high1=apply(res_out,2,FUN=quantile,probs=c(0.975))
> 
> ## Simulate new data and get residuals for simulated data
> 
> ysim1=simulate(glmb.out1,nsim=1,seed=NULL,pred=pred1,family="binomial",
+                prior.weights=weights(glmb.out1))
> 
> 
> res_ysim_out1=residuals(glmb.out1,ysim=ysim1)
> res_low=apply(res_ysim_out1,2,FUN=quantile,probs=c(0.025))
> res_high=apply(res_ysim_out1,2,FUN=quantile,probs=c(0.975))
> 
> # Plot Credible Interval bounds for Deviance Residuals
> 
> plot(res_mean~Age,ylim=c(-2.5,2.5),
+ main="Credible Interval Bound for Menarche - Logit Model Deviance Residuals",
+ xlab = "Age", ylab = "Avg. Dev. Res")
> lines(Age, 0*res_mean,lty=1)
> lines(Age, res_low,lty=1)
> lines(Age, res_high,lty=1)
> lines(Age, res_low1,lty=2)
> lines(Age, res_high1,lty=2)
> 
> 
> 
> 
> cleanEx()
> nameEx("rglmb")
> ### * rglmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: rglmb
> ### Title: The Bayesian Generalized Linear Model Distribution
> ### Aliases: rglmb print.rglmb
> 
> ### ** Examples
> 
> data(menarche2)
> 
> summary(menarche2)
      Age            Total           Menarche      
 Min.   : 9.21   Min.   :  88.0   Min.   :   0.00  
 1st Qu.:11.58   1st Qu.:  98.0   1st Qu.:  10.00  
 Median :13.08   Median : 105.0   Median :  51.00  
 Mean   :13.10   Mean   : 156.7   Mean   :  92.32  
 3rd Qu.:14.58   3rd Qu.: 117.0   3rd Qu.:  92.00  
 Max.   :17.58   Max.   :1049.0   Max.   :1049.00  
> plot(Menarche/Total ~ Age, data=menarche2)
> 
> Age2=menarche2$Age-13
> 
> x<-matrix(as.numeric(1.0),nrow=length(Age2),ncol=2)
> x[,2]=Age2
> 
> y=menarche2$Menarche/menarche2$Total
> wt=menarche2$Total
> 
> mu<-matrix(as.numeric(0.0),nrow=2,ncol=1)
> mu[2,1]=(log(0.9/0.1)-log(0.5/0.5))/3
> 
> V1<-1*diag(as.numeric(2.0))
> 
> # 2 standard deviations for prior estimate at age 13 between 0.1 and 0.9
> ## Specifies uncertainty around the point estimates
> 
> V1[1,1]<-((log(0.9/0.1)-log(0.5/0.5))/2)^2 
> V1[2,2]=(3*mu[2,1]/2)^2  # Allows slope to be up to 3 times as large as point estimate 
> 
> out<-rglmb(n = 1000, y=y, x=x, pfamily=dNormal(mu=mu,Sigma=V1), weights = wt, 
+            family = binomial(logit)) 
Entering EnvelopeBuild_c: 2025-08-03 19:21:23
Entering Envelope Loop: 2025-08-03 19:21:23
Initiating NegLL Calculations: 2025-08-03 19:21:23
Initiating Gradient Calculations: 2025-08-03 19:21:23
> summary(out)
Warning in eval(family$initialize) :
  non-integer #successes in a binomial glm!
Call
NULL

Prior Estimates with Standard Deviations

            Prior.sd Approx.Prior.wt
[1,] 0.0000   1.0986           0.004
[2,] 0.7324   1.0986           0.003

Bayesian Estimates Based on 1000 iid draws

     Post.Mode Post.Mean   Post.Sd MC Error Pr(tail)    
[1,] -0.010696 -0.009308  0.065168        0 0.436563    
[2,]  1.629390  1.632476  0.059670        0 0.000999 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Distribution Percentiles

         1.0%     2.5%     5.0%   Median    95.0%    97.5% 99.0%
[1,] -0.16091 -0.13970 -0.11707 -0.01032  0.10212  0.11666 0.140
[2,]  1.50003  1.52130  1.53604  1.63249  1.73055  1.75357 1.779
> 
> # Add mean(out$iters to rglmb summary function)
> mean(out$iters)
[1] 1.265
> 
> 
> 
> cleanEx()
> nameEx("rindep_norm_gamma_reg_std_R")
> ### * rindep_norm_gamma_reg_std_R
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: rindep_norm_gamma_reg_std_R
> ### Title: The Standard Bayesian Indendepent Normal-Gamma Regression
> ###   Distribution
> ### Aliases: rindep_norm_gamma_reg_std_R
> 
> ### ** Examples
> 
> 
> ## Annette Dobson (1990) "An Introduction to Generalized Linear Models".
> ## Page 9: Plant Weight Data.
> ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
> trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
> group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
> weight <- c(ctl, trt)
> lm.D9 <- lm(weight ~ group,y=TRUE,x=TRUE)
> 
> p_setup=Prior_Setup(lm.D9)
[1] "Variable names are:"
[1] "(Intercept)" "groupTrt"   
> dispersion=sigma(lm.D9)^2
> 
> ## Initialize dispersion
> p=1/dispersion
> 
> mu=p_setup$mu
> Sigma_prior=p_setup$Sigma
> y=lm.D9$y
> x=lm.D9$x
> 
> Prior_Check(weight ~ group,gaussian(),dNormal(mu=mu,Sigma=Sigma_prior))
[1] "Variables in the Model Are:"
[1] "(Intercept)" "groupTrt"   
[1] "The maximum likelihood estimates for all coefficients appear to be roughly consistent with the prior."
             abs_ratio
(Intercept) 0.09242285
groupTrt    0.17198871
> 
> ## This simple "standardization" for the prior appears to 
> ## correct the issue with the prior
> 
> ## "Standardize" the prior for the intercept by setting the
> ## mean equal to the mean of the dependent variable
> ## and setting the variance equal to the variance of the dependent variable
> 
> mu[1,1]=mean(y)
> Sigma_prior[1,1]=var(y)
> 
> ## For factors, set the "standad prior to mean=0 and variance driven by the range
> ## of the dependent variable 
> 
> mu[2,1]=0
> Sigma_prior[2,2]=((max(y)-min(y))/1.96)^2
> 
> #Prior_Check(lm.D9,mu,Sigma_prior)
> Prior_Check(weight ~ group,gaussian(),dNormal(mu=mu,Sigma=Sigma_prior))
[1] "Variables in the Model Are:"
[1] "(Intercept)" "groupTrt"   
[1] "The maximum likelihood estimates for all coefficients appear to be roughly consistent with the prior."
            abs_ratio
(Intercept) 0.1220195
groupTrt    0.1412216
> 
> 
> #prior=list(mu=mu,Sigma=Sigma_prior,dispersion=dispersion)
> glmb.D9=glmb(weight~group, family=gaussian(),dNormal(mu=mu,Sigma=Sigma_prior,dispersion=dispersion))
> post_mode=glmb.D9$coef.mode
> 
> sum_out1=summary(glmb.D9)
> 
> ## Try mean one standard deviation away to see how it works
> #mu[1,1]=mu[1,1]-2*sum_out1$coefficients[1,3]
> #mu[2,1]=mu[2,1]+2*sum_out1$coefficients[1,3]
> 
> #prior=list(mu=mu,Sigma=Sigma_prior,dispersion=dispersion)
> 
> # Temporarily lower the prior variance
> Sigma_prior=1*Sigma_prior
> 
> glmb.D9_v2=glmb(n=1000,weight~group, family=gaussian(),
+ dNormal(mu=mu,Sigma=Sigma_prior,dispersion=dispersion))
> 
> n_prior=2
> shape=n_prior/2
> rate= dispersion*shape
> 
> 
> summary(glmb.D9)
Call
glmb(formula = weight ~ group, family = gaussian(), pfamily = dNormal(mu = mu, 
    Sigma = Sigma_prior, dispersion = dispersion))

Expected Deviance Residuals:
       1        2        3        4        5        6        7        8 
-0.82703  0.58297  0.18297  1.11297 -0.49703 -0.38703  0.17297 -0.46703 
       9       10       11       12       13       14       15       16 
 0.33297  0.14297  0.14334 -0.49666 -0.25666 -1.07666  1.20334 -0.83666 
      17       18       19       20 
 1.36334  0.22334 -0.34666  0.02334 

Prior and Maximum Likelihood Estimates with Standard Deviations

                mu Prior.sd Max Like. Like.sd
(Intercept)  4.846    0.704     5.032   0.220
groupTrt     0.000    1.286    -0.371   0.311

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean Post.Sd MC Error Pr(tail)
(Intercept)    5.0065    4.9970  0.2157        0    0.230
groupTrt      -0.3357   -0.3304  0.2981        0    0.138

Distribution Percentiles

               1.0%    2.5%    5.0%  Median   95.0%   97.5% 99.0%
(Intercept)  4.4942  4.5599  4.6494  4.9976  5.3407  5.4034 5.490
groupTrt    -1.0473 -0.9250 -0.8218 -0.3411  0.1751  0.2642 0.332

Effective Number of Parameters: 2.000945 
Expected Residual Deviance: 9.712176 
DIC: 21.48922 

Expected Mean dispersion: 0.4849583 
Sq.root of Expected Mean dispersion: 0.6963895 

Mean Likelihood Subgradient Candidates Per iid sample: 1 

> summary(glmb.D9_v2)
Call
glmb(formula = weight ~ group, family = gaussian(), pfamily = dNormal(mu = mu, 
    Sigma = Sigma_prior, dispersion = dispersion), n = 1000)

Expected Deviance Residuals:
       1        2        3        4        5        6        7        8 
-0.84611  0.56389  0.16389  1.09389 -0.51611 -0.40611  0.15389 -0.48611 
       9       10       11       12       13       14       15       16 
 0.31389  0.12389  0.13433 -0.50567 -0.26567 -1.08567  1.19433 -0.84567 
      17       18       19       20 
 1.35433  0.21433 -0.35567  0.01433 

Prior and Maximum Likelihood Estimates with Standard Deviations

                mu Prior.sd Max Like. Like.sd
(Intercept)  4.846    0.704     5.032   0.220
groupTrt     0.000    1.286    -0.371   0.311

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean Post.Sd MC Error Pr(tail)
(Intercept)    5.0065    5.0161  0.2117        0    0.216
groupTrt      -0.3357   -0.3404  0.3117        0    0.143

Distribution Percentiles

               1.0%    2.5%    5.0%  Median   95.0%   97.5% 99.0%
(Intercept)  4.5308  4.6134  4.6851  5.0101  5.3881  5.4511 5.504
groupTrt    -1.1137 -0.9720 -0.8620 -0.3455  0.1674  0.2538 0.323

Effective Number of Parameters: 1.988716 
Expected Residual Deviance: 9.698371 
DIC: 21.46948 

Expected Mean dispersion: 0.4849583 
Sq.root of Expected Mean dispersion: 0.6963895 

Mean Likelihood Subgradient Candidates Per iid sample: 1 

> 
> 
> #lm_out=lm(y ~ x-1) # returns same model
> RSS=sum(residuals(lm.D9)^2)
> 
> n_prior=4
> n_data=length(y)
> shape=(n_prior/2)
> rate=n_prior*RSS/n_data
> 
> 
> 
> prior_list=list(mu=mu,Sigma=Sigma_prior,dispersion=dispersion,
+                  shape=shape,rate=rate,Precision=solve(Sigma_prior))
> 
> 
> set.seed(360)
> 
>  ptm <- proc.time()
>  sim2=rindependent_norm_gamma_reg(n=1000,y,x,prior_list=prior_list,
+ offset=NULL,weights=1,max_disp_perc=0.99)
Starting Simulation:
                                                                 0.000% [                                        ]                                                                 0.100% [                                        ]                                                                 0.200% [                                        ]                                                                 0.300% [                                        ]                                                                 0.400% [                                        ]                                                                 0.501% [                                        ]                                                                 0.601% [                                        ]                                                                 0.701% [                                        ]                                                                 0.801% [                                        ]                                                                 0.901% [                                        ]                                                                 1.001% [                                        ]                                                                 1.101% [                                        ]                                                                 1.201% [                                        ]                                                                 1.301% [=                                       ]                                                                 1.401% [=                                       ]                                                                 1.502% [=                                       ]                                                                 1.602% [=                                       ]                                                                 1.702% [=                                       ]                                                                 1.802% [=                                       ]                                                                 1.902% [=                                       ]                                                                 2.002% [=                                       ]                                                                 2.102% [=                                       ]                                                                 2.202% [=                                       ]                                                                 2.302% [=                                       ]                                                                 2.402% [=                                       ]                                                                 2.503% [=                                       ]                                                                 2.603% [=                                       ]                                                                 2.703% [=                                       ]                                                                 2.803% [=                                       ]                                                                 2.903% [=                                       ]                                                                 3.003% [=                                       ]                                                                 3.103% [=                                       ]                                                                 3.203% [=                                       ]                                                                 3.303% [=                                       ]                                                                 3.403% [=                                       ]                                                                 3.504% [=                                       ]                                                                 3.604% [=                                       ]                                                                 3.704% [=                                       ]                                                                 3.804% [==                                      ]                                                                 3.904% [==                                      ]                                                                 4.004% [==                                      ]                                                                 4.104% [==                                      ]                                                                 4.204% [==                                      ]                                                                 4.304% [==                                      ]                                                                 4.404% [==                                      ]                                                                 4.505% [==                                      ]                                                                 4.605% [==                                      ]                                                                 4.705% [==                                      ]                                                                 4.805% [==                                      ]                                                                 4.905% [==                                      ]                                                                 5.005% [==                                      ]                                                                 5.105% [==                                      ]                                                                 5.205% [==                                      ]                                                                 5.305% [==                                      ]                                                                 5.405% [==                                      ]                                                                 5.506% [==                                      ]                                                                 5.606% [==                                      ]                                                                 5.706% [==                                      ]                                                                 5.806% [==                                      ]                                                                 5.906% [==                                      ]                                                                 6.006% [==                                      ]                                                                 6.106% [==                                      ]                                                                 6.206% [==                                      ]                                                                 6.306% [===                                     ]                                                                 6.406% [===                                     ]                                                                 6.507% [===                                     ]                                                                 6.607% [===                                     ]                                                                 6.707% [===                                     ]                                                                 6.807% [===                                     ]                                                                 6.907% [===                                     ]                                                                 7.007% [===                                     ]                                                                 7.107% [===                                     ]                                                                 7.207% [===                                     ]                                                                 7.307% [===                                     ]                                                                 7.407% [===                                     ]                                                                 7.508% [===                                     ]                                                                 7.608% [===                                     ]                                                                 7.708% [===                                     ]                                                                 7.808% [===                                     ]                                                                 7.908% [===                                     ]                                                                 8.008% [===                                     ]                                                                 8.108% [===                                     ]                                                                 8.208% [===                                     ]                                                                 8.308% [===                                     ]                                                                 8.408% [===                                     ]                                                                 8.509% [===                                     ]                                                                 8.609% [===                                     ]                                                                 8.709% [===                                     ]                                                                 8.809% [====                                    ]                                                                 8.909% [====                                    ]                                                                 9.009% [====                                    ]                                                                 9.109% [====                                    ]                                                                 9.209% [====                                    ]                                                                 9.309% [====                                    ]                                                                 9.409% [====                                    ]                                                                 9.510% [====                                    ]                                                                 9.610% [====                                    ]                                                                 9.710% [====                                    ]                                                                 9.810% [====                                    ]                                                                 9.910% [====                                    ]                                                                 10.010% [====                                    ]                                                                 10.110% [====                                    ]                                                                 10.210% [====                                    ]                                                                 10.310% [====                                    ]                                                                 10.410% [====                                    ]                                                                 10.511% [====                                    ]                                                                 10.611% [====                                    ]                                                                 10.711% [====                                    ]                                                                 10.811% [====                                    ]                                                                 10.911% [====                                    ]                                                                 11.011% [====                                    ]                                                                 11.111% [====                                    ]                                                                 11.211% [====                                    ]                                                                 11.311% [=====                                   ]                                                                 11.411% [=====                                   ]                                                                 11.512% [=====                                   ]                                                                 11.612% [=====                                   ]                                                                 11.712% [=====                                   ]                                                                 11.812% [=====                                   ]                                                                 11.912% [=====                                   ]                                                                 12.012% [=====                                   ]                                                                 12.112% [=====                                   ]                                                                 12.212% [=====                                   ]                                                                 12.312% [=====                                   ]                                                                 12.412% [=====                                   ]                                                                 12.513% [=====                                   ]                                                                 12.613% [=====                                   ]                                                                 12.713% [=====                                   ]                                                                 12.813% [=====                                   ]                                                                 12.913% [=====                                   ]                                                                 13.013% [=====                                   ]                                                                 13.113% [=====                                   ]                                                                 13.213% [=====                                   ]                                                                 13.313% [=====                                   ]                                                                 13.413% [=====                                   ]                                                                 13.514% [=====                                   ]                                                                 13.614% [=====                                   ]                                                                 13.714% [=====                                   ]                                                                 13.814% [======                                  ]                                                                 13.914% [======                                  ]                                                                 14.014% [======                                  ]                                                                 14.114% [======                                  ]                                                                 14.214% [======                                  ]                                                                 14.314% [======                                  ]                                                                 14.414% [======                                  ]                                                                 14.515% [======                                  ]                                                                 14.615% [======                                  ]                                                                 14.715% [======                                  ]                                                                 14.815% [======                                  ]                                                                 14.915% [======                                  ]                                                                 15.015% [======                                  ]                                                                 15.115% [======                                  ]                                                                 15.215% [======                                  ]                                                                 15.315% [======                                  ]                                                                 15.415% [======                                  ]                                                                 15.516% [======                                  ]                                                                 15.616% [======                                  ]                                                                 15.716% [======                                  ]                                                                 15.816% [======                                  ]                                                                 15.916% [======                                  ]                                                                 16.016% [======                                  ]                                                                 16.116% [======                                  ]                                                                 16.216% [======                                  ]                                                                 16.316% [=======                                 ]                                                                 16.416% [=======                                 ]                                                                 16.517% [=======                                 ]                                                                 16.617% [=======                                 ]                                                                 16.717% [=======                                 ]                                                                 16.817% [=======                                 ]                                                                 16.917% [=======                                 ]                                                                 17.017% [=======                                 ]                                                                 17.117% [=======                                 ]                                                                 17.217% [=======                                 ]                                                                 17.317% [=======                                 ]                                                                 17.417% [=======                                 ]                                                                 17.518% [=======                                 ]                                                                 17.618% [=======                                 ]                                                                 17.718% [=======                                 ]                                                                 17.818% [=======                                 ]                                                                 17.918% [=======                                 ]                                                                 18.018% [=======                                 ]                                                                 18.118% [=======                                 ]                                                                 18.218% [=======                                 ]                                                                 18.318% [=======                                 ]                                                                 18.418% [=======                                 ]                                                                 18.519% [=======                                 ]                                                                 18.619% [=======                                 ]                                                                 18.719% [=======                                 ]                                                                 18.819% [========                                ]                                                                 18.919% [========                                ]                                                                 19.019% [========                                ]                                                                 19.119% [========                                ]                                                                 19.219% [========                                ]                                                                 19.319% [========                                ]                                                                 19.419% [========                                ]                                                                 19.520% [========                                ]                                                                 19.620% [========                                ]                                                                 19.720% [========                                ]                                                                 19.820% [========                                ]                                                                 19.920% [========                                ]                                                                 20.020% [========                                ]                                                                 20.120% [========                                ]                                                                 20.220% [========                                ]                                                                 20.320% [========                                ]                                                                 20.420% [========                                ]                                                                 20.521% [========                                ]                                                                 20.621% [========                                ]                                                                 20.721% [========                                ]                                                                 20.821% [========                                ]                                                                 20.921% [========                                ]                                                                 21.021% [========                                ]                                                                 21.121% [========                                ]                                                                 21.221% [========                                ]                                                                 21.321% [=========                               ]                                                                 21.421% [=========                               ]                                                                 21.522% [=========                               ]                                                                 21.622% [=========                               ]                                                                 21.722% [=========                               ]                                                                 21.822% [=========                               ]                                                                 21.922% [=========                               ]                                                                 22.022% [=========                               ]                                                                 22.122% [=========                               ]                                                                 22.222% [=========                               ]                                                                 22.322% [=========                               ]                                                                 22.422% [=========                               ]                                                                 22.523% [=========                               ]                                                                 22.623% [=========                               ]                                                                 22.723% [=========                               ]                                                                 22.823% [=========                               ]                                                                 22.923% [=========                               ]                                                                 23.023% [=========                               ]                                                                 23.123% [=========                               ]                                                                 23.223% [=========                               ]                                                                 23.323% [=========                               ]                                                                 23.423% [=========                               ]                                                                 23.524% [=========                               ]                                                                 23.624% [=========                               ]                                                                 23.724% [=========                               ]                                                                 23.824% [==========                              ]                                                                 23.924% [==========                              ]                                                                 24.024% [==========                              ]                                                                 24.124% [==========                              ]                                                                 24.224% [==========                              ]                                                                 24.324% [==========                              ]                                                                 24.424% [==========                              ]                                                                 24.525% [==========                              ]                                                                 24.625% [==========                              ]                                                                 24.725% [==========                              ]                                                                 24.825% [==========                              ]                                                                 24.925% [==========                              ]                                                                 25.025% [==========                              ]                                                                 25.125% [==========                              ]                                                                 25.225% [==========                              ]                                                                 25.325% [==========                              ]                                                                 25.425% [==========                              ]                                                                 25.526% [==========                              ]                                                                 25.626% [==========                              ]                                                                 25.726% [==========                              ]                                                                 25.826% [==========                              ]                                                                 25.926% [==========                              ]                                                                 26.026% [==========                              ]                                                                 26.126% [==========                              ]                                                                 26.226% [==========                              ]                                                                 26.326% [===========                             ]                                                                 26.426% [===========                             ]                                                                 26.527% [===========                             ]                                                                 26.627% [===========                             ]                                                                 26.727% [===========                             ]                                                                 26.827% [===========                             ]                                                                 26.927% [===========                             ]                                                                 27.027% [===========                             ]                                                                 27.127% [===========                             ]                                                                 27.227% [===========                             ]                                                                 27.327% [===========                             ]                                                                 27.427% [===========                             ]                                                                 27.528% [===========                             ]                                                                 27.628% [===========                             ]                                                                 27.728% [===========                             ]                                                                 27.828% [===========                             ]                                                                 27.928% [===========                             ]                                                                 28.028% [===========                             ]                                                                 28.128% [===========                             ]                                                                 28.228% [===========                             ]                                                                 28.328% [===========                             ]                                                                 28.428% [===========                             ]                                                                 28.529% [===========                             ]                                                                 28.629% [===========                             ]                                                                 28.729% [===========                             ]                                                                 28.829% [============                            ]                                                                 28.929% [============                            ]                                                                 29.029% [============                            ]                                                                 29.129% [============                            ]                                                                 29.229% [============                            ]                                                                 29.329% [============                            ]                                                                 29.429% [============                            ]                                                                 29.530% [============                            ]                                                                 29.630% [============                            ]                                                                 29.730% [============                            ]                                                                 29.830% [============                            ]                                                                 29.930% [============                            ]                                                                 30.030% [============                            ]                                                                 30.130% [============                            ]                                                                 30.230% [============                            ]                                                                 30.330% [============                            ]                                                                 30.430% [============                            ]                                                                 30.531% [============                            ]                                                                 30.631% [============                            ]                                                                 30.731% [============                            ]                                                                 30.831% [============                            ]                                                                 30.931% [============                            ]                                                                 31.031% [============                            ]                                                                 31.131% [============                            ]                                                                 31.231% [============                            ]                                                                 31.331% [=============                           ]                                                                 31.431% [=============                           ]                                                                 31.532% [=============                           ]                                                                 31.632% [=============                           ]                                                                 31.732% [=============                           ]                                                                 31.832% [=============                           ]                                                                 31.932% [=============                           ]                                                                 32.032% [=============                           ]                                                                 32.132% [=============                           ]                                                                 32.232% [=============                           ]                                                                 32.332% [=============                           ]                                                                 32.432% [=============                           ]                                                                 32.533% [=============                           ]                                                                 32.633% [=============                           ]                                                                 32.733% [=============                           ]                                                                 32.833% [=============                           ]                                                                 32.933% [=============                           ]                                                                 33.033% [=============                           ]                                                                 33.133% [=============                           ]                                                                 33.233% [=============                           ]                                                                 33.333% [=============                           ]                                                                 33.433% [=============                           ]                                                                 33.534% [=============                           ]                                                                 33.634% [=============                           ]                                                                 33.734% [=============                           ]                                                                 33.834% [==============                          ]                                                                 33.934% [==============                          ]                                                                 34.034% [==============                          ]                                                                 34.134% [==============                          ]                                                                 34.234% [==============                          ]                                                                 34.334% [==============                          ]                                                                 34.434% [==============                          ]                                                                 34.535% [==============                          ]                                                                 34.635% [==============                          ]                                                                 34.735% [==============                          ]                                                                 34.835% [==============                          ]                                                                 34.935% [==============                          ]                                                                 35.035% [==============                          ]                                                                 35.135% [==============                          ]                                                                 35.235% [==============                          ]                                                                 35.335% [==============                          ]                                                                 35.435% [==============                          ]                                                                 35.536% [==============                          ]                                                                 35.636% [==============                          ]                                                                 35.736% [==============                          ]                                                                 35.836% [==============                          ]                                                                 35.936% [==============                          ]                                                                 36.036% [==============                          ]                                                                 36.136% [==============                          ]                                                                 36.236% [==============                          ]                                                                 36.336% [===============                         ]                                                                 36.436% [===============                         ]                                                                 36.537% [===============                         ]                                                                 36.637% [===============                         ]                                                                 36.737% [===============                         ]                                                                 36.837% [===============                         ]                                                                 36.937% [===============                         ]                                                                 37.037% [===============                         ]                                                                 37.137% [===============                         ]                                                                 37.237% [===============                         ]                                                                 37.337% [===============                         ]                                                                 37.437% [===============                         ]                                                                 37.538% [===============                         ]                                                                 37.638% [===============                         ]                                                                 37.738% [===============                         ]                                                                 37.838% [===============                         ]                                                                 37.938% [===============                         ]                                                                 38.038% [===============                         ]                                                                 38.138% [===============                         ]                                                                 38.238% [===============                         ]                                                                 38.338% [===============                         ]                                                                 38.438% [===============                         ]                                                                 38.539% [===============                         ]                                                                 38.639% [===============                         ]                                                                 38.739% [===============                         ]                                                                 38.839% [================                        ]                                                                 38.939% [================                        ]                                                                 39.039% [================                        ]                                                                 39.139% [================                        ]                                                                 39.239% [================                        ]                                                                 39.339% [================                        ]                                                                 39.439% [================                        ]                                                                 39.540% [================                        ]                                                                 39.640% [================                        ]                                                                 39.740% [================                        ]                                                                 39.840% [================                        ]                                                                 39.940% [================                        ]                                                                 40.040% [================                        ]                                                                 40.140% [================                        ]                                                                 40.240% [================                        ]                                                                 40.340% [================                        ]                                                                 40.440% [================                        ]                                                                 40.541% [================                        ]                                                                 40.641% [================                        ]                                                                 40.741% [================                        ]                                                                 40.841% [================                        ]                                                                 40.941% [================                        ]                                                                 41.041% [================                        ]                                                                 41.141% [================                        ]                                                                 41.241% [================                        ]                                                                 41.341% [=================                       ]                                                                 41.441% [=================                       ]                                                                 41.542% [=================                       ]                                                                 41.642% [=================                       ]                                                                 41.742% [=================                       ]                                                                 41.842% [=================                       ]                                                                 41.942% [=================                       ]                                                                 42.042% [=================                       ]                                                                 42.142% [=================                       ]                                                                 42.242% [=================                       ]                                                                 42.342% [=================                       ]                                                                 42.442% [=================                       ]                                                                 42.543% [=================                       ]                                                                 42.643% [=================                       ]                                                                 42.743% [=================                       ]                                                                 42.843% [=================                       ]                                                                 42.943% [=================                       ]                                                                 43.043% [=================                       ]                                                                 43.143% [=================                       ]                                                                 43.243% [=================                       ]                                                                 43.343% [=================                       ]                                                                 43.443% [=================                       ]                                                                 43.544% [=================                       ]                                                                 43.644% [=================                       ]                                                                 43.744% [=================                       ]                                                                 43.844% [==================                      ]                                                                 43.944% [==================                      ]                                                                 44.044% [==================                      ]                                                                 44.144% [==================                      ]                                                                 44.244% [==================                      ]                                                                 44.344% [==================                      ]                                                                 44.444% [==================                      ]                                                                 44.545% [==================                      ]                                                                 44.645% [==================                      ]                                                                 44.745% [==================                      ]                                                                 44.845% [==================                      ]                                                                 44.945% [==================                      ]                                                                 45.045% [==================                      ]                                                                 45.145% [==================                      ]                                                                 45.245% [==================                      ]                                                                 45.345% [==================                      ]                                                                 45.445% [==================                      ]                                                                 45.546% [==================                      ]                                                                 45.646% [==================                      ]                                                                 45.746% [==================                      ]                                                                 45.846% [==================                      ]                                                                 45.946% [==================                      ]                                                                 46.046% [==================                      ]                                                                 46.146% [==================                      ]                                                                 46.246% [==================                      ]                                                                 46.346% [===================                     ]                                                                 46.446% [===================                     ]                                                                 46.547% [===================                     ]                                                                 46.647% [===================                     ]                                                                 46.747% [===================                     ]                                                                 46.847% [===================                     ]                                                                 46.947% [===================                     ]                                                                 47.047% [===================                     ]                                                                 47.147% [===================                     ]                                                                 47.247% [===================                     ]                                                                 47.347% [===================                     ]                                                                 47.447% [===================                     ]                                                                 47.548% [===================                     ]                                                                 47.648% [===================                     ]                                                                 47.748% [===================                     ]                                                                 47.848% [===================                     ]                                                                 47.948% [===================                     ]                                                                 48.048% [===================                     ]                                                                 48.148% [===================                     ]                                                                 48.248% [===================                     ]                                                                 48.348% [===================                     ]                                                                 48.448% [===================                     ]                                                                 48.549% [===================                     ]                                                                 48.649% [===================                     ]                                                                 48.749% [===================                     ]                                                                 48.849% [====================                    ]                                                                 48.949% [====================                    ]                                                                 49.049% [====================                    ]                                                                 49.149% [====================                    ]                                                                 49.249% [====================                    ]                                                                 49.349% [====================                    ]                                                                 49.449% [====================                    ]                                                                 49.550% [====================                    ]                                                                 49.650% [====================                    ]                                                                 49.750% [====================                    ]                                                                 49.850% [====================                    ]                                                                 49.950% [====================                    ]                                                                 50.050% [====================                    ]                                                                 50.150% [====================                    ]                                                                 50.250% [====================                    ]                                                                 50.350% [====================                    ]                                                                 50.450% [====================                    ]                                                                 50.551% [====================                    ]                                                                 50.651% [====================                    ]                                                                 50.751% [====================                    ]                                                                 50.851% [====================                    ]                                                                 50.951% [====================                    ]                                                                 51.051% [====================                    ]                                                                 51.151% [====================                    ]                                                                 51.251% [=====================                   ]                                                                 51.351% [=====================                   ]                                                                 51.451% [=====================                   ]                                                                 51.552% [=====================                   ]                                                                 51.652% [=====================                   ]                                                                 51.752% [=====================                   ]                                                                 51.852% [=====================                   ]                                                                 51.952% [=====================                   ]                                                                 52.052% [=====================                   ]                                                                 52.152% [=====================                   ]                                                                 52.252% [=====================                   ]                                                                 52.352% [=====================                   ]                                                                 52.452% [=====================                   ]                                                                 52.553% [=====================                   ]                                                                 52.653% [=====================                   ]                                                                 52.753% [=====================                   ]                                                                 52.853% [=====================                   ]                                                                 52.953% [=====================                   ]                                                                 53.053% [=====================                   ]                                                                 53.153% [=====================                   ]                                                                 53.253% [=====================                   ]                                                                 53.353% [=====================                   ]                                                                 53.453% [=====================                   ]                                                                 53.554% [=====================                   ]                                                                 53.654% [=====================                   ]                                                                 53.754% [======================                  ]                                                                 53.854% [======================                  ]                                                                 53.954% [======================                  ]                                                                 54.054% [======================                  ]                                                                 54.154% [======================                  ]                                                                 54.254% [======================                  ]                                                                 54.354% [======================                  ]                                                                 54.454% [======================                  ]                                                                 54.555% [======================                  ]                                                                 54.655% [======================                  ]                                                                 54.755% [======================                  ]                                                                 54.855% [======================                  ]                                                                 54.955% [======================                  ]                                                                 55.055% [======================                  ]                                                                 55.155% [======================                  ]                                                                 55.255% [======================                  ]                                                                 55.355% [======================                  ]                                                                 55.455% [======================                  ]                                                                 55.556% [======================                  ]                                                                 55.656% [======================                  ]                                                                 55.756% [======================                  ]                                                                 55.856% [======================                  ]                                                                 55.956% [======================                  ]                                                                 56.056% [======================                  ]                                                                 56.156% [======================                  ]                                                                 56.256% [=======================                 ]                                                                 56.356% [=======================                 ]                                                                 56.456% [=======================                 ]                                                                 56.557% [=======================                 ]                                                                 56.657% [=======================                 ]                                                                 56.757% [=======================                 ]                                                                 56.857% [=======================                 ]                                                                 56.957% [=======================                 ]                                                                 57.057% [=======================                 ]                                                                 57.157% [=======================                 ]                                                                 57.257% [=======================                 ]                                                                 57.357% [=======================                 ]                                                                 57.457% [=======================                 ]                                                                 57.558% [=======================                 ]                                                                 57.658% [=======================                 ]                                                                 57.758% [=======================                 ]                                                                 57.858% [=======================                 ]                                                                 57.958% [=======================                 ]                                                                 58.058% [=======================                 ]                                                                 58.158% [=======================                 ]                                                                 58.258% [=======================                 ]                                                                 58.358% [=======================                 ]                                                                 58.458% [=======================                 ]                                                                 58.559% [=======================                 ]                                                                 58.659% [=======================                 ]                                                                 58.759% [========================                ]                                                                 58.859% [========================                ]                                                                 58.959% [========================                ]                                                                 59.059% [========================                ]                                                                 59.159% [========================                ]                                                                 59.259% [========================                ]                                                                 59.359% [========================                ]                                                                 59.459% [========================                ]                                                                 59.560% [========================                ]                                                                 59.660% [========================                ]                                                                 59.760% [========================                ]                                                                 59.860% [========================                ]                                                                 59.960% [========================                ]                                                                 60.060% [========================                ]                                                                 60.160% [========================                ]                                                                 60.260% [========================                ]                                                                 60.360% [========================                ]                                                                 60.460% [========================                ]                                                                 60.561% [========================                ]                                                                 60.661% [========================                ]                                                                 60.761% [========================                ]                                                                 60.861% [========================                ]                                                                 60.961% [========================                ]                                                                 61.061% [========================                ]                                                                 61.161% [========================                ]                                                                 61.261% [=========================               ]                                                                 61.361% [=========================               ]                                                                 61.461% [=========================               ]                                                                 61.562% [=========================               ]                                                                 61.662% [=========================               ]                                                                 61.762% [=========================               ]                                                                 61.862% [=========================               ]                                                                 61.962% [=========================               ]                                                                 62.062% [=========================               ]                                                                 62.162% [=========================               ]                                                                 62.262% [=========================               ]                                                                 62.362% [=========================               ]                                                                 62.462% [=========================               ]                                                                 62.563% [=========================               ]                                                                 62.663% [=========================               ]                                                                 62.763% [=========================               ]                                                                 62.863% [=========================               ]                                                                 62.963% [=========================               ]                                                                 63.063% [=========================               ]                                                                 63.163% [=========================               ]                                                                 63.263% [=========================               ]                                                                 63.363% [=========================               ]                                                                 63.463% [=========================               ]                                                                 63.564% [=========================               ]                                                                 63.664% [=========================               ]                                                                 63.764% [==========================              ]                                                                 63.864% [==========================              ]                                                                 63.964% [==========================              ]                                                                 64.064% [==========================              ]                                                                 64.164% [==========================              ]                                                                 64.264% [==========================              ]                                                                 64.364% [==========================              ]                                                                 64.464% [==========================              ]                                                                 64.565% [==========================              ]                                                                 64.665% [==========================              ]                                                                 64.765% [==========================              ]                                                                 64.865% [==========================              ]                                                                 64.965% [==========================              ]                                                                 65.065% [==========================              ]                                                                 65.165% [==========================              ]                                                                 65.265% [==========================              ]                                                                 65.365% [==========================              ]                                                                 65.465% [==========================              ]                                                                 65.566% [==========================              ]                                                                 65.666% [==========================              ]                                                                 65.766% [==========================              ]                                                                 65.866% [==========================              ]                                                                 65.966% [==========================              ]                                                                 66.066% [==========================              ]                                                                 66.166% [==========================              ]                                                                 66.266% [===========================             ]                                                                 66.366% [===========================             ]                                                                 66.466% [===========================             ]                                                                 66.567% [===========================             ]                                                                 66.667% [===========================             ]                                                                 66.767% [===========================             ]                                                                 66.867% [===========================             ]                                                                 66.967% [===========================             ]                                                                 67.067% [===========================             ]                                                                 67.167% [===========================             ]                                                                 67.267% [===========================             ]                                                                 67.367% [===========================             ]                                                                 67.467% [===========================             ]                                                                 67.568% [===========================             ]                                                                 67.668% [===========================             ]                                                                 67.768% [===========================             ]                                                                 67.868% [===========================             ]                                                                 67.968% [===========================             ]                                                                 68.068% [===========================             ]                                                                 68.168% [===========================             ]                                                                 68.268% [===========================             ]                                                                 68.368% [===========================             ]                                                                 68.468% [===========================             ]                                                                 68.569% [===========================             ]                                                                 68.669% [===========================             ]                                                                 68.769% [============================            ]                                                                 68.869% [============================            ]                                                                 68.969% [============================            ]                                                                 69.069% [============================            ]                                                                 69.169% [============================            ]                                                                 69.269% [============================            ]                                                                 69.369% [============================            ]                                                                 69.469% [============================            ]                                                                 69.570% [============================            ]                                                                 69.670% [============================            ]                                                                 69.770% [============================            ]                                                                 69.870% [============================            ]                                                                 69.970% [============================            ]                                                                 70.070% [============================            ]                                                                 70.170% [============================            ]                                                                 70.270% [============================            ]                                                                 70.370% [============================            ]                                                                 70.470% [============================            ]                                                                 70.571% [============================            ]                                                                 70.671% [============================            ]                                                                 70.771% [============================            ]                                                                 70.871% [============================            ]                                                                 70.971% [============================            ]                                                                 71.071% [============================            ]                                                                 71.171% [============================            ]                                                                 71.271% [=============================           ]                                                                 71.371% [=============================           ]                                                                 71.471% [=============================           ]                                                                 71.572% [=============================           ]                                                                 71.672% [=============================           ]                                                                 71.772% [=============================           ]                                                                 71.872% [=============================           ]                                                                 71.972% [=============================           ]                                                                 72.072% [=============================           ]                                                                 72.172% [=============================           ]                                                                 72.272% [=============================           ]                                                                 72.372% [=============================           ]                                                                 72.472% [=============================           ]                                                                 72.573% [=============================           ]                                                                 72.673% [=============================           ]                                                                 72.773% [=============================           ]                                                                 72.873% [=============================           ]                                                                 72.973% [=============================           ]                                                                 73.073% [=============================           ]                                                                 73.173% [=============================           ]                                                                 73.273% [=============================           ]                                                                 73.373% [=============================           ]                                                                 73.473% [=============================           ]                                                                 73.574% [=============================           ]                                                                 73.674% [=============================           ]                                                                 73.774% [==============================          ]                                                                 73.874% [==============================          ]                                                                 73.974% [==============================          ]                                                                 74.074% [==============================          ]                                                                 74.174% [==============================          ]                                                                 74.274% [==============================          ]                                                                 74.374% [==============================          ]                                                                 74.474% [==============================          ]                                                                 74.575% [==============================          ]                                                                 74.675% [==============================          ]                                                                 74.775% [==============================          ]                                                                 74.875% [==============================          ]                                                                 74.975% [==============================          ]                                                                 75.075% [==============================          ]                                                                 75.175% [==============================          ]                                                                 75.275% [==============================          ]                                                                 75.375% [==============================          ]                                                                 75.475% [==============================          ]                                                                 75.576% [==============================          ]                                                                 75.676% [==============================          ]                                                                 75.776% [==============================          ]                                                                 75.876% [==============================          ]                                                                 75.976% [==============================          ]                                                                 76.076% [==============================          ]                                                                 76.176% [==============================          ]                                                                 76.276% [===============================         ]                                                                 76.376% [===============================         ]                                                                 76.476% [===============================         ]                                                                 76.577% [===============================         ]                                                                 76.677% [===============================         ]                                                                 76.777% [===============================         ]                                                                 76.877% [===============================         ]                                                                 76.977% [===============================         ]                                                                 77.077% [===============================         ]                                                                 77.177% [===============================         ]                                                                 77.277% [===============================         ]                                                                 77.377% [===============================         ]                                                                 77.477% [===============================         ]                                                                 77.578% [===============================         ]                                                                 77.678% [===============================         ]                                                                 77.778% [===============================         ]                                                                 77.878% [===============================         ]                                                                 77.978% [===============================         ]                                                                 78.078% [===============================         ]                                                                 78.178% [===============================         ]                                                                 78.278% [===============================         ]                                                                 78.378% [===============================         ]                                                                 78.478% [===============================         ]                                                                 78.579% [===============================         ]                                                                 78.679% [===============================         ]                                                                 78.779% [================================        ]                                                                 78.879% [================================        ]                                                                 78.979% [================================        ]                                                                 79.079% [================================        ]                                                                 79.179% [================================        ]                                                                 79.279% [================================        ]                                                                 79.379% [================================        ]                                                                 79.479% [================================        ]                                                                 79.580% [================================        ]                                                                 79.680% [================================        ]                                                                 79.780% [================================        ]                                                                 79.880% [================================        ]                                                                 79.980% [================================        ]                                                                 80.080% [================================        ]                                                                 80.180% [================================        ]                                                                 80.280% [================================        ]                                                                 80.380% [================================        ]                                                                 80.480% [================================        ]                                                                 80.581% [================================        ]                                                                 80.681% [================================        ]                                                                 80.781% [================================        ]                                                                 80.881% [================================        ]                                                                 80.981% [================================        ]                                                                 81.081% [================================        ]                                                                 81.181% [================================        ]                                                                 81.281% [=================================       ]                                                                 81.381% [=================================       ]                                                                 81.481% [=================================       ]                                                                 81.582% [=================================       ]                                                                 81.682% [=================================       ]                                                                 81.782% [=================================       ]                                                                 81.882% [=================================       ]                                                                 81.982% [=================================       ]                                                                 82.082% [=================================       ]                                                                 82.182% [=================================       ]                                                                 82.282% [=================================       ]                                                                 82.382% [=================================       ]                                                                 82.482% [=================================       ]                                                                 82.583% [=================================       ]                                                                 82.683% [=================================       ]                                                                 82.783% [=================================       ]                                                                 82.883% [=================================       ]                                                                 82.983% [=================================       ]                                                                 83.083% [=================================       ]                                                                 83.183% [=================================       ]                                                                 83.283% [=================================       ]                                                                 83.383% [=================================       ]                                                                 83.483% [=================================       ]                                                                 83.584% [=================================       ]                                                                 83.684% [=================================       ]                                                                 83.784% [==================================      ]                                                                 83.884% [==================================      ]                                                                 83.984% [==================================      ]                                                                 84.084% [==================================      ]                                                                 84.184% [==================================      ]                                                                 84.284% [==================================      ]                                                                 84.384% [==================================      ]                                                                 84.484% [==================================      ]                                                                 84.585% [==================================      ]                                                                 84.685% [==================================      ]                                                                 84.785% [==================================      ]                                                                 84.885% [==================================      ]                                                                 84.985% [==================================      ]                                                                 85.085% [==================================      ]                                                                 85.185% [==================================      ]                                                                 85.285% [==================================      ]                                                                 85.385% [==================================      ]                                                                 85.485% [==================================      ]                                                                 85.586% [==================================      ]                                                                 85.686% [==================================      ]                                                                 85.786% [==================================      ]                                                                 85.886% [==================================      ]                                                                 85.986% [==================================      ]                                                                 86.086% [==================================      ]                                                                 86.186% [==================================      ]                                                                 86.286% [===================================     ]                                                                 86.386% [===================================     ]                                                                 86.486% [===================================     ]                                                                 86.587% [===================================     ]                                                                 86.687% [===================================     ]                                                                 86.787% [===================================     ]                                                                 86.887% [===================================     ]                                                                 86.987% [===================================     ]                                                                 87.087% [===================================     ]                                                                 87.187% [===================================     ]                                                                 87.287% [===================================     ]                                                                 87.387% [===================================     ]                                                                 87.487% [===================================     ]                                                                 87.588% [===================================     ]                                                                 87.688% [===================================     ]                                                                 87.788% [===================================     ]                                                                 87.888% [===================================     ]                                                                 87.988% [===================================     ]                                                                 88.088% [===================================     ]                                                                 88.188% [===================================     ]                                                                 88.288% [===================================     ]                                                                 88.388% [===================================     ]                                                                 88.488% [===================================     ]                                                                 88.589% [===================================     ]                                                                 88.689% [===================================     ]                                                                 88.789% [====================================    ]                                                                 88.889% [====================================    ]                                                                 88.989% [====================================    ]                                                                 89.089% [====================================    ]                                                                 89.189% [====================================    ]                                                                 89.289% [====================================    ]                                                                 89.389% [====================================    ]                                                                 89.489% [====================================    ]                                                                 89.590% [====================================    ]                                                                 89.690% [====================================    ]                                                                 89.790% [====================================    ]                                                                 89.890% [====================================    ]                                                                 89.990% [====================================    ]                                                                 90.090% [====================================    ]                                                                 90.190% [====================================    ]                                                                 90.290% [====================================    ]                                                                 90.390% [====================================    ]                                                                 90.490% [====================================    ]                                                                 90.591% [====================================    ]                                                                 90.691% [====================================    ]                                                                 90.791% [====================================    ]                                                                 90.891% [====================================    ]                                                                 90.991% [====================================    ]                                                                 91.091% [====================================    ]                                                                 91.191% [====================================    ]                                                                 91.291% [=====================================   ]                                                                 91.391% [=====================================   ]                                                                 91.491% [=====================================   ]                                                                 91.592% [=====================================   ]                                                                 91.692% [=====================================   ]                                                                 91.792% [=====================================   ]                                                                 91.892% [=====================================   ]                                                                 91.992% [=====================================   ]                                                                 92.092% [=====================================   ]                                                                 92.192% [=====================================   ]                                                                 92.292% [=====================================   ]                                                                 92.392% [=====================================   ]                                                                 92.492% [=====================================   ]                                                                 92.593% [=====================================   ]                                                                 92.693% [=====================================   ]                                                                 92.793% [=====================================   ]                                                                 92.893% [=====================================   ]                                                                 92.993% [=====================================   ]                                                                 93.093% [=====================================   ]                                                                 93.193% [=====================================   ]                                                                 93.293% [=====================================   ]                                                                 93.393% [=====================================   ]                                                                 93.493% [=====================================   ]                                                                 93.594% [=====================================   ]                                                                 93.694% [=====================================   ]                                                                 93.794% [======================================  ]                                                                 93.894% [======================================  ]                                                                 93.994% [======================================  ]                                                                 94.094% [======================================  ]                                                                 94.194% [======================================  ]                                                                 94.294% [======================================  ]                                                                 94.394% [======================================  ]                                                                 94.494% [======================================  ]                                                                 94.595% [======================================  ]                                                                 94.695% [======================================  ]                                                                 94.795% [======================================  ]                                                                 94.895% [======================================  ]                                                                 94.995% [======================================  ]                                                                 95.095% [======================================  ]                                                                 95.195% [======================================  ]                                                                 95.295% [======================================  ]                                                                 95.395% [======================================  ]                                                                 95.495% [======================================  ]                                                                 95.596% [======================================  ]                                                                 95.696% [======================================  ]                                                                 95.796% [======================================  ]                                                                 95.896% [======================================  ]                                                                 95.996% [======================================  ]                                                                 96.096% [======================================  ]                                                                 96.196% [======================================  ]                                                                 96.296% [======================================= ]                                                                 96.396% [======================================= ]                                                                 96.496% [======================================= ]                                                                 96.597% [======================================= ]                                                                 96.697% [======================================= ]                                                                 96.797% [======================================= ]                                                                 96.897% [======================================= ]                                                                 96.997% [======================================= ]                                                                 97.097% [======================================= ]                                                                 97.197% [======================================= ]                                                                 97.297% [======================================= ]                                                                 97.397% [======================================= ]                                                                 97.497% [======================================= ]                                                                 97.598% [======================================= ]                                                                 97.698% [======================================= ]                                                                 97.798% [======================================= ]                                                                 97.898% [======================================= ]                                                                 97.998% [======================================= ]                                                                 98.098% [======================================= ]                                                                 98.198% [======================================= ]                                                                 98.298% [======================================= ]                                                                 98.398% [======================================= ]                                                                 98.498% [======================================= ]                                                                 98.599% [======================================= ]                                                                 98.699% [======================================= ]                                                                 98.799% [========================================]                                                                 98.899% [========================================]                                                                 98.999% [========================================]                                                                 99.099% [========================================]                                                                 99.199% [========================================]                                                                 99.299% [========================================]                                                                 99.399% [========================================]                                                                 99.499% [========================================]                                                                 99.600% [========================================]                                                                 99.700% [========================================]                                                                 99.800% [========================================]                                                                 99.900% [========================================]                                                                 100.000% [========================================]
>  proc.time()-ptm
   user  system elapsed 
   0.51    0.03    0.61 
> 
>  
>  
>  
>  
>  
> 
> 
> 
> cleanEx()
> nameEx("rindependent_norm_gamma_reg")
> ### * rindependent_norm_gamma_reg
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: rindependent_norm_gamma_reg
> ### Title: The Bayesian Indendepent Normal-Gamma Regression Distribution
> ### Aliases: rindependent_norm_gamma_reg rindependent_norm_gamma_reg_v3
> ###   rindependent_norm_gamma_reg_v2 rindependent_norm_gamma_reg_v4
> 
> ### ** Examples
> 
> 
> ## Annette Dobson (1990) "An Introduction to Generalized Linear Models".
> ## Page 9: Plant Weight Data.
> ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
> trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
> group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
> weight <- c(ctl, trt)
> lm.D9 <- lm(weight ~ group,y=TRUE,x=TRUE)
> 
> p_setup=Prior_Setup(lm.D9)
[1] "Variable names are:"
[1] "(Intercept)" "groupTrt"   
> dispersion=sigma(lm.D9)^2
> 
> ## Initialize dispersion
> p=1/dispersion
> 
> mu=p_setup$mu
> Sigma_prior=p_setup$Sigma
> y=lm.D9$y
> x=lm.D9$x
> 
> Prior_Check(weight ~ group,gaussian(),dNormal(mu=mu,Sigma=Sigma_prior))
[1] "Variables in the Model Are:"
[1] "(Intercept)" "groupTrt"   
[1] "The maximum likelihood estimates for all coefficients appear to be roughly consistent with the prior."
             abs_ratio
(Intercept) 0.09242285
groupTrt    0.17198871
> 
> ## This simple "standardization" for the prior appears to 
> ## correct the issue with the prior
> 
> ## "Standardize" the prior for the intercept by setting the
> ## mean equal to the mean of the dependent variable
> ## and setting the variance equal to the variance of the dependent variable
> 
> mu[1,1]=mean(y)
> Sigma_prior[1,1]=var(y)
> 
> ## For factors, set the "standad prior to mean=0 and variance driven by the range
> ## of the dependent variable 
> 
> mu[2,1]=0
> Sigma_prior[2,2]=((max(y)-min(y))/1.96)^2
> 
> #Prior_Check(lm.D9,mu,Sigma_prior)
> Prior_Check(weight ~ group,gaussian(),dNormal(mu=mu,Sigma=Sigma_prior))
[1] "Variables in the Model Are:"
[1] "(Intercept)" "groupTrt"   
[1] "The maximum likelihood estimates for all coefficients appear to be roughly consistent with the prior."
            abs_ratio
(Intercept) 0.1220195
groupTrt    0.1412216
> 
> 
> #prior=list(mu=mu,Sigma=Sigma_prior,dispersion=dispersion)
> glmb.D9=glmb(weight~group, family=gaussian(),dNormal(mu=mu,Sigma=Sigma_prior,dispersion=dispersion))
> post_mode=glmb.D9$coef.mode
> 
> sum_out1=summary(glmb.D9)
> 
> ## Try mean one standard deviation away to see how it works
> #mu[1,1]=mu[1,1]-2*sum_out1$coefficients[1,3]
> #mu[2,1]=mu[2,1]+2*sum_out1$coefficients[1,3]
> 
> #prior=list(mu=mu,Sigma=Sigma_prior,dispersion=dispersion)
> 
> # Temporarily lower the prior variance
> Sigma_prior=1*Sigma_prior
> 
> glmb.D9_v2=glmb(n=1000,weight~group, family=gaussian(),
+ dNormal(mu=mu,Sigma=Sigma_prior,dispersion=dispersion))
> 
> n_prior=2
> shape=n_prior/2
> rate= dispersion*shape
> 
> 
> summary(glmb.D9)
Call
glmb(formula = weight ~ group, family = gaussian(), pfamily = dNormal(mu = mu, 
    Sigma = Sigma_prior, dispersion = dispersion))

Expected Deviance Residuals:
       1        2        3        4        5        6        7        8 
-0.82703  0.58297  0.18297  1.11297 -0.49703 -0.38703  0.17297 -0.46703 
       9       10       11       12       13       14       15       16 
 0.33297  0.14297  0.14334 -0.49666 -0.25666 -1.07666  1.20334 -0.83666 
      17       18       19       20 
 1.36334  0.22334 -0.34666  0.02334 

Prior and Maximum Likelihood Estimates with Standard Deviations

                mu Prior.sd Max Like. Like.sd
(Intercept)  4.846    0.704     5.032   0.220
groupTrt     0.000    1.286    -0.371   0.311

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean Post.Sd MC Error Pr(tail)
(Intercept)    5.0065    4.9970  0.2157        0    0.230
groupTrt      -0.3357   -0.3304  0.2981        0    0.138

Distribution Percentiles

               1.0%    2.5%    5.0%  Median   95.0%   97.5% 99.0%
(Intercept)  4.4942  4.5599  4.6494  4.9976  5.3407  5.4034 5.490
groupTrt    -1.0473 -0.9250 -0.8218 -0.3411  0.1751  0.2642 0.332

Effective Number of Parameters: 2.000945 
Expected Residual Deviance: 9.712176 
DIC: 21.48922 

Expected Mean dispersion: 0.4849583 
Sq.root of Expected Mean dispersion: 0.6963895 

Mean Likelihood Subgradient Candidates Per iid sample: 1 

> summary(glmb.D9_v2)
Call
glmb(formula = weight ~ group, family = gaussian(), pfamily = dNormal(mu = mu, 
    Sigma = Sigma_prior, dispersion = dispersion), n = 1000)

Expected Deviance Residuals:
       1        2        3        4        5        6        7        8 
-0.84611  0.56389  0.16389  1.09389 -0.51611 -0.40611  0.15389 -0.48611 
       9       10       11       12       13       14       15       16 
 0.31389  0.12389  0.13433 -0.50567 -0.26567 -1.08567  1.19433 -0.84567 
      17       18       19       20 
 1.35433  0.21433 -0.35567  0.01433 

Prior and Maximum Likelihood Estimates with Standard Deviations

                mu Prior.sd Max Like. Like.sd
(Intercept)  4.846    0.704     5.032   0.220
groupTrt     0.000    1.286    -0.371   0.311

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean Post.Sd MC Error Pr(tail)
(Intercept)    5.0065    5.0161  0.2117        0    0.216
groupTrt      -0.3357   -0.3404  0.3117        0    0.143

Distribution Percentiles

               1.0%    2.5%    5.0%  Median   95.0%   97.5% 99.0%
(Intercept)  4.5308  4.6134  4.6851  5.0101  5.3881  5.4511 5.504
groupTrt    -1.1137 -0.9720 -0.8620 -0.3455  0.1674  0.2538 0.323

Effective Number of Parameters: 1.988716 
Expected Residual Deviance: 9.698371 
DIC: 21.46948 

Expected Mean dispersion: 0.4849583 
Sq.root of Expected Mean dispersion: 0.6963895 

Mean Likelihood Subgradient Candidates Per iid sample: 1 

> 
> 
> #lm_out=lm(y ~ x-1) # returns same model
> RSS=sum(residuals(lm.D9)^2)
> 
> n_prior=4
> n_data=length(y)
> shape=(n_prior/2)
> rate=n_prior*RSS/n_data
> 
> 
> 
> prior_list=list(mu=mu,Sigma=Sigma_prior,dispersion=dispersion,
+                  shape=shape,rate=rate,Precision=solve(Sigma_prior))
> 
> 
> set.seed(360)
> 
>  ptm <- proc.time()
>  sim2=rindependent_norm_gamma_reg(n=1000,y,x,prior_list=prior_list,
+ offset=NULL,weights=1,max_disp_perc=0.99)
Starting Simulation:
                                                                 0.000% [                                        ]                                                                 0.100% [                                        ]                                                                 0.200% [                                        ]                                                                 0.300% [                                        ]                                                                 0.400% [                                        ]                                                                 0.501% [                                        ]                                                                 0.601% [                                        ]                                                                 0.701% [                                        ]                                                                 0.801% [                                        ]                                                                 0.901% [                                        ]                                                                 1.001% [                                        ]                                                                 1.101% [                                        ]                                                                 1.201% [                                        ]                                                                 1.301% [=                                       ]                                                                 1.401% [=                                       ]                                                                 1.502% [=                                       ]                                                                 1.602% [=                                       ]                                                                 1.702% [=                                       ]                                                                 1.802% [=                                       ]                                                                 1.902% [=                                       ]                                                                 2.002% [=                                       ]                                                                 2.102% [=                                       ]                                                                 2.202% [=                                       ]                                                                 2.302% [=                                       ]                                                                 2.402% [=                                       ]                                                                 2.503% [=                                       ]                                                                 2.603% [=                                       ]                                                                 2.703% [=                                       ]                                                                 2.803% [=                                       ]                                                                 2.903% [=                                       ]                                                                 3.003% [=                                       ]                                                                 3.103% [=                                       ]                                                                 3.203% [=                                       ]                                                                 3.303% [=                                       ]                                                                 3.403% [=                                       ]                                                                 3.504% [=                                       ]                                                                 3.604% [=                                       ]                                                                 3.704% [=                                       ]                                                                 3.804% [==                                      ]                                                                 3.904% [==                                      ]                                                                 4.004% [==                                      ]                                                                 4.104% [==                                      ]                                                                 4.204% [==                                      ]                                                                 4.304% [==                                      ]                                                                 4.404% [==                                      ]                                                                 4.505% [==                                      ]                                                                 4.605% [==                                      ]                                                                 4.705% [==                                      ]                                                                 4.805% [==                                      ]                                                                 4.905% [==                                      ]                                                                 5.005% [==                                      ]                                                                 5.105% [==                                      ]                                                                 5.205% [==                                      ]                                                                 5.305% [==                                      ]                                                                 5.405% [==                                      ]                                                                 5.506% [==                                      ]                                                                 5.606% [==                                      ]                                                                 5.706% [==                                      ]                                                                 5.806% [==                                      ]                                                                 5.906% [==                                      ]                                                                 6.006% [==                                      ]                                                                 6.106% [==                                      ]                                                                 6.206% [==                                      ]                                                                 6.306% [===                                     ]                                                                 6.406% [===                                     ]                                                                 6.507% [===                                     ]                                                                 6.607% [===                                     ]                                                                 6.707% [===                                     ]                                                                 6.807% [===                                     ]                                                                 6.907% [===                                     ]                                                                 7.007% [===                                     ]                                                                 7.107% [===                                     ]                                                                 7.207% [===                                     ]                                                                 7.307% [===                                     ]                                                                 7.407% [===                                     ]                                                                 7.508% [===                                     ]                                                                 7.608% [===                                     ]                                                                 7.708% [===                                     ]                                                                 7.808% [===                                     ]                                                                 7.908% [===                                     ]                                                                 8.008% [===                                     ]                                                                 8.108% [===                                     ]                                                                 8.208% [===                                     ]                                                                 8.308% [===                                     ]                                                                 8.408% [===                                     ]                                                                 8.509% [===                                     ]                                                                 8.609% [===                                     ]                                                                 8.709% [===                                     ]                                                                 8.809% [====                                    ]                                                                 8.909% [====                                    ]                                                                 9.009% [====                                    ]                                                                 9.109% [====                                    ]                                                                 9.209% [====                                    ]                                                                 9.309% [====                                    ]                                                                 9.409% [====                                    ]                                                                 9.510% [====                                    ]                                                                 9.610% [====                                    ]                                                                 9.710% [====                                    ]                                                                 9.810% [====                                    ]                                                                 9.910% [====                                    ]                                                                 10.010% [====                                    ]                                                                 10.110% [====                                    ]                                                                 10.210% [====                                    ]                                                                 10.310% [====                                    ]                                                                 10.410% [====                                    ]                                                                 10.511% [====                                    ]                                                                 10.611% [====                                    ]                                                                 10.711% [====                                    ]                                                                 10.811% [====                                    ]                                                                 10.911% [====                                    ]                                                                 11.011% [====                                    ]                                                                 11.111% [====                                    ]                                                                 11.211% [====                                    ]                                                                 11.311% [=====                                   ]                                                                 11.411% [=====                                   ]                                                                 11.512% [=====                                   ]                                                                 11.612% [=====                                   ]                                                                 11.712% [=====                                   ]                                                                 11.812% [=====                                   ]                                                                 11.912% [=====                                   ]                                                                 12.012% [=====                                   ]                                                                 12.112% [=====                                   ]                                                                 12.212% [=====                                   ]                                                                 12.312% [=====                                   ]                                                                 12.412% [=====                                   ]                                                                 12.513% [=====                                   ]                                                                 12.613% [=====                                   ]                                                                 12.713% [=====                                   ]                                                                 12.813% [=====                                   ]                                                                 12.913% [=====                                   ]                                                                 13.013% [=====                                   ]                                                                 13.113% [=====                                   ]                                                                 13.213% [=====                                   ]                                                                 13.313% [=====                                   ]                                                                 13.413% [=====                                   ]                                                                 13.514% [=====                                   ]                                                                 13.614% [=====                                   ]                                                                 13.714% [=====                                   ]                                                                 13.814% [======                                  ]                                                                 13.914% [======                                  ]                                                                 14.014% [======                                  ]                                                                 14.114% [======                                  ]                                                                 14.214% [======                                  ]                                                                 14.314% [======                                  ]                                                                 14.414% [======                                  ]                                                                 14.515% [======                                  ]                                                                 14.615% [======                                  ]                                                                 14.715% [======                                  ]                                                                 14.815% [======                                  ]                                                                 14.915% [======                                  ]                                                                 15.015% [======                                  ]                                                                 15.115% [======                                  ]                                                                 15.215% [======                                  ]                                                                 15.315% [======                                  ]                                                                 15.415% [======                                  ]                                                                 15.516% [======                                  ]                                                                 15.616% [======                                  ]                                                                 15.716% [======                                  ]                                                                 15.816% [======                                  ]                                                                 15.916% [======                                  ]                                                                 16.016% [======                                  ]                                                                 16.116% [======                                  ]                                                                 16.216% [======                                  ]                                                                 16.316% [=======                                 ]                                                                 16.416% [=======                                 ]                                                                 16.517% [=======                                 ]                                                                 16.617% [=======                                 ]                                                                 16.717% [=======                                 ]                                                                 16.817% [=======                                 ]                                                                 16.917% [=======                                 ]                                                                 17.017% [=======                                 ]                                                                 17.117% [=======                                 ]                                                                 17.217% [=======                                 ]                                                                 17.317% [=======                                 ]                                                                 17.417% [=======                                 ]                                                                 17.518% [=======                                 ]                                                                 17.618% [=======                                 ]                                                                 17.718% [=======                                 ]                                                                 17.818% [=======                                 ]                                                                 17.918% [=======                                 ]                                                                 18.018% [=======                                 ]                                                                 18.118% [=======                                 ]                                                                 18.218% [=======                                 ]                                                                 18.318% [=======                                 ]                                                                 18.418% [=======                                 ]                                                                 18.519% [=======                                 ]                                                                 18.619% [=======                                 ]                                                                 18.719% [=======                                 ]                                                                 18.819% [========                                ]                                                                 18.919% [========                                ]                                                                 19.019% [========                                ]                                                                 19.119% [========                                ]                                                                 19.219% [========                                ]                                                                 19.319% [========                                ]                                                                 19.419% [========                                ]                                                                 19.520% [========                                ]                                                                 19.620% [========                                ]                                                                 19.720% [========                                ]                                                                 19.820% [========                                ]                                                                 19.920% [========                                ]                                                                 20.020% [========                                ]                                                                 20.120% [========                                ]                                                                 20.220% [========                                ]                                                                 20.320% [========                                ]                                                                 20.420% [========                                ]                                                                 20.521% [========                                ]                                                                 20.621% [========                                ]                                                                 20.721% [========                                ]                                                                 20.821% [========                                ]                                                                 20.921% [========                                ]                                                                 21.021% [========                                ]                                                                 21.121% [========                                ]                                                                 21.221% [========                                ]                                                                 21.321% [=========                               ]                                                                 21.421% [=========                               ]                                                                 21.522% [=========                               ]                                                                 21.622% [=========                               ]                                                                 21.722% [=========                               ]                                                                 21.822% [=========                               ]                                                                 21.922% [=========                               ]                                                                 22.022% [=========                               ]                                                                 22.122% [=========                               ]                                                                 22.222% [=========                               ]                                                                 22.322% [=========                               ]                                                                 22.422% [=========                               ]                                                                 22.523% [=========                               ]                                                                 22.623% [=========                               ]                                                                 22.723% [=========                               ]                                                                 22.823% [=========                               ]                                                                 22.923% [=========                               ]                                                                 23.023% [=========                               ]                                                                 23.123% [=========                               ]                                                                 23.223% [=========                               ]                                                                 23.323% [=========                               ]                                                                 23.423% [=========                               ]                                                                 23.524% [=========                               ]                                                                 23.624% [=========                               ]                                                                 23.724% [=========                               ]                                                                 23.824% [==========                              ]                                                                 23.924% [==========                              ]                                                                 24.024% [==========                              ]                                                                 24.124% [==========                              ]                                                                 24.224% [==========                              ]                                                                 24.324% [==========                              ]                                                                 24.424% [==========                              ]                                                                 24.525% [==========                              ]                                                                 24.625% [==========                              ]                                                                 24.725% [==========                              ]                                                                 24.825% [==========                              ]                                                                 24.925% [==========                              ]                                                                 25.025% [==========                              ]                                                                 25.125% [==========                              ]                                                                 25.225% [==========                              ]                                                                 25.325% [==========                              ]                                                                 25.425% [==========                              ]                                                                 25.526% [==========                              ]                                                                 25.626% [==========                              ]                                                                 25.726% [==========                              ]                                                                 25.826% [==========                              ]                                                                 25.926% [==========                              ]                                                                 26.026% [==========                              ]                                                                 26.126% [==========                              ]                                                                 26.226% [==========                              ]                                                                 26.326% [===========                             ]                                                                 26.426% [===========                             ]                                                                 26.527% [===========                             ]                                                                 26.627% [===========                             ]                                                                 26.727% [===========                             ]                                                                 26.827% [===========                             ]                                                                 26.927% [===========                             ]                                                                 27.027% [===========                             ]                                                                 27.127% [===========                             ]                                                                 27.227% [===========                             ]                                                                 27.327% [===========                             ]                                                                 27.427% [===========                             ]                                                                 27.528% [===========                             ]                                                                 27.628% [===========                             ]                                                                 27.728% [===========                             ]                                                                 27.828% [===========                             ]                                                                 27.928% [===========                             ]                                                                 28.028% [===========                             ]                                                                 28.128% [===========                             ]                                                                 28.228% [===========                             ]                                                                 28.328% [===========                             ]                                                                 28.428% [===========                             ]                                                                 28.529% [===========                             ]                                                                 28.629% [===========                             ]                                                                 28.729% [===========                             ]                                                                 28.829% [============                            ]                                                                 28.929% [============                            ]                                                                 29.029% [============                            ]                                                                 29.129% [============                            ]                                                                 29.229% [============                            ]                                                                 29.329% [============                            ]                                                                 29.429% [============                            ]                                                                 29.530% [============                            ]                                                                 29.630% [============                            ]                                                                 29.730% [============                            ]                                                                 29.830% [============                            ]                                                                 29.930% [============                            ]                                                                 30.030% [============                            ]                                                                 30.130% [============                            ]                                                                 30.230% [============                            ]                                                                 30.330% [============                            ]                                                                 30.430% [============                            ]                                                                 30.531% [============                            ]                                                                 30.631% [============                            ]                                                                 30.731% [============                            ]                                                                 30.831% [============                            ]                                                                 30.931% [============                            ]                                                                 31.031% [============                            ]                                                                 31.131% [============                            ]                                                                 31.231% [============                            ]                                                                 31.331% [=============                           ]                                                                 31.431% [=============                           ]                                                                 31.532% [=============                           ]                                                                 31.632% [=============                           ]                                                                 31.732% [=============                           ]                                                                 31.832% [=============                           ]                                                                 31.932% [=============                           ]                                                                 32.032% [=============                           ]                                                                 32.132% [=============                           ]                                                                 32.232% [=============                           ]                                                                 32.332% [=============                           ]                                                                 32.432% [=============                           ]                                                                 32.533% [=============                           ]                                                                 32.633% [=============                           ]                                                                 32.733% [=============                           ]                                                                 32.833% [=============                           ]                                                                 32.933% [=============                           ]                                                                 33.033% [=============                           ]                                                                 33.133% [=============                           ]                                                                 33.233% [=============                           ]                                                                 33.333% [=============                           ]                                                                 33.433% [=============                           ]                                                                 33.534% [=============                           ]                                                                 33.634% [=============                           ]                                                                 33.734% [=============                           ]                                                                 33.834% [==============                          ]                                                                 33.934% [==============                          ]                                                                 34.034% [==============                          ]                                                                 34.134% [==============                          ]                                                                 34.234% [==============                          ]                                                                 34.334% [==============                          ]                                                                 34.434% [==============                          ]                                                                 34.535% [==============                          ]                                                                 34.635% [==============                          ]                                                                 34.735% [==============                          ]                                                                 34.835% [==============                          ]                                                                 34.935% [==============                          ]                                                                 35.035% [==============                          ]                                                                 35.135% [==============                          ]                                                                 35.235% [==============                          ]                                                                 35.335% [==============                          ]                                                                 35.435% [==============                          ]                                                                 35.536% [==============                          ]                                                                 35.636% [==============                          ]                                                                 35.736% [==============                          ]                                                                 35.836% [==============                          ]                                                                 35.936% [==============                          ]                                                                 36.036% [==============                          ]                                                                 36.136% [==============                          ]                                                                 36.236% [==============                          ]                                                                 36.336% [===============                         ]                                                                 36.436% [===============                         ]                                                                 36.537% [===============                         ]                                                                 36.637% [===============                         ]                                                                 36.737% [===============                         ]                                                                 36.837% [===============                         ]                                                                 36.937% [===============                         ]                                                                 37.037% [===============                         ]                                                                 37.137% [===============                         ]                                                                 37.237% [===============                         ]                                                                 37.337% [===============                         ]                                                                 37.437% [===============                         ]                                                                 37.538% [===============                         ]                                                                 37.638% [===============                         ]                                                                 37.738% [===============                         ]                                                                 37.838% [===============                         ]                                                                 37.938% [===============                         ]                                                                 38.038% [===============                         ]                                                                 38.138% [===============                         ]                                                                 38.238% [===============                         ]                                                                 38.338% [===============                         ]                                                                 38.438% [===============                         ]                                                                 38.539% [===============                         ]                                                                 38.639% [===============                         ]                                                                 38.739% [===============                         ]                                                                 38.839% [================                        ]                                                                 38.939% [================                        ]                                                                 39.039% [================                        ]                                                                 39.139% [================                        ]                                                                 39.239% [================                        ]                                                                 39.339% [================                        ]                                                                 39.439% [================                        ]                                                                 39.540% [================                        ]                                                                 39.640% [================                        ]                                                                 39.740% [================                        ]                                                                 39.840% [================                        ]                                                                 39.940% [================                        ]                                                                 40.040% [================                        ]                                                                 40.140% [================                        ]                                                                 40.240% [================                        ]                                                                 40.340% [================                        ]                                                                 40.440% [================                        ]                                                                 40.541% [================                        ]                                                                 40.641% [================                        ]                                                                 40.741% [================                        ]                                                                 40.841% [================                        ]                                                                 40.941% [================                        ]                                                                 41.041% [================                        ]                                                                 41.141% [================                        ]                                                                 41.241% [================                        ]                                                                 41.341% [=================                       ]                                                                 41.441% [=================                       ]                                                                 41.542% [=================                       ]                                                                 41.642% [=================                       ]                                                                 41.742% [=================                       ]                                                                 41.842% [=================                       ]                                                                 41.942% [=================                       ]                                                                 42.042% [=================                       ]                                                                 42.142% [=================                       ]                                                                 42.242% [=================                       ]                                                                 42.342% [=================                       ]                                                                 42.442% [=================                       ]                                                                 42.543% [=================                       ]                                                                 42.643% [=================                       ]                                                                 42.743% [=================                       ]                                                                 42.843% [=================                       ]                                                                 42.943% [=================                       ]                                                                 43.043% [=================                       ]                                                                 43.143% [=================                       ]                                                                 43.243% [=================                       ]                                                                 43.343% [=================                       ]                                                                 43.443% [=================                       ]                                                                 43.544% [=================                       ]                                                                 43.644% [=================                       ]                                                                 43.744% [=================                       ]                                                                 43.844% [==================                      ]                                                                 43.944% [==================                      ]                                                                 44.044% [==================                      ]                                                                 44.144% [==================                      ]                                                                 44.244% [==================                      ]                                                                 44.344% [==================                      ]                                                                 44.444% [==================                      ]                                                                 44.545% [==================                      ]                                                                 44.645% [==================                      ]                                                                 44.745% [==================                      ]                                                                 44.845% [==================                      ]                                                                 44.945% [==================                      ]                                                                 45.045% [==================                      ]                                                                 45.145% [==================                      ]                                                                 45.245% [==================                      ]                                                                 45.345% [==================                      ]                                                                 45.445% [==================                      ]                                                                 45.546% [==================                      ]                                                                 45.646% [==================                      ]                                                                 45.746% [==================                      ]                                                                 45.846% [==================                      ]                                                                 45.946% [==================                      ]                                                                 46.046% [==================                      ]                                                                 46.146% [==================                      ]                                                                 46.246% [==================                      ]                                                                 46.346% [===================                     ]                                                                 46.446% [===================                     ]                                                                 46.547% [===================                     ]                                                                 46.647% [===================                     ]                                                                 46.747% [===================                     ]                                                                 46.847% [===================                     ]                                                                 46.947% [===================                     ]                                                                 47.047% [===================                     ]                                                                 47.147% [===================                     ]                                                                 47.247% [===================                     ]                                                                 47.347% [===================                     ]                                                                 47.447% [===================                     ]                                                                 47.548% [===================                     ]                                                                 47.648% [===================                     ]                                                                 47.748% [===================                     ]                                                                 47.848% [===================                     ]                                                                 47.948% [===================                     ]                                                                 48.048% [===================                     ]                                                                 48.148% [===================                     ]                                                                 48.248% [===================                     ]                                                                 48.348% [===================                     ]                                                                 48.448% [===================                     ]                                                                 48.549% [===================                     ]                                                                 48.649% [===================                     ]                                                                 48.749% [===================                     ]                                                                 48.849% [====================                    ]                                                                 48.949% [====================                    ]                                                                 49.049% [====================                    ]                                                                 49.149% [====================                    ]                                                                 49.249% [====================                    ]                                                                 49.349% [====================                    ]                                                                 49.449% [====================                    ]                                                                 49.550% [====================                    ]                                                                 49.650% [====================                    ]                                                                 49.750% [====================                    ]                                                                 49.850% [====================                    ]                                                                 49.950% [====================                    ]                                                                 50.050% [====================                    ]                                                                 50.150% [====================                    ]                                                                 50.250% [====================                    ]                                                                 50.350% [====================                    ]                                                                 50.450% [====================                    ]                                                                 50.551% [====================                    ]                                                                 50.651% [====================                    ]                                                                 50.751% [====================                    ]                                                                 50.851% [====================                    ]                                                                 50.951% [====================                    ]                                                                 51.051% [====================                    ]                                                                 51.151% [====================                    ]                                                                 51.251% [=====================                   ]                                                                 51.351% [=====================                   ]                                                                 51.451% [=====================                   ]                                                                 51.552% [=====================                   ]                                                                 51.652% [=====================                   ]                                                                 51.752% [=====================                   ]                                                                 51.852% [=====================                   ]                                                                 51.952% [=====================                   ]                                                                 52.052% [=====================                   ]                                                                 52.152% [=====================                   ]                                                                 52.252% [=====================                   ]                                                                 52.352% [=====================                   ]                                                                 52.452% [=====================                   ]                                                                 52.553% [=====================                   ]                                                                 52.653% [=====================                   ]                                                                 52.753% [=====================                   ]                                                                 52.853% [=====================                   ]                                                                 52.953% [=====================                   ]                                                                 53.053% [=====================                   ]                                                                 53.153% [=====================                   ]                                                                 53.253% [=====================                   ]                                                                 53.353% [=====================                   ]                                                                 53.453% [=====================                   ]                                                                 53.554% [=====================                   ]                                                                 53.654% [=====================                   ]                                                                 53.754% [======================                  ]                                                                 53.854% [======================                  ]                                                                 53.954% [======================                  ]                                                                 54.054% [======================                  ]                                                                 54.154% [======================                  ]                                                                 54.254% [======================                  ]                                                                 54.354% [======================                  ]                                                                 54.454% [======================                  ]                                                                 54.555% [======================                  ]                                                                 54.655% [======================                  ]                                                                 54.755% [======================                  ]                                                                 54.855% [======================                  ]                                                                 54.955% [======================                  ]                                                                 55.055% [======================                  ]                                                                 55.155% [======================                  ]                                                                 55.255% [======================                  ]                                                                 55.355% [======================                  ]                                                                 55.455% [======================                  ]                                                                 55.556% [======================                  ]                                                                 55.656% [======================                  ]                                                                 55.756% [======================                  ]                                                                 55.856% [======================                  ]                                                                 55.956% [======================                  ]                                                                 56.056% [======================                  ]                                                                 56.156% [======================                  ]                                                                 56.256% [=======================                 ]                                                                 56.356% [=======================                 ]                                                                 56.456% [=======================                 ]                                                                 56.557% [=======================                 ]                                                                 56.657% [=======================                 ]                                                                 56.757% [=======================                 ]                                                                 56.857% [=======================                 ]                                                                 56.957% [=======================                 ]                                                                 57.057% [=======================                 ]                                                                 57.157% [=======================                 ]                                                                 57.257% [=======================                 ]                                                                 57.357% [=======================                 ]                                                                 57.457% [=======================                 ]                                                                 57.558% [=======================                 ]                                                                 57.658% [=======================                 ]                                                                 57.758% [=======================                 ]                                                                 57.858% [=======================                 ]                                                                 57.958% [=======================                 ]                                                                 58.058% [=======================                 ]                                                                 58.158% [=======================                 ]                                                                 58.258% [=======================                 ]                                                                 58.358% [=======================                 ]                                                                 58.458% [=======================                 ]                                                                 58.559% [=======================                 ]                                                                 58.659% [=======================                 ]                                                                 58.759% [========================                ]                                                                 58.859% [========================                ]                                                                 58.959% [========================                ]                                                                 59.059% [========================                ]                                                                 59.159% [========================                ]                                                                 59.259% [========================                ]                                                                 59.359% [========================                ]                                                                 59.459% [========================                ]                                                                 59.560% [========================                ]                                                                 59.660% [========================                ]                                                                 59.760% [========================                ]                                                                 59.860% [========================                ]                                                                 59.960% [========================                ]                                                                 60.060% [========================                ]                                                                 60.160% [========================                ]                                                                 60.260% [========================                ]                                                                 60.360% [========================                ]                                                                 60.460% [========================                ]                                                                 60.561% [========================                ]                                                                 60.661% [========================                ]                                                                 60.761% [========================                ]                                                                 60.861% [========================                ]                                                                 60.961% [========================                ]                                                                 61.061% [========================                ]                                                                 61.161% [========================                ]                                                                 61.261% [=========================               ]                                                                 61.361% [=========================               ]                                                                 61.461% [=========================               ]                                                                 61.562% [=========================               ]                                                                 61.662% [=========================               ]                                                                 61.762% [=========================               ]                                                                 61.862% [=========================               ]                                                                 61.962% [=========================               ]                                                                 62.062% [=========================               ]                                                                 62.162% [=========================               ]                                                                 62.262% [=========================               ]                                                                 62.362% [=========================               ]                                                                 62.462% [=========================               ]                                                                 62.563% [=========================               ]                                                                 62.663% [=========================               ]                                                                 62.763% [=========================               ]                                                                 62.863% [=========================               ]                                                                 62.963% [=========================               ]                                                                 63.063% [=========================               ]                                                                 63.163% [=========================               ]                                                                 63.263% [=========================               ]                                                                 63.363% [=========================               ]                                                                 63.463% [=========================               ]                                                                 63.564% [=========================               ]                                                                 63.664% [=========================               ]                                                                 63.764% [==========================              ]                                                                 63.864% [==========================              ]                                                                 63.964% [==========================              ]                                                                 64.064% [==========================              ]                                                                 64.164% [==========================              ]                                                                 64.264% [==========================              ]                                                                 64.364% [==========================              ]                                                                 64.464% [==========================              ]                                                                 64.565% [==========================              ]                                                                 64.665% [==========================              ]                                                                 64.765% [==========================              ]                                                                 64.865% [==========================              ]                                                                 64.965% [==========================              ]                                                                 65.065% [==========================              ]                                                                 65.165% [==========================              ]                                                                 65.265% [==========================              ]                                                                 65.365% [==========================              ]                                                                 65.465% [==========================              ]                                                                 65.566% [==========================              ]                                                                 65.666% [==========================              ]                                                                 65.766% [==========================              ]                                                                 65.866% [==========================              ]                                                                 65.966% [==========================              ]                                                                 66.066% [==========================              ]                                                                 66.166% [==========================              ]                                                                 66.266% [===========================             ]                                                                 66.366% [===========================             ]                                                                 66.466% [===========================             ]                                                                 66.567% [===========================             ]                                                                 66.667% [===========================             ]                                                                 66.767% [===========================             ]                                                                 66.867% [===========================             ]                                                                 66.967% [===========================             ]                                                                 67.067% [===========================             ]                                                                 67.167% [===========================             ]                                                                 67.267% [===========================             ]                                                                 67.367% [===========================             ]                                                                 67.467% [===========================             ]                                                                 67.568% [===========================             ]                                                                 67.668% [===========================             ]                                                                 67.768% [===========================             ]                                                                 67.868% [===========================             ]                                                                 67.968% [===========================             ]                                                                 68.068% [===========================             ]                                                                 68.168% [===========================             ]                                                                 68.268% [===========================             ]                                                                 68.368% [===========================             ]                                                                 68.468% [===========================             ]                                                                 68.569% [===========================             ]                                                                 68.669% [===========================             ]                                                                 68.769% [============================            ]                                                                 68.869% [============================            ]                                                                 68.969% [============================            ]                                                                 69.069% [============================            ]                                                                 69.169% [============================            ]                                                                 69.269% [============================            ]                                                                 69.369% [============================            ]                                                                 69.469% [============================            ]                                                                 69.570% [============================            ]                                                                 69.670% [============================            ]                                                                 69.770% [============================            ]                                                                 69.870% [============================            ]                                                                 69.970% [============================            ]                                                                 70.070% [============================            ]                                                                 70.170% [============================            ]                                                                 70.270% [============================            ]                                                                 70.370% [============================            ]                                                                 70.470% [============================            ]                                                                 70.571% [============================            ]                                                                 70.671% [============================            ]                                                                 70.771% [============================            ]                                                                 70.871% [============================            ]                                                                 70.971% [============================            ]                                                                 71.071% [============================            ]                                                                 71.171% [============================            ]                                                                 71.271% [=============================           ]                                                                 71.371% [=============================           ]                                                                 71.471% [=============================           ]                                                                 71.572% [=============================           ]                                                                 71.672% [=============================           ]                                                                 71.772% [=============================           ]                                                                 71.872% [=============================           ]                                                                 71.972% [=============================           ]                                                                 72.072% [=============================           ]                                                                 72.172% [=============================           ]                                                                 72.272% [=============================           ]                                                                 72.372% [=============================           ]                                                                 72.472% [=============================           ]                                                                 72.573% [=============================           ]                                                                 72.673% [=============================           ]                                                                 72.773% [=============================           ]                                                                 72.873% [=============================           ]                                                                 72.973% [=============================           ]                                                                 73.073% [=============================           ]                                                                 73.173% [=============================           ]                                                                 73.273% [=============================           ]                                                                 73.373% [=============================           ]                                                                 73.473% [=============================           ]                                                                 73.574% [=============================           ]                                                                 73.674% [=============================           ]                                                                 73.774% [==============================          ]                                                                 73.874% [==============================          ]                                                                 73.974% [==============================          ]                                                                 74.074% [==============================          ]                                                                 74.174% [==============================          ]                                                                 74.274% [==============================          ]                                                                 74.374% [==============================          ]                                                                 74.474% [==============================          ]                                                                 74.575% [==============================          ]                                                                 74.675% [==============================          ]                                                                 74.775% [==============================          ]                                                                 74.875% [==============================          ]                                                                 74.975% [==============================          ]                                                                 75.075% [==============================          ]                                                                 75.175% [==============================          ]                                                                 75.275% [==============================          ]                                                                 75.375% [==============================          ]                                                                 75.475% [==============================          ]                                                                 75.576% [==============================          ]                                                                 75.676% [==============================          ]                                                                 75.776% [==============================          ]                                                                 75.876% [==============================          ]                                                                 75.976% [==============================          ]                                                                 76.076% [==============================          ]                                                                 76.176% [==============================          ]                                                                 76.276% [===============================         ]                                                                 76.376% [===============================         ]                                                                 76.476% [===============================         ]                                                                 76.577% [===============================         ]                                                                 76.677% [===============================         ]                                                                 76.777% [===============================         ]                                                                 76.877% [===============================         ]                                                                 76.977% [===============================         ]                                                                 77.077% [===============================         ]                                                                 77.177% [===============================         ]                                                                 77.277% [===============================         ]                                                                 77.377% [===============================         ]                                                                 77.477% [===============================         ]                                                                 77.578% [===============================         ]                                                                 77.678% [===============================         ]                                                                 77.778% [===============================         ]                                                                 77.878% [===============================         ]                                                                 77.978% [===============================         ]                                                                 78.078% [===============================         ]                                                                 78.178% [===============================         ]                                                                 78.278% [===============================         ]                                                                 78.378% [===============================         ]                                                                 78.478% [===============================         ]                                                                 78.579% [===============================         ]                                                                 78.679% [===============================         ]                                                                 78.779% [================================        ]                                                                 78.879% [================================        ]                                                                 78.979% [================================        ]                                                                 79.079% [================================        ]                                                                 79.179% [================================        ]                                                                 79.279% [================================        ]                                                                 79.379% [================================        ]                                                                 79.479% [================================        ]                                                                 79.580% [================================        ]                                                                 79.680% [================================        ]                                                                 79.780% [================================        ]                                                                 79.880% [================================        ]                                                                 79.980% [================================        ]                                                                 80.080% [================================        ]                                                                 80.180% [================================        ]                                                                 80.280% [================================        ]                                                                 80.380% [================================        ]                                                                 80.480% [================================        ]                                                                 80.581% [================================        ]                                                                 80.681% [================================        ]                                                                 80.781% [================================        ]                                                                 80.881% [================================        ]                                                                 80.981% [================================        ]                                                                 81.081% [================================        ]                                                                 81.181% [================================        ]                                                                 81.281% [=================================       ]                                                                 81.381% [=================================       ]                                                                 81.481% [=================================       ]                                                                 81.582% [=================================       ]                                                                 81.682% [=================================       ]                                                                 81.782% [=================================       ]                                                                 81.882% [=================================       ]                                                                 81.982% [=================================       ]                                                                 82.082% [=================================       ]                                                                 82.182% [=================================       ]                                                                 82.282% [=================================       ]                                                                 82.382% [=================================       ]                                                                 82.482% [=================================       ]                                                                 82.583% [=================================       ]                                                                 82.683% [=================================       ]                                                                 82.783% [=================================       ]                                                                 82.883% [=================================       ]                                                                 82.983% [=================================       ]                                                                 83.083% [=================================       ]                                                                 83.183% [=================================       ]                                                                 83.283% [=================================       ]                                                                 83.383% [=================================       ]                                                                 83.483% [=================================       ]                                                                 83.584% [=================================       ]                                                                 83.684% [=================================       ]                                                                 83.784% [==================================      ]                                                                 83.884% [==================================      ]                                                                 83.984% [==================================      ]                                                                 84.084% [==================================      ]                                                                 84.184% [==================================      ]                                                                 84.284% [==================================      ]                                                                 84.384% [==================================      ]                                                                 84.484% [==================================      ]                                                                 84.585% [==================================      ]                                                                 84.685% [==================================      ]                                                                 84.785% [==================================      ]                                                                 84.885% [==================================      ]                                                                 84.985% [==================================      ]                                                                 85.085% [==================================      ]                                                                 85.185% [==================================      ]                                                                 85.285% [==================================      ]                                                                 85.385% [==================================      ]                                                                 85.485% [==================================      ]                                                                 85.586% [==================================      ]                                                                 85.686% [==================================      ]                                                                 85.786% [==================================      ]                                                                 85.886% [==================================      ]                                                                 85.986% [==================================      ]                                                                 86.086% [==================================      ]                                                                 86.186% [==================================      ]                                                                 86.286% [===================================     ]                                                                 86.386% [===================================     ]                                                                 86.486% [===================================     ]                                                                 86.587% [===================================     ]                                                                 86.687% [===================================     ]                                                                 86.787% [===================================     ]                                                                 86.887% [===================================     ]                                                                 86.987% [===================================     ]                                                                 87.087% [===================================     ]                                                                 87.187% [===================================     ]                                                                 87.287% [===================================     ]                                                                 87.387% [===================================     ]                                                                 87.487% [===================================     ]                                                                 87.588% [===================================     ]                                                                 87.688% [===================================     ]                                                                 87.788% [===================================     ]                                                                 87.888% [===================================     ]                                                                 87.988% [===================================     ]                                                                 88.088% [===================================     ]                                                                 88.188% [===================================     ]                                                                 88.288% [===================================     ]                                                                 88.388% [===================================     ]                                                                 88.488% [===================================     ]                                                                 88.589% [===================================     ]                                                                 88.689% [===================================     ]                                                                 88.789% [====================================    ]                                                                 88.889% [====================================    ]                                                                 88.989% [====================================    ]                                                                 89.089% [====================================    ]                                                                 89.189% [====================================    ]                                                                 89.289% [====================================    ]                                                                 89.389% [====================================    ]                                                                 89.489% [====================================    ]                                                                 89.590% [====================================    ]                                                                 89.690% [====================================    ]                                                                 89.790% [====================================    ]                                                                 89.890% [====================================    ]                                                                 89.990% [====================================    ]                                                                 90.090% [====================================    ]                                                                 90.190% [====================================    ]                                                                 90.290% [====================================    ]                                                                 90.390% [====================================    ]                                                                 90.490% [====================================    ]                                                                 90.591% [====================================    ]                                                                 90.691% [====================================    ]                                                                 90.791% [====================================    ]                                                                 90.891% [====================================    ]                                                                 90.991% [====================================    ]                                                                 91.091% [====================================    ]                                                                 91.191% [====================================    ]                                                                 91.291% [=====================================   ]                                                                 91.391% [=====================================   ]                                                                 91.491% [=====================================   ]                                                                 91.592% [=====================================   ]                                                                 91.692% [=====================================   ]                                                                 91.792% [=====================================   ]                                                                 91.892% [=====================================   ]                                                                 91.992% [=====================================   ]                                                                 92.092% [=====================================   ]                                                                 92.192% [=====================================   ]                                                                 92.292% [=====================================   ]                                                                 92.392% [=====================================   ]                                                                 92.492% [=====================================   ]                                                                 92.593% [=====================================   ]                                                                 92.693% [=====================================   ]                                                                 92.793% [=====================================   ]                                                                 92.893% [=====================================   ]                                                                 92.993% [=====================================   ]                                                                 93.093% [=====================================   ]                                                                 93.193% [=====================================   ]                                                                 93.293% [=====================================   ]                                                                 93.393% [=====================================   ]                                                                 93.493% [=====================================   ]                                                                 93.594% [=====================================   ]                                                                 93.694% [=====================================   ]                                                                 93.794% [======================================  ]                                                                 93.894% [======================================  ]                                                                 93.994% [======================================  ]                                                                 94.094% [======================================  ]                                                                 94.194% [======================================  ]                                                                 94.294% [======================================  ]                                                                 94.394% [======================================  ]                                                                 94.494% [======================================  ]                                                                 94.595% [======================================  ]                                                                 94.695% [======================================  ]                                                                 94.795% [======================================  ]                                                                 94.895% [======================================  ]                                                                 94.995% [======================================  ]                                                                 95.095% [======================================  ]                                                                 95.195% [======================================  ]                                                                 95.295% [======================================  ]                                                                 95.395% [======================================  ]                                                                 95.495% [======================================  ]                                                                 95.596% [======================================  ]                                                                 95.696% [======================================  ]                                                                 95.796% [======================================  ]                                                                 95.896% [======================================  ]                                                                 95.996% [======================================  ]                                                                 96.096% [======================================  ]                                                                 96.196% [======================================  ]                                                                 96.296% [======================================= ]                                                                 96.396% [======================================= ]                                                                 96.496% [======================================= ]                                                                 96.597% [======================================= ]                                                                 96.697% [======================================= ]                                                                 96.797% [======================================= ]                                                                 96.897% [======================================= ]                                                                 96.997% [======================================= ]                                                                 97.097% [======================================= ]                                                                 97.197% [======================================= ]                                                                 97.297% [======================================= ]                                                                 97.397% [======================================= ]                                                                 97.497% [======================================= ]                                                                 97.598% [======================================= ]                                                                 97.698% [======================================= ]                                                                 97.798% [======================================= ]                                                                 97.898% [======================================= ]                                                                 97.998% [======================================= ]                                                                 98.098% [======================================= ]                                                                 98.198% [======================================= ]                                                                 98.298% [======================================= ]                                                                 98.398% [======================================= ]                                                                 98.498% [======================================= ]                                                                 98.599% [======================================= ]                                                                 98.699% [======================================= ]                                                                 98.799% [========================================]                                                                 98.899% [========================================]                                                                 98.999% [========================================]                                                                 99.099% [========================================]                                                                 99.199% [========================================]                                                                 99.299% [========================================]                                                                 99.399% [========================================]                                                                 99.499% [========================================]                                                                 99.600% [========================================]                                                                 99.700% [========================================]                                                                 99.800% [========================================]                                                                 99.900% [========================================]                                                                 100.000% [========================================]
>  proc.time()-ptm
   user  system elapsed 
   0.53    0.03    0.60 
> 
>  
>  
>  
>  
>  
> 
> 
> 
> cleanEx()
> nameEx("rlmb")
> ### * rlmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: rlmb
> ### Title: The Bayesian Linear Model Distribution
> ### Aliases: rlmb rlmb.print print.rlmb
> 
> ### ** Examples
> 
> ## Annette Dobson (1990) "An Introduction to Generalized Linear Models".
> ## Page 9: Plant Weight Data.
> ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
> trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
> group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
> weight <- c(ctl, trt)
> 
> ps=Prior_Setup(weight ~ group)
[1] "Variable names are:"
[1] "(Intercept)" "groupTrt"   
> x=ps$x
> mu=ps$mu
> V=ps$Sigma
> mu[1,1]=mean(weight)
> 
> Prior_Check(weight ~ group,family =gaussian(),
+             pfamily=dNormal(mu=mu,Sigma=V))
[1] "Variables in the Model Are:"
[1] "(Intercept)" "groupTrt"   
[1] "The maximum likelihood estimates for all coefficients appear to be roughly consistent with the prior."
             abs_ratio
(Intercept) 0.09242285
groupTrt    0.17198871
> lm.D9 <- lm(weight ~ group,x=TRUE,y=TRUE)
> y=lm.D9$y
> 
> ## Dispersion for maximum likelihood estimate
> disp_ML=sigma(lm.D9)^2
> n_prior=2
> shape=n_prior/2
> rate= disp_ML*shape
> 
> # Two-Block Gibbs sampler
> set.seed(180)
> dispersion2=disp_ML
> # Run 1000 burn-in iterations
> for(i in 1:1000){
+   out1=rlmb(n = 1, y=y, x=x, pfamily=dNormal(mu=mu,Sigma=V,dispersion=dispersion2))
+   out2=rlmb(n = 1, y=y, x=x, pfamily=dGamma(shape=shape,rate=rate,beta=out1$coefficients[1,]))
+   dispersions=out2$dispersion
+ }
> 
> 
> # Run 1000 additional iterations and store output
> beta_out<-matrix(0,nrow=1000, ncol=2)
> disp_out=rep(0,1000)
> for(i in 1:1000){
+   out1=rlmb(n = 1, y=y, x=x, pfamily=dNormal(mu=mu,Sigma=V,dispersion=dispersion2))
+   out2=rlmb(n = 1, y=y, x=x, pfamily=dGamma(shape=shape,rate=rate,beta=out1$coefficients[1,]))
+   dispersions=out2$dispersion
+   beta_out[i,1:2]=out1$coefficients[1,1:2]
+   disp_out[i]=out2$dispersion
+ }
> 
> colMeans(beta_out)
[1]  5.0152653 -0.3375207
> mean(disp_out)
[1] 0.5170687
> 
> # Same model using Independent_Normal_Gamma_Prior
> lmb.D9_v2=lmb(weight ~ group,dIndependent_Normal_Gamma(mu,V,shape=shape,rate=rate))
Starting Simulation:
                                                                 0.000% [                                        ]                                                                 0.100% [                                        ]                                                                 0.200% [                                        ]                                                                 0.300% [                                        ]                                                                 0.400% [                                        ]                                                                 0.501% [                                        ]                                                                 0.601% [                                        ]                                                                 0.701% [                                        ]                                                                 0.801% [                                        ]                                                                 0.901% [                                        ]                                                                 1.001% [                                        ]                                                                 1.101% [                                        ]                                                                 1.201% [                                        ]                                                                 1.301% [=                                       ]                                                                 1.401% [=                                       ]                                                                 1.502% [=                                       ]                                                                 1.602% [=                                       ]                                                                 1.702% [=                                       ]                                                                 1.802% [=                                       ]                                                                 1.902% [=                                       ]                                                                 2.002% [=                                       ]                                                                 2.102% [=                                       ]                                                                 2.202% [=                                       ]                                                                 2.302% [=                                       ]                                                                 2.402% [=                                       ]                                                                 2.503% [=                                       ]                                                                 2.603% [=                                       ]                                                                 2.703% [=                                       ]                                                                 2.803% [=                                       ]                                                                 2.903% [=                                       ]                                                                 3.003% [=                                       ]                                                                 3.103% [=                                       ]                                                                 3.203% [=                                       ]                                                                 3.303% [=                                       ]                                                                 3.403% [=                                       ]                                                                 3.504% [=                                       ]                                                                 3.604% [=                                       ]                                                                 3.704% [=                                       ]                                                                 3.804% [==                                      ]                                                                 3.904% [==                                      ]                                                                 4.004% [==                                      ]                                                                 4.104% [==                                      ]                                                                 4.204% [==                                      ]                                                                 4.304% [==                                      ]                                                                 4.404% [==                                      ]                                                                 4.505% [==                                      ]                                                                 4.605% [==                                      ]                                                                 4.705% [==                                      ]                                                                 4.805% [==                                      ]                                                                 4.905% [==                                      ]                                                                 5.005% [==                                      ]                                                                 5.105% [==                                      ]                                                                 5.205% [==                                      ]                                                                 5.305% [==                                      ]                                                                 5.405% [==                                      ]                                                                 5.506% [==                                      ]                                                                 5.606% [==                                      ]                                                                 5.706% [==                                      ]                                                                 5.806% [==                                      ]                                                                 5.906% [==                                      ]                                                                 6.006% [==                                      ]                                                                 6.106% [==                                      ]                                                                 6.206% [==                                      ]                                                                 6.306% [===                                     ]                                                                 6.406% [===                                     ]                                                                 6.507% [===                                     ]                                                                 6.607% [===                                     ]                                                                 6.707% [===                                     ]                                                                 6.807% [===                                     ]                                                                 6.907% [===                                     ]                                                                 7.007% [===                                     ]                                                                 7.107% [===                                     ]                                                                 7.207% [===                                     ]                                                                 7.307% [===                                     ]                                                                 7.407% [===                                     ]                                                                 7.508% [===                                     ]                                                                 7.608% [===                                     ]                                                                 7.708% [===                                     ]                                                                 7.808% [===                                     ]                                                                 7.908% [===                                     ]                                                                 8.008% [===                                     ]                                                                 8.108% [===                                     ]                                                                 8.208% [===                                     ]                                                                 8.308% [===                                     ]                                                                 8.408% [===                                     ]                                                                 8.509% [===                                     ]                                                                 8.609% [===                                     ]                                                                 8.709% [===                                     ]                                                                 8.809% [====                                    ]                                                                 8.909% [====                                    ]                                                                 9.009% [====                                    ]                                                                 9.109% [====                                    ]                                                                 9.209% [====                                    ]                                                                 9.309% [====                                    ]                                                                 9.409% [====                                    ]                                                                 9.510% [====                                    ]                                                                 9.610% [====                                    ]                                                                 9.710% [====                                    ]                                                                 9.810% [====                                    ]                                                                 9.910% [====                                    ]                                                                 10.010% [====                                    ]                                                                 10.110% [====                                    ]                                                                 10.210% [====                                    ]                                                                 10.310% [====                                    ]                                                                 10.410% [====                                    ]                                                                 10.511% [====                                    ]                                                                 10.611% [====                                    ]                                                                 10.711% [====                                    ]                                                                 10.811% [====                                    ]                                                                 10.911% [====                                    ]                                                                 11.011% [====                                    ]                                                                 11.111% [====                                    ]                                                                 11.211% [====                                    ]                                                                 11.311% [=====                                   ]                                                                 11.411% [=====                                   ]                                                                 11.512% [=====                                   ]                                                                 11.612% [=====                                   ]                                                                 11.712% [=====                                   ]                                                                 11.812% [=====                                   ]                                                                 11.912% [=====                                   ]                                                                 12.012% [=====                                   ]                                                                 12.112% [=====                                   ]                                                                 12.212% [=====                                   ]                                                                 12.312% [=====                                   ]                                                                 12.412% [=====                                   ]                                                                 12.513% [=====                                   ]                                                                 12.613% [=====                                   ]                                                                 12.713% [=====                                   ]                                                                 12.813% [=====                                   ]                                                                 12.913% [=====                                   ]                                                                 13.013% [=====                                   ]                                                                 13.113% [=====                                   ]                                                                 13.213% [=====                                   ]                                                                 13.313% [=====                                   ]                                                                 13.413% [=====                                   ]                                                                 13.514% [=====                                   ]                                                                 13.614% [=====                                   ]                                                                 13.714% [=====                                   ]                                                                 13.814% [======                                  ]                                                                 13.914% [======                                  ]                                                                 14.014% [======                                  ]                                                                 14.114% [======                                  ]                                                                 14.214% [======                                  ]                                                                 14.314% [======                                  ]                                                                 14.414% [======                                  ]                                                                 14.515% [======                                  ]                                                                 14.615% [======                                  ]                                                                 14.715% [======                                  ]                                                                 14.815% [======                                  ]                                                                 14.915% [======                                  ]                                                                 15.015% [======                                  ]                                                                 15.115% [======                                  ]                                                                 15.215% [======                                  ]                                                                 15.315% [======                                  ]                                                                 15.415% [======                                  ]                                                                 15.516% [======                                  ]                                                                 15.616% [======                                  ]                                                                 15.716% [======                                  ]                                                                 15.816% [======                                  ]                                                                 15.916% [======                                  ]                                                                 16.016% [======                                  ]                                                                 16.116% [======                                  ]                                                                 16.216% [======                                  ]                                                                 16.316% [=======                                 ]                                                                 16.416% [=======                                 ]                                                                 16.517% [=======                                 ]                                                                 16.617% [=======                                 ]                                                                 16.717% [=======                                 ]                                                                 16.817% [=======                                 ]                                                                 16.917% [=======                                 ]                                                                 17.017% [=======                                 ]                                                                 17.117% [=======                                 ]                                                                 17.217% [=======                                 ]                                                                 17.317% [=======                                 ]                                                                 17.417% [=======                                 ]                                                                 17.518% [=======                                 ]                                                                 17.618% [=======                                 ]                                                                 17.718% [=======                                 ]                                                                 17.818% [=======                                 ]                                                                 17.918% [=======                                 ]                                                                 18.018% [=======                                 ]                                                                 18.118% [=======                                 ]                                                                 18.218% [=======                                 ]                                                                 18.318% [=======                                 ]                                                                 18.418% [=======                                 ]                                                                 18.519% [=======                                 ]                                                                 18.619% [=======                                 ]                                                                 18.719% [=======                                 ]                                                                 18.819% [========                                ]                                                                 18.919% [========                                ]                                                                 19.019% [========                                ]                                                                 19.119% [========                                ]                                                                 19.219% [========                                ]                                                                 19.319% [========                                ]                                                                 19.419% [========                                ]                                                                 19.520% [========                                ]                                                                 19.620% [========                                ]                                                                 19.720% [========                                ]                                                                 19.820% [========                                ]                                                                 19.920% [========                                ]                                                                 20.020% [========                                ]                                                                 20.120% [========                                ]                                                                 20.220% [========                                ]                                                                 20.320% [========                                ]                                                                 20.420% [========                                ]                                                                 20.521% [========                                ]                                                                 20.621% [========                                ]                                                                 20.721% [========                                ]                                                                 20.821% [========                                ]                                                                 20.921% [========                                ]                                                                 21.021% [========                                ]                                                                 21.121% [========                                ]                                                                 21.221% [========                                ]                                                                 21.321% [=========                               ]                                                                 21.421% [=========                               ]                                                                 21.522% [=========                               ]                                                                 21.622% [=========                               ]                                                                 21.722% [=========                               ]                                                                 21.822% [=========                               ]                                                                 21.922% [=========                               ]                                                                 22.022% [=========                               ]                                                                 22.122% [=========                               ]                                                                 22.222% [=========                               ]                                                                 22.322% [=========                               ]                                                                 22.422% [=========                               ]                                                                 22.523% [=========                               ]                                                                 22.623% [=========                               ]                                                                 22.723% [=========                               ]                                                                 22.823% [=========                               ]                                                                 22.923% [=========                               ]                                                                 23.023% [=========                               ]                                                                 23.123% [=========                               ]                                                                 23.223% [=========                               ]                                                                 23.323% [=========                               ]                                                                 23.423% [=========                               ]                                                                 23.524% [=========                               ]                                                                 23.624% [=========                               ]                                                                 23.724% [=========                               ]                                                                 23.824% [==========                              ]                                                                 23.924% [==========                              ]                                                                 24.024% [==========                              ]                                                                 24.124% [==========                              ]                                                                 24.224% [==========                              ]                                                                 24.324% [==========                              ]                                                                 24.424% [==========                              ]                                                                 24.525% [==========                              ]                                                                 24.625% [==========                              ]                                                                 24.725% [==========                              ]                                                                 24.825% [==========                              ]                                                                 24.925% [==========                              ]                                                                 25.025% [==========                              ]                                                                 25.125% [==========                              ]                                                                 25.225% [==========                              ]                                                                 25.325% [==========                              ]                                                                 25.425% [==========                              ]                                                                 25.526% [==========                              ]                                                                 25.626% [==========                              ]                                                                 25.726% [==========                              ]                                                                 25.826% [==========                              ]                                                                 25.926% [==========                              ]                                                                 26.026% [==========                              ]                                                                 26.126% [==========                              ]                                                                 26.226% [==========                              ]                                                                 26.326% [===========                             ]                                                                 26.426% [===========                             ]                                                                 26.527% [===========                             ]                                                                 26.627% [===========                             ]                                                                 26.727% [===========                             ]                                                                 26.827% [===========                             ]                                                                 26.927% [===========                             ]                                                                 27.027% [===========                             ]                                                                 27.127% [===========                             ]                                                                 27.227% [===========                             ]                                                                 27.327% [===========                             ]                                                                 27.427% [===========                             ]                                                                 27.528% [===========                             ]                                                                 27.628% [===========                             ]                                                                 27.728% [===========                             ]                                                                 27.828% [===========                             ]                                                                 27.928% [===========                             ]                                                                 28.028% [===========                             ]                                                                 28.128% [===========                             ]                                                                 28.228% [===========                             ]                                                                 28.328% [===========                             ]                                                                 28.428% [===========                             ]                                                                 28.529% [===========                             ]                                                                 28.629% [===========                             ]                                                                 28.729% [===========                             ]                                                                 28.829% [============                            ]                                                                 28.929% [============                            ]                                                                 29.029% [============                            ]                                                                 29.129% [============                            ]                                                                 29.229% [============                            ]                                                                 29.329% [============                            ]                                                                 29.429% [============                            ]                                                                 29.530% [============                            ]                                                                 29.630% [============                            ]                                                                 29.730% [============                            ]                                                                 29.830% [============                            ]                                                                 29.930% [============                            ]                                                                 30.030% [============                            ]                                                                 30.130% [============                            ]                                                                 30.230% [============                            ]                                                                 30.330% [============                            ]                                                                 30.430% [============                            ]                                                                 30.531% [============                            ]                                                                 30.631% [============                            ]                                                                 30.731% [============                            ]                                                                 30.831% [============                            ]                                                                 30.931% [============                            ]                                                                 31.031% [============                            ]                                                                 31.131% [============                            ]                                                                 31.231% [============                            ]                                                                 31.331% [=============                           ]                                                                 31.431% [=============                           ]                                                                 31.532% [=============                           ]                                                                 31.632% [=============                           ]                                                                 31.732% [=============                           ]                                                                 31.832% [=============                           ]                                                                 31.932% [=============                           ]                                                                 32.032% [=============                           ]                                                                 32.132% [=============                           ]                                                                 32.232% [=============                           ]                                                                 32.332% [=============                           ]                                                                 32.432% [=============                           ]                                                                 32.533% [=============                           ]                                                                 32.633% [=============                           ]                                                                 32.733% [=============                           ]                                                                 32.833% [=============                           ]                                                                 32.933% [=============                           ]                                                                 33.033% [=============                           ]                                                                 33.133% [=============                           ]                                                                 33.233% [=============                           ]                                                                 33.333% [=============                           ]                                                                 33.433% [=============                           ]                                                                 33.534% [=============                           ]                                                                 33.634% [=============                           ]                                                                 33.734% [=============                           ]                                                                 33.834% [==============                          ]                                                                 33.934% [==============                          ]                                                                 34.034% [==============                          ]                                                                 34.134% [==============                          ]                                                                 34.234% [==============                          ]                                                                 34.334% [==============                          ]                                                                 34.434% [==============                          ]                                                                 34.535% [==============                          ]                                                                 34.635% [==============                          ]                                                                 34.735% [==============                          ]                                                                 34.835% [==============                          ]                                                                 34.935% [==============                          ]                                                                 35.035% [==============                          ]                                                                 35.135% [==============                          ]                                                                 35.235% [==============                          ]                                                                 35.335% [==============                          ]                                                                 35.435% [==============                          ]                                                                 35.536% [==============                          ]                                                                 35.636% [==============                          ]                                                                 35.736% [==============                          ]                                                                 35.836% [==============                          ]                                                                 35.936% [==============                          ]                                                                 36.036% [==============                          ]                                                                 36.136% [==============                          ]                                                                 36.236% [==============                          ]                                                                 36.336% [===============                         ]                                                                 36.436% [===============                         ]                                                                 36.537% [===============                         ]                                                                 36.637% [===============                         ]                                                                 36.737% [===============                         ]                                                                 36.837% [===============                         ]                                                                 36.937% [===============                         ]                                                                 37.037% [===============                         ]                                                                 37.137% [===============                         ]                                                                 37.237% [===============                         ]                                                                 37.337% [===============                         ]                                                                 37.437% [===============                         ]                                                                 37.538% [===============                         ]                                                                 37.638% [===============                         ]                                                                 37.738% [===============                         ]                                                                 37.838% [===============                         ]                                                                 37.938% [===============                         ]                                                                 38.038% [===============                         ]                                                                 38.138% [===============                         ]                                                                 38.238% [===============                         ]                                                                 38.338% [===============                         ]                                                                 38.438% [===============                         ]                                                                 38.539% [===============                         ]                                                                 38.639% [===============                         ]                                                                 38.739% [===============                         ]                                                                 38.839% [================                        ]                                                                 38.939% [================                        ]                                                                 39.039% [================                        ]                                                                 39.139% [================                        ]                                                                 39.239% [================                        ]                                                                 39.339% [================                        ]                                                                 39.439% [================                        ]                                                                 39.540% [================                        ]                                                                 39.640% [================                        ]                                                                 39.740% [================                        ]                                                                 39.840% [================                        ]                                                                 39.940% [================                        ]                                                                 40.040% [================                        ]                                                                 40.140% [================                        ]                                                                 40.240% [================                        ]                                                                 40.340% [================                        ]                                                                 40.440% [================                        ]                                                                 40.541% [================                        ]                                                                 40.641% [================                        ]                                                                 40.741% [================                        ]                                                                 40.841% [================                        ]                                                                 40.941% [================                        ]                                                                 41.041% [================                        ]                                                                 41.141% [================                        ]                                                                 41.241% [================                        ]                                                                 41.341% [=================                       ]                                                                 41.441% [=================                       ]                                                                 41.542% [=================                       ]                                                                 41.642% [=================                       ]                                                                 41.742% [=================                       ]                                                                 41.842% [=================                       ]                                                                 41.942% [=================                       ]                                                                 42.042% [=================                       ]                                                                 42.142% [=================                       ]                                                                 42.242% [=================                       ]                                                                 42.342% [=================                       ]                                                                 42.442% [=================                       ]                                                                 42.543% [=================                       ]                                                                 42.643% [=================                       ]                                                                 42.743% [=================                       ]                                                                 42.843% [=================                       ]                                                                 42.943% [=================                       ]                                                                 43.043% [=================                       ]                                                                 43.143% [=================                       ]                                                                 43.243% [=================                       ]                                                                 43.343% [=================                       ]                                                                 43.443% [=================                       ]                                                                 43.544% [=================                       ]                                                                 43.644% [=================                       ]                                                                 43.744% [=================                       ]                                                                 43.844% [==================                      ]                                                                 43.944% [==================                      ]                                                                 44.044% [==================                      ]                                                                 44.144% [==================                      ]                                                                 44.244% [==================                      ]                                                                 44.344% [==================                      ]                                                                 44.444% [==================                      ]                                                                 44.545% [==================                      ]                                                                 44.645% [==================                      ]                                                                 44.745% [==================                      ]                                                                 44.845% [==================                      ]                                                                 44.945% [==================                      ]                                                                 45.045% [==================                      ]                                                                 45.145% [==================                      ]                                                                 45.245% [==================                      ]                                                                 45.345% [==================                      ]                                                                 45.445% [==================                      ]                                                                 45.546% [==================                      ]                                                                 45.646% [==================                      ]                                                                 45.746% [==================                      ]                                                                 45.846% [==================                      ]                                                                 45.946% [==================                      ]                                                                 46.046% [==================                      ]                                                                 46.146% [==================                      ]                                                                 46.246% [==================                      ]                                                                 46.346% [===================                     ]                                                                 46.446% [===================                     ]                                                                 46.547% [===================                     ]                                                                 46.647% [===================                     ]                                                                 46.747% [===================                     ]                                                                 46.847% [===================                     ]                                                                 46.947% [===================                     ]                                                                 47.047% [===================                     ]                                                                 47.147% [===================                     ]                                                                 47.247% [===================                     ]                                                                 47.347% [===================                     ]                                                                 47.447% [===================                     ]                                                                 47.548% [===================                     ]                                                                 47.648% [===================                     ]                                                                 47.748% [===================                     ]                                                                 47.848% [===================                     ]                                                                 47.948% [===================                     ]                                                                 48.048% [===================                     ]                                                                 48.148% [===================                     ]                                                                 48.248% [===================                     ]                                                                 48.348% [===================                     ]                                                                 48.448% [===================                     ]                                                                 48.549% [===================                     ]                                                                 48.649% [===================                     ]                                                                 48.749% [===================                     ]                                                                 48.849% [====================                    ]                                                                 48.949% [====================                    ]                                                                 49.049% [====================                    ]                                                                 49.149% [====================                    ]                                                                 49.249% [====================                    ]                                                                 49.349% [====================                    ]                                                                 49.449% [====================                    ]                                                                 49.550% [====================                    ]                                                                 49.650% [====================                    ]                                                                 49.750% [====================                    ]                                                                 49.850% [====================                    ]                                                                 49.950% [====================                    ]                                                                 50.050% [====================                    ]                                                                 50.150% [====================                    ]                                                                 50.250% [====================                    ]                                                                 50.350% [====================                    ]                                                                 50.450% [====================                    ]                                                                 50.551% [====================                    ]                                                                 50.651% [====================                    ]                                                                 50.751% [====================                    ]                                                                 50.851% [====================                    ]                                                                 50.951% [====================                    ]                                                                 51.051% [====================                    ]                                                                 51.151% [====================                    ]                                                                 51.251% [=====================                   ]                                                                 51.351% [=====================                   ]                                                                 51.451% [=====================                   ]                                                                 51.552% [=====================                   ]                                                                 51.652% [=====================                   ]                                                                 51.752% [=====================                   ]                                                                 51.852% [=====================                   ]                                                                 51.952% [=====================                   ]                                                                 52.052% [=====================                   ]                                                                 52.152% [=====================                   ]                                                                 52.252% [=====================                   ]                                                                 52.352% [=====================                   ]                                                                 52.452% [=====================                   ]                                                                 52.553% [=====================                   ]                                                                 52.653% [=====================                   ]                                                                 52.753% [=====================                   ]                                                                 52.853% [=====================                   ]                                                                 52.953% [=====================                   ]                                                                 53.053% [=====================                   ]                                                                 53.153% [=====================                   ]                                                                 53.253% [=====================                   ]                                                                 53.353% [=====================                   ]                                                                 53.453% [=====================                   ]                                                                 53.554% [=====================                   ]                                                                 53.654% [=====================                   ]                                                                 53.754% [======================                  ]                                                                 53.854% [======================                  ]                                                                 53.954% [======================                  ]                                                                 54.054% [======================                  ]                                                                 54.154% [======================                  ]                                                                 54.254% [======================                  ]                                                                 54.354% [======================                  ]                                                                 54.454% [======================                  ]                                                                 54.555% [======================                  ]                                                                 54.655% [======================                  ]                                                                 54.755% [======================                  ]                                                                 54.855% [======================                  ]                                                                 54.955% [======================                  ]                                                                 55.055% [======================                  ]                                                                 55.155% [======================                  ]                                                                 55.255% [======================                  ]                                                                 55.355% [======================                  ]                                                                 55.455% [======================                  ]                                                                 55.556% [======================                  ]                                                                 55.656% [======================                  ]                                                                 55.756% [======================                  ]                                                                 55.856% [======================                  ]                                                                 55.956% [======================                  ]                                                                 56.056% [======================                  ]                                                                 56.156% [======================                  ]                                                                 56.256% [=======================                 ]                                                                 56.356% [=======================                 ]                                                                 56.456% [=======================                 ]                                                                 56.557% [=======================                 ]                                                                 56.657% [=======================                 ]                                                                 56.757% [=======================                 ]                                                                 56.857% [=======================                 ]                                                                 56.957% [=======================                 ]                                                                 57.057% [=======================                 ]                                                                 57.157% [=======================                 ]                                                                 57.257% [=======================                 ]                                                                 57.357% [=======================                 ]                                                                 57.457% [=======================                 ]                                                                 57.558% [=======================                 ]                                                                 57.658% [=======================                 ]                                                                 57.758% [=======================                 ]                                                                 57.858% [=======================                 ]                                                                 57.958% [=======================                 ]                                                                 58.058% [=======================                 ]                                                                 58.158% [=======================                 ]                                                                 58.258% [=======================                 ]                                                                 58.358% [=======================                 ]                                                                 58.458% [=======================                 ]                                                                 58.559% [=======================                 ]                                                                 58.659% [=======================                 ]                                                                 58.759% [========================                ]                                                                 58.859% [========================                ]                                                                 58.959% [========================                ]                                                                 59.059% [========================                ]                                                                 59.159% [========================                ]                                                                 59.259% [========================                ]                                                                 59.359% [========================                ]                                                                 59.459% [========================                ]                                                                 59.560% [========================                ]                                                                 59.660% [========================                ]                                                                 59.760% [========================                ]                                                                 59.860% [========================                ]                                                                 59.960% [========================                ]                                                                 60.060% [========================                ]                                                                 60.160% [========================                ]                                                                 60.260% [========================                ]                                                                 60.360% [========================                ]                                                                 60.460% [========================                ]                                                                 60.561% [========================                ]                                                                 60.661% [========================                ]                                                                 60.761% [========================                ]                                                                 60.861% [========================                ]                                                                 60.961% [========================                ]                                                                 61.061% [========================                ]                                                                 61.161% [========================                ]                                                                 61.261% [=========================               ]                                                                 61.361% [=========================               ]                                                                 61.461% [=========================               ]                                                                 61.562% [=========================               ]                                                                 61.662% [=========================               ]                                                                 61.762% [=========================               ]                                                                 61.862% [=========================               ]                                                                 61.962% [=========================               ]                                                                 62.062% [=========================               ]                                                                 62.162% [=========================               ]                                                                 62.262% [=========================               ]                                                                 62.362% [=========================               ]                                                                 62.462% [=========================               ]                                                                 62.563% [=========================               ]                                                                 62.663% [=========================               ]                                                                 62.763% [=========================               ]                                                                 62.863% [=========================               ]                                                                 62.963% [=========================               ]                                                                 63.063% [=========================               ]                                                                 63.163% [=========================               ]                                                                 63.263% [=========================               ]                                                                 63.363% [=========================               ]                                                                 63.463% [=========================               ]                                                                 63.564% [=========================               ]                                                                 63.664% [=========================               ]                                                                 63.764% [==========================              ]                                                                 63.864% [==========================              ]                                                                 63.964% [==========================              ]                                                                 64.064% [==========================              ]                                                                 64.164% [==========================              ]                                                                 64.264% [==========================              ]                                                                 64.364% [==========================              ]                                                                 64.464% [==========================              ]                                                                 64.565% [==========================              ]                                                                 64.665% [==========================              ]                                                                 64.765% [==========================              ]                                                                 64.865% [==========================              ]                                                                 64.965% [==========================              ]                                                                 65.065% [==========================              ]                                                                 65.165% [==========================              ]                                                                 65.265% [==========================              ]                                                                 65.365% [==========================              ]                                                                 65.465% [==========================              ]                                                                 65.566% [==========================              ]                                                                 65.666% [==========================              ]                                                                 65.766% [==========================              ]                                                                 65.866% [==========================              ]                                                                 65.966% [==========================              ]                                                                 66.066% [==========================              ]                                                                 66.166% [==========================              ]                                                                 66.266% [===========================             ]                                                                 66.366% [===========================             ]                                                                 66.466% [===========================             ]                                                                 66.567% [===========================             ]                                                                 66.667% [===========================             ]                                                                 66.767% [===========================             ]                                                                 66.867% [===========================             ]                                                                 66.967% [===========================             ]                                                                 67.067% [===========================             ]                                                                 67.167% [===========================             ]                                                                 67.267% [===========================             ]                                                                 67.367% [===========================             ]                                                                 67.467% [===========================             ]                                                                 67.568% [===========================             ]                                                                 67.668% [===========================             ]                                                                 67.768% [===========================             ]                                                                 67.868% [===========================             ]                                                                 67.968% [===========================             ]                                                                 68.068% [===========================             ]                                                                 68.168% [===========================             ]                                                                 68.268% [===========================             ]                                                                 68.368% [===========================             ]                                                                 68.468% [===========================             ]                                                                 68.569% [===========================             ]                                                                 68.669% [===========================             ]                                                                 68.769% [============================            ]                                                                 68.869% [============================            ]                                                                 68.969% [============================            ]                                                                 69.069% [============================            ]                                                                 69.169% [============================            ]                                                                 69.269% [============================            ]                                                                 69.369% [============================            ]                                                                 69.469% [============================            ]                                                                 69.570% [============================            ]                                                                 69.670% [============================            ]                                                                 69.770% [============================            ]                                                                 69.870% [============================            ]                                                                 69.970% [============================            ]                                                                 70.070% [============================            ]                                                                 70.170% [============================            ]                                                                 70.270% [============================            ]                                                                 70.370% [============================            ]                                                                 70.470% [============================            ]                                                                 70.571% [============================            ]                                                                 70.671% [============================            ]                                                                 70.771% [============================            ]                                                                 70.871% [============================            ]                                                                 70.971% [============================            ]                                                                 71.071% [============================            ]                                                                 71.171% [============================            ]                                                                 71.271% [=============================           ]                                                                 71.371% [=============================           ]                                                                 71.471% [=============================           ]                                                                 71.572% [=============================           ]                                                                 71.672% [=============================           ]                                                                 71.772% [=============================           ]                                                                 71.872% [=============================           ]                                                                 71.972% [=============================           ]                                                                 72.072% [=============================           ]                                                                 72.172% [=============================           ]                                                                 72.272% [=============================           ]                                                                 72.372% [=============================           ]                                                                 72.472% [=============================           ]                                                                 72.573% [=============================           ]                                                                 72.673% [=============================           ]                                                                 72.773% [=============================           ]                                                                 72.873% [=============================           ]                                                                 72.973% [=============================           ]                                                                 73.073% [=============================           ]                                                                 73.173% [=============================           ]                                                                 73.273% [=============================           ]                                                                 73.373% [=============================           ]                                                                 73.473% [=============================           ]                                                                 73.574% [=============================           ]                                                                 73.674% [=============================           ]                                                                 73.774% [==============================          ]                                                                 73.874% [==============================          ]                                                                 73.974% [==============================          ]                                                                 74.074% [==============================          ]                                                                 74.174% [==============================          ]                                                                 74.274% [==============================          ]                                                                 74.374% [==============================          ]                                                                 74.474% [==============================          ]                                                                 74.575% [==============================          ]                                                                 74.675% [==============================          ]                                                                 74.775% [==============================          ]                                                                 74.875% [==============================          ]                                                                 74.975% [==============================          ]                                                                 75.075% [==============================          ]                                                                 75.175% [==============================          ]                                                                 75.275% [==============================          ]                                                                 75.375% [==============================          ]                                                                 75.475% [==============================          ]                                                                 75.576% [==============================          ]                                                                 75.676% [==============================          ]                                                                 75.776% [==============================          ]                                                                 75.876% [==============================          ]                                                                 75.976% [==============================          ]                                                                 76.076% [==============================          ]                                                                 76.176% [==============================          ]                                                                 76.276% [===============================         ]                                                                 76.376% [===============================         ]                                                                 76.476% [===============================         ]                                                                 76.577% [===============================         ]                                                                 76.677% [===============================         ]                                                                 76.777% [===============================         ]                                                                 76.877% [===============================         ]                                                                 76.977% [===============================         ]                                                                 77.077% [===============================         ]                                                                 77.177% [===============================         ]                                                                 77.277% [===============================         ]                                                                 77.377% [===============================         ]                                                                 77.477% [===============================         ]                                                                 77.578% [===============================         ]                                                                 77.678% [===============================         ]                                                                 77.778% [===============================         ]                                                                 77.878% [===============================         ]                                                                 77.978% [===============================         ]                                                                 78.078% [===============================         ]                                                                 78.178% [===============================         ]                                                                 78.278% [===============================         ]                                                                 78.378% [===============================         ]                                                                 78.478% [===============================         ]                                                                 78.579% [===============================         ]                                                                 78.679% [===============================         ]                                                                 78.779% [================================        ]                                                                 78.879% [================================        ]                                                                 78.979% [================================        ]                                                                 79.079% [================================        ]                                                                 79.179% [================================        ]                                                                 79.279% [================================        ]                                                                 79.379% [================================        ]                                                                 79.479% [================================        ]                                                                 79.580% [================================        ]                                                                 79.680% [================================        ]                                                                 79.780% [================================        ]                                                                 79.880% [================================        ]                                                                 79.980% [================================        ]                                                                 80.080% [================================        ]                                                                 80.180% [================================        ]                                                                 80.280% [================================        ]                                                                 80.380% [================================        ]                                                                 80.480% [================================        ]                                                                 80.581% [================================        ]                                                                 80.681% [================================        ]                                                                 80.781% [================================        ]                                                                 80.881% [================================        ]                                                                 80.981% [================================        ]                                                                 81.081% [================================        ]                                                                 81.181% [================================        ]                                                                 81.281% [=================================       ]                                                                 81.381% [=================================       ]                                                                 81.481% [=================================       ]                                                                 81.582% [=================================       ]                                                                 81.682% [=================================       ]                                                                 81.782% [=================================       ]                                                                 81.882% [=================================       ]                                                                 81.982% [=================================       ]                                                                 82.082% [=================================       ]                                                                 82.182% [=================================       ]                                                                 82.282% [=================================       ]                                                                 82.382% [=================================       ]                                                                 82.482% [=================================       ]                                                                 82.583% [=================================       ]                                                                 82.683% [=================================       ]                                                                 82.783% [=================================       ]                                                                 82.883% [=================================       ]                                                                 82.983% [=================================       ]                                                                 83.083% [=================================       ]                                                                 83.183% [=================================       ]                                                                 83.283% [=================================       ]                                                                 83.383% [=================================       ]                                                                 83.483% [=================================       ]                                                                 83.584% [=================================       ]                                                                 83.684% [=================================       ]                                                                 83.784% [==================================      ]                                                                 83.884% [==================================      ]                                                                 83.984% [==================================      ]                                                                 84.084% [==================================      ]                                                                 84.184% [==================================      ]                                                                 84.284% [==================================      ]                                                                 84.384% [==================================      ]                                                                 84.484% [==================================      ]                                                                 84.585% [==================================      ]                                                                 84.685% [==================================      ]                                                                 84.785% [==================================      ]                                                                 84.885% [==================================      ]                                                                 84.985% [==================================      ]                                                                 85.085% [==================================      ]                                                                 85.185% [==================================      ]                                                                 85.285% [==================================      ]                                                                 85.385% [==================================      ]                                                                 85.485% [==================================      ]                                                                 85.586% [==================================      ]                                                                 85.686% [==================================      ]                                                                 85.786% [==================================      ]                                                                 85.886% [==================================      ]                                                                 85.986% [==================================      ]                                                                 86.086% [==================================      ]                                                                 86.186% [==================================      ]                                                                 86.286% [===================================     ]                                                                 86.386% [===================================     ]                                                                 86.486% [===================================     ]                                                                 86.587% [===================================     ]                                                                 86.687% [===================================     ]                                                                 86.787% [===================================     ]                                                                 86.887% [===================================     ]                                                                 86.987% [===================================     ]                                                                 87.087% [===================================     ]                                                                 87.187% [===================================     ]                                                                 87.287% [===================================     ]                                                                 87.387% [===================================     ]                                                                 87.487% [===================================     ]                                                                 87.588% [===================================     ]                                                                 87.688% [===================================     ]                                                                 87.788% [===================================     ]                                                                 87.888% [===================================     ]                                                                 87.988% [===================================     ]                                                                 88.088% [===================================     ]                                                                 88.188% [===================================     ]                                                                 88.288% [===================================     ]                                                                 88.388% [===================================     ]                                                                 88.488% [===================================     ]                                                                 88.589% [===================================     ]                                                                 88.689% [===================================     ]                                                                 88.789% [====================================    ]                                                                 88.889% [====================================    ]                                                                 88.989% [====================================    ]                                                                 89.089% [====================================    ]                                                                 89.189% [====================================    ]                                                                 89.289% [====================================    ]                                                                 89.389% [====================================    ]                                                                 89.489% [====================================    ]                                                                 89.590% [====================================    ]                                                                 89.690% [====================================    ]                                                                 89.790% [====================================    ]                                                                 89.890% [====================================    ]                                                                 89.990% [====================================    ]                                                                 90.090% [====================================    ]                                                                 90.190% [====================================    ]                                                                 90.290% [====================================    ]                                                                 90.390% [====================================    ]                                                                 90.490% [====================================    ]                                                                 90.591% [====================================    ]                                                                 90.691% [====================================    ]                                                                 90.791% [====================================    ]                                                                 90.891% [====================================    ]                                                                 90.991% [====================================    ]                                                                 91.091% [====================================    ]                                                                 91.191% [====================================    ]                                                                 91.291% [=====================================   ]                                                                 91.391% [=====================================   ]                                                                 91.491% [=====================================   ]                                                                 91.592% [=====================================   ]                                                                 91.692% [=====================================   ]                                                                 91.792% [=====================================   ]                                                                 91.892% [=====================================   ]                                                                 91.992% [=====================================   ]                                                                 92.092% [=====================================   ]                                                                 92.192% [=====================================   ]                                                                 92.292% [=====================================   ]                                                                 92.392% [=====================================   ]                                                                 92.492% [=====================================   ]                                                                 92.593% [=====================================   ]                                                                 92.693% [=====================================   ]                                                                 92.793% [=====================================   ]                                                                 92.893% [=====================================   ]                                                                 92.993% [=====================================   ]                                                                 93.093% [=====================================   ]                                                                 93.193% [=====================================   ]                                                                 93.293% [=====================================   ]                                                                 93.393% [=====================================   ]                                                                 93.493% [=====================================   ]                                                                 93.594% [=====================================   ]                                                                 93.694% [=====================================   ]                                                                 93.794% [======================================  ]                                                                 93.894% [======================================  ]                                                                 93.994% [======================================  ]                                                                 94.094% [======================================  ]                                                                 94.194% [======================================  ]                                                                 94.294% [======================================  ]                                                                 94.394% [======================================  ]                                                                 94.494% [======================================  ]                                                                 94.595% [======================================  ]                                                                 94.695% [======================================  ]                                                                 94.795% [======================================  ]                                                                 94.895% [======================================  ]                                                                 94.995% [======================================  ]                                                                 95.095% [======================================  ]                                                                 95.195% [======================================  ]                                                                 95.295% [======================================  ]                                                                 95.395% [======================================  ]                                                                 95.495% [======================================  ]                                                                 95.596% [======================================  ]                                                                 95.696% [======================================  ]                                                                 95.796% [======================================  ]                                                                 95.896% [======================================  ]                                                                 95.996% [======================================  ]                                                                 96.096% [======================================  ]                                                                 96.196% [======================================  ]                                                                 96.296% [======================================= ]                                                                 96.396% [======================================= ]                                                                 96.496% [======================================= ]                                                                 96.597% [======================================= ]                                                                 96.697% [======================================= ]                                                                 96.797% [======================================= ]                                                                 96.897% [======================================= ]                                                                 96.997% [======================================= ]                                                                 97.097% [======================================= ]                                                                 97.197% [======================================= ]                                                                 97.297% [======================================= ]                                                                 97.397% [======================================= ]                                                                 97.497% [======================================= ]                                                                 97.598% [======================================= ]                                                                 97.698% [======================================= ]                                                                 97.798% [======================================= ]                                                                 97.898% [======================================= ]                                                                 97.998% [======================================= ]                                                                 98.098% [======================================= ]                                                                 98.198% [======================================= ]                                                                 98.298% [======================================= ]                                                                 98.398% [======================================= ]                                                                 98.498% [======================================= ]                                                                 98.599% [======================================= ]                                                                 98.699% [======================================= ]                                                                 98.799% [========================================]                                                                 98.899% [========================================]                                                                 98.999% [========================================]                                                                 99.099% [========================================]                                                                 99.199% [========================================]                                                                 99.299% [========================================]                                                                 99.399% [========================================]                                                                 99.499% [========================================]                                                                 99.600% [========================================]                                                                 99.700% [========================================]                                                                 99.800% [========================================]                                                                 99.900% [========================================]                                                                 100.000% [========================================]
> summary(lmb.D9_v2)
Call
lmb(formula = weight ~ group, pfamily = dIndependent_Normal_Gamma(mu, 
    V, shape = shape, rate = rate))

Expected Deviance Residuals:
        1         2         3         4         5         6         7         8 
-0.843886  0.566114  0.166114  1.096114 -0.513886 -0.403886  0.156114 -0.483886 
        9        10        11        12        13        14        15        16 
 0.316114  0.126114  0.128022 -0.511978 -0.271978 -1.091978  1.188022 -0.851978 
       17        18        19        20 
 1.348022  0.208022 -0.361978  0.008022 

Prior and Maximum Likelihood Estimates with Standard Deviations

            Prior Mean Prior.sd Max Like. Like.sd
(Intercept)      4.846    1.000     5.032   0.220
groupTrt         0.000    1.000    -0.371   0.311

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean Post.Sd MC Error Pr(tail)
(Intercept)    5.0060    5.0139  0.2246        0    0.240
groupTrt      -0.3275   -0.3319  0.3128        0    0.131

Distribution Percentiles

               1.0%    2.5%    5.0%  Median   95.0%   97.5% 99.0%
(Intercept)  4.4988  4.5793  4.6509  5.0131  5.3784  5.4343 5.526
groupTrt    -1.0753 -0.9272 -0.8433 -0.3266  0.1630  0.2751 0.476

Effective Number of Parameters: 2.53659 
Expected Residual Deviance: 19.90904 
DIC: 45.6245 

Expected Mean dispersion: 0.5309866 
Sq.root of Expected Mean dispersion: 0.7286882 

Mean Likelihood Subgradient Candidates Per iid sample: 23.667 

> 
> 
> 
> 
> 
> cleanEx()
> nameEx("rnnorm_reg_std")
> ### * rnnorm_reg_std
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: rnnorm_reg_std
> ### Title: The Bayesian Generalized Linear Model Distribution in Standard
> ###   Form
> ### Aliases: rnnorm_reg_std
> ### Keywords: internal
> 
> ### ** Examples
> 
> data(menarche2)
> 
> summary(menarche2)
      Age            Total           Menarche      
 Min.   : 9.21   Min.   :  88.0   Min.   :   0.00  
 1st Qu.:11.58   1st Qu.:  98.0   1st Qu.:  10.00  
 Median :13.08   Median : 105.0   Median :  51.00  
 Mean   :13.10   Mean   : 156.7   Mean   :  92.32  
 3rd Qu.:14.58   3rd Qu.: 117.0   3rd Qu.:  92.00  
 Max.   :17.58   Max.   :1049.0   Max.   :1049.00  
> plot(Menarche/Total ~ Age, data=menarche2)
> 
> Age2=menarche2$Age-13
> 
> x<-matrix(as.numeric(1.0),nrow=length(Age2),ncol=2)
> x[,2]=Age2
> 
> y=menarche2$Menarche/menarche2$Total
> wt=menarche2$Total
> 
> mu<-matrix(as.numeric(0.0),nrow=2,ncol=1)
> mu[2,1]=(log(0.9/0.1)-log(0.5/0.5))/3
> 
> V1<-1*diag(as.numeric(2.0))
> 
> # 2 standard deviations for prior estimate at age 13 between 0.1 and 0.9
> ## Specifies uncertainty around the point estimates
> 
> V1[1,1]<-((log(0.9/0.1)-log(0.5/0.5))/2)^2 
> V1[2,2]=(3*mu[2,1]/2)^2  # Allows slope to be up to 1 times as large as point estimate 
> 
> #out<-rglmb(n = 1000, y=y, x=x, mu=mu, P=solve(V1), wt = wt, 
> #           family = binomial(logit), Gridtype = 3) 
> #summary(out)
> 
> famfunc<-glmbfamfunc(binomial(logit))
> 
> f1<-famfunc$f1
> f2<-famfunc$f2  # Used in optim and glmbsim_cpp
> f3<-famfunc$f3  # Used in optim
> f5<-famfunc$f5
> f6<-famfunc$f6
> 
> dispersion2<-as.numeric(1.0)
> start <- mu
> offset2=rep(as.numeric(0.0),length(y))
> P=solve(V1)
> n=1000
> 
> 
> ###### Adjust weight for dispersion
> 
> wt2=wt/dispersion2
> 
> ######################### Shift mean vector to offset so that adjusted model has 0 mean
> 
> alpha=x%*%as.vector(mu)+offset2
> mu2=0*as.vector(mu)
> P2=P
> x2=x
> 
> 
> #####  Optimization step to find posterior mode and associated Precision
> 
> parin=start-mu
> 
> opt_out=optim(parin,f2,f3,y=as.vector(y),x=as.matrix(x),mu=as.vector(mu2),
+               P=as.matrix(P),alpha=as.vector(alpha),wt=as.vector(wt2),
+               method="BFGS",hessian=TRUE
+ )
> 
> bstar=opt_out$par  ## Posterior mode for adjusted model
> bstar
            [,1]
[1,] -0.01069645
[2,]  0.89698197
> bstar+as.vector(mu)  # mode for actual model
            [,1]
[1,] -0.01069645
[2,]  1.62939016
> A1=opt_out$hessian # Approximate Precision at mode
> 
> ## Standardize Model
> 
> Standard_Mod=glmb_Standardize_Model(y=as.vector(y), x=as.matrix(x),P=as.matrix(P),
+                                     bstar=as.matrix(bstar,ncol=1), A1=as.matrix(A1))
> 
> bstar2=Standard_Mod$bstar2  
> A=Standard_Mod$A
> x2=Standard_Mod$x2
> mu2=Standard_Mod$mu2
> P2=Standard_Mod$P2
> L2Inv=Standard_Mod$L2Inv
> L3Inv=Standard_Mod$L3Inv
> 
> Env2=EnvelopeBuild(as.vector(bstar2), as.matrix(A),y, as.matrix(x2),
+                    as.matrix(mu2,ncol=1),as.matrix(P2),as.vector(alpha),as.vector(wt2),
+                    family="binomial",link="logit",Gridtype=as.integer(3), 
+                    n=as.integer(n),sortgrid=TRUE)
Entering EnvelopeBuild_c: 2025-08-03 19:21:26
Entering Envelope Loop: 2025-08-03 19:21:26
Initiating NegLL Calculations: 2025-08-03 19:21:26
Initiating Gradient Calculations: 2025-08-03 19:21:26
> 
> ## These now seem to match
> 
> Env2
$GridIndex
  GIndex.Var1 GIndex.Var2
5           2           2
6           3           2
8           2           3
2           2           1
4           1           2
9           3           3
3           3           1
7           1           3
1           1           1

$thetabars
    G3.Var1    G3.Var2
5 0.5662049 0.11300265
6 0.6195287 0.11300265
8 0.5662049 0.17044504
2 0.5662049 0.05556027
4 0.5128810 0.11300265
9 0.6195287 0.17044504
3 0.6195287 0.05556027
7 0.5128810 0.17044504
1 0.5128810 0.05556027

$cbars
      cbars.1     cbars.2
5  -0.5661981  -0.1130015
6  34.4621159  -0.2437098
8  -1.4475523  34.1689246
2  -1.4796882 -35.3623598
4 -40.7542186  -0.2682291
9  33.3865305  32.4873204
3  33.8979746 -33.8580716
7 -41.3722300  35.7125259
1 -42.1074002 -37.3119403

$logU
       logU.1      logU.2
5   -3.850428   -3.776049
6 -618.902574   -3.784589
8   -4.238723 -593.065539
2   -4.267555 -626.754407
4 -813.223858   -3.788093
9 -581.745276 -536.732343
3 -599.269541 -574.773949
7 -838.283187 -647.262791
1 -868.590223 -697.486001

$logrt
       logrt.1      logrt.2
5   -0.6721049   -0.6704936
6 -618.9025745   -0.5738821
8   -0.2008155 -593.0655394
2   -0.1906419    0.0000000
4    0.0000000   -0.5569172
9 -581.7452759 -536.7323432
3 -599.2695410    0.0000000
7    0.0000000 -647.2627913
1    0.0000000    0.0000000

$loglt
       loglt.1      loglt.2
5   -0.6720943   -0.6704918
6    0.0000000   -0.7778690
8   -1.6277922    0.0000000
2   -1.6735097 -626.7544071
4 -813.2238580   -0.7992502
9    0.0000000    0.0000000
3    0.0000000 -574.7739490
7 -838.2831866    0.0000000
1 -868.5902230 -697.4860009

$LLconst
[1] 55.87862 35.14719 51.52363 59.36200 77.55426 31.17893 38.32546 72.77690
[9] 81.36520

$logP
[1]    -7.626477  -622.687163  -597.304262  -631.021962  -817.011951
[6] -1118.477619 -1174.043490 -1485.545978 -1566.076224

$PLSD
[1] 0.24960979 0.13063173 0.12594361 0.12363622 0.11925255 0.06975357 0.06737136
[8] 0.05788189 0.05591928

$a1
[1] 702.3746 605.1290

> 
> #int n, NumericVector y, NumericMatrix x, NumericMatrix mu, NumericMatrix P, 
> #NumericVector alpha, NumericVector wt, Function f2,
> #Rcpp::List Envelope, Rcpp::CharacterVector family, 
> #Rcpp::CharacterVector link, int progbar
> 
> ### Note: getting the types correct here is important but potentially difficult for users
> ### May be better to call an R function wrapper that checks (and converts when possible) 
> ##  to correct types
> 
> sim=rnnorm_reg_std(n=as.integer(n),y=as.vector(y),x=as.matrix(x2),mu=as.matrix(mu2,ncol=1),
+                    P=as.matrix(P2),alpha=as.vector(alpha),wt=as.vector(wt2),
+                    f2=f2,Envelope=Env2,family="binomial",link="logit",as.integer(0))
> 
> out=L2Inv%*%L3Inv%*%t(sim$out)
> 
> for(i in 1:n){
+   out[,i]=out[,i]+mu
+ }
> 
> summary(t(out))
       V1                 V2       
 Min.   :-0.21414   Min.   :1.454  
 1st Qu.:-0.05611   1st Qu.:1.592  
 Median :-0.01731   Median :1.631  
 Mean   :-0.01416   Mean   :1.633  
 3rd Qu.: 0.02943   3rd Qu.:1.673  
 Max.   : 0.19592   Max.   :1.827  
> mean(sim$draws)
[1] 1.244
> 
> 
> 
> cleanEx()
> nameEx("setlogP")
> ### * setlogP
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: setlogP
> ### Title: Calculate constants used during sampling from Likelihood
> ###   subgradient densities
> ### Aliases: setlogP
> ### Keywords: internal
> 
> ### ** Examples
> 
> ## ----dobson-------------------------------------------------------------------
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> 
> ## Prior mean vector 
> mu<-matrix(0,5)           
> mu[1,1]=log(mean(counts)) 
> ## Prior standard deviation and Variance
> mysd<-1           
> V=((mysd)^2)*diag(5)  
> ## Call to glmb
> glmb.D93<-glmb(n=1000,counts ~ outcome + treatment,
+                family = poisson(),pfamily=dNormal(mu=mu,Sigma=V))
Entering EnvelopeBuild_c: 2025-08-03 19:21:26
Entering Envelope Loop: 2025-08-03 19:21:26
> ## ----glmb extractAIC-------------------------------------------------------------
> extractAIC(glmb.D93)
       pD       DIC 
 4.701015 56.206984 
> 
> 
> 
> cleanEx()
> nameEx("simulate.glmb")
> ### * simulate.glmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: simulate.glmb
> ### Title: Simulate Responses
> ### Aliases: simulate.glmb
> 
> ### ** Examples
> 
> data(menarche2)
> ## ----Analysis Setup-----------------------------------------------------------
> ## Number of variables in model
> Age=menarche2$Age
> nvars=2
> ## Reference Ages for setting of priors and Age_Difference
> ref_age1=13  # user can modify this
> ref_age2=15  ## user can modify this
> ## Define variables used later in analysis
> Age2=menarche2$Age-ref_age1
> Age_Diff=ref_age2-ref_age1
> mu1=as.matrix(c(0,1.098612),ncol=1)
> V1<-1*diag(nvars)
> V1[1,1]=0.18687882
> V1[2,2]=0.10576217
> V1[1,2]=-0.03389182
> V1[2,1]=-0.03389182
> Menarche_Model_Data=data.frame(Age=menarche2$Age,Total=menarche2$Total,
+                                Menarche=menarche2$Menarche,Age2)
> glmb.out1<-glmb(n=1000,cbind(Menarche, Total-Menarche) ~Age2,family=binomial(logit),
+                 pfamily=dNormal(mu=mu1,Sigma=V1),data=Menarche_Model_Data)
Entering EnvelopeBuild_c: 2025-08-03 19:21:26
Entering Envelope Loop: 2025-08-03 19:21:26
Initiating NegLL Calculations: 2025-08-03 19:21:26
Initiating Gradient Calculations: 2025-08-03 19:21:26
Warning in eval(family$initialize) :
  non-integer #successes in a binomial glm!
> 
> # Prediction from original model
> pred1=predict(glmb.out1,type="response")
> 
> ## Get Original Residuals, their means, and credible bounds
> res_out=residuals(glmb.out1)
> colMeans(res_out)
         1          2          3          4          5          6          7 
-1.2831179 -2.0875609 -1.9132371 -0.8635082 -1.0477385 -0.2164429  0.1695493 
         8          9         10         11         12         13         14 
 0.7227017 -0.5844777  1.3422355  1.1953154  0.9327811 -1.0600343  0.1272728 
        15         16         17         18         19         20         21 
 1.3134416 -0.9737279 -1.1407194  1.1516431  0.6644670 -0.7981052 -0.3953837 
        22         23         24         25 
-0.8344960 -0.4206765 -0.6752000  1.1551884 
> 
> ## Set up to simulate new data and residuals
> res_mean=colMeans(res_out)
> res_low1=apply(res_out,2,FUN=quantile,probs=c(0.025))
> res_high1=apply(res_out,2,FUN=quantile,probs=c(0.975))
> 
> ## Simulate new data and get residuals for simulated data
> 
> ysim1=simulate(glmb.out1,nsim=1,seed=NULL,pred=pred1,family="binomial",
+                prior.weights=weights(glmb.out1))
> 
> 
> res_ysim_out1=residuals(glmb.out1,ysim=ysim1)
> res_low=apply(res_ysim_out1,2,FUN=quantile,probs=c(0.025))
> res_high=apply(res_ysim_out1,2,FUN=quantile,probs=c(0.975))
> 
> # Plot Credible Interval bounds for Deviance Residuals
> 
> plot(res_mean~Age,ylim=c(-2.5,2.5),
+ main="Credible Interval Bound for Menarche - Logit Model Deviance Residuals",
+ xlab = "Age", ylab = "Avg. Dev. Res")
> lines(Age, 0*res_mean,lty=1)
> lines(Age, res_low,lty=1)
> lines(Age, res_high,lty=1)
> lines(Age, res_low1,lty=2)
> lines(Age, res_high1,lty=2)
> 
> 
> 
> 
> cleanEx()
> nameEx("summary.glmb")
> ### * summary.glmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: summary.glmb
> ### Title: Summarizing Bayesian Generalized Linear Model Fits
> ### Aliases: summary.glmb print.summary.glmb
> 
> ### ** Examples
> 
> ###########################  Example for glmb function:
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> print(d.AD <- data.frame(treatment, outcome, counts))
  treatment outcome counts
1         1       1     18
2         1       2     17
3         1       3     15
4         2       1     20
5         2       2     10
6         2       3     20
7         3       1     25
8         3       2     13
9         3       3     12
> 
> mysd<-1
> mu<-matrix(0,5)
> mu[1,1]=log(mean(counts))
> V0<-((mysd)^2)*diag(5)
> glmb.D93<-glmb(counts ~ outcome + treatment, family = poisson(),
+ pfamily=dNormal(mu=mu,Sigma=V0))
Entering EnvelopeBuild_c: 2025-08-03 19:21:27
Entering Envelope Loop: 2025-08-03 19:21:27
> summary(glmb.D93)
Call
glmb(formula = counts ~ outcome + treatment, family = poisson(), 
    pfamily = dNormal(mu = mu, Sigma = V0))

Expected Deviance Residuals:
       1        2        3        4        5        6        7        8 
-0.58443  0.99089 -0.16545 -0.12134 -0.92498  1.06467  0.92941 -0.07418 
       9 
-0.97066 

Prior and Maximum Likelihood Estimates with Standard Deviations

                         Prior.sd  Max Like. Like.sd
(Intercept)  2.813e+00  1.000e+00  3.045e+00   0.171
outcome2     0.000e+00  1.000e+00 -4.543e-01   0.202
outcome3     0.000e+00  1.000e+00 -2.930e-01   0.193
treatment2   0.000e+00  1.000e+00  1.217e-15   0.200
treatment3   0.000e+00  1.000e+00  8.438e-16   0.200

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean   Post.Sd MC Error Pr(tail)   
(Intercept)  3.027191  3.020145  0.169744        0  0.11588   
outcome2    -0.428954 -0.443144  0.191345        0  0.00699 **
outcome3    -0.272569 -0.275538  0.183283        0  0.06194 . 
treatment2   0.004042 -0.002057  0.199581        0  0.49251   
treatment3   0.004042  0.002352  0.197943        0  0.49650   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Distribution Percentiles

                 1.0%      2.5%      5.0%    Median     95.0%     97.5%  99.0%
(Intercept)  2.581798  2.692100  2.743222  3.027618  3.297744  3.343512  3.409
outcome2    -0.907087 -0.822420 -0.762628 -0.446785 -0.146399 -0.098589 -0.022
outcome3    -0.695243 -0.644398 -0.577591 -0.274639  0.017980  0.084581  0.159
treatment2  -0.454796 -0.399299 -0.338417 -0.003382  0.328304  0.395917  0.482
treatment3  -0.431382 -0.378133 -0.315895 -0.001244  0.320214  0.393541  0.494

Effective Number of Parameters: 4.775684 
Expected Residual Deviance: 9.951234 
DIC: 56.3591 

Expected Mean dispersion: 1 
Sq.root of Expected Mean dispersion: 1 

Mean Likelihood Subgradient Candidates Per iid sample: 1.771 

> 
> ###########################  Example for lmb function
> 
> ## Annette Dobson (1990) "An Introduction to Generalized Linear Models".
> ## Page 9: Plant Weight Data.
> ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
> trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
> group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
> weight <- c(ctl, trt)
> 
> ps=Prior_Setup(weight ~ group)
[1] "Variable names are:"
[1] "(Intercept)" "groupTrt"   
> mu=ps$mu
> V=ps$Sigma
> mu[1,1]=mean(weight)
> 
> Prior_Check(weight ~ group,family =gaussian(),
+             pfamily=dNormal(mu=mu,Sigma=V))
[1] "Variables in the Model Are:"
[1] "(Intercept)" "groupTrt"   
[1] "The maximum likelihood estimates for all coefficients appear to be roughly consistent with the prior."
             abs_ratio
(Intercept) 0.09242285
groupTrt    0.17198871
> 
> ## May move this step inside the Prior_Check function
> lm.D9 <- lm(weight ~ group,x=TRUE,y=TRUE)
> disp_ML=sigma(lm.D9)^2
> n_prior=2
> shape=n_prior/2
> rate= disp_ML*shape
> 
> lmb.D9=lmb(weight ~ group,dNormal_Gamma(mu,V/disp_ML,shape=shape,rate=rate))
> summary(lmb.D9)
Call
lmb(formula = weight ~ group, pfamily = dNormal_Gamma(mu, V/disp_ML, 
    shape = shape, rate = rate))

Expected Deviance Residuals:
        1         2         3         4         5         6         7         8 
-0.837811  0.572189  0.172189  1.102189 -0.507811 -0.397811  0.162189 -0.477811 
        9        10        11        12        13        14        15        16 
 0.322189  0.132189  0.126903 -0.513097 -0.273097 -1.093097  1.186903 -0.853097 
       17        18        19        20 
 1.346903  0.206903 -0.363097  0.006903 

Prior and Maximum Likelihood Estimates with Standard Deviations

            Prior Mean Prior.sd Max Like. Like.sd
(Intercept)      4.846    1.436     5.032   0.220
groupTrt         0.000    1.436    -0.371   0.311

Bayesian Estimates Based on 1000 iid draws

            Post.Mode Post.Mean Post.Sd MC Error Pr(tail)
(Intercept)    5.0081    5.0078  0.2110        0    0.218
groupTrt      -0.3311   -0.3247  0.2868        0    0.119

Distribution Percentiles

               1.0%    2.5%    5.0%  Median   95.0%   97.5% 99.0%
(Intercept)  4.5315  4.5952  4.6548  5.0063  5.3358  5.4354 5.530
groupTrt    -0.9929 -0.9164 -0.7829 -0.3232  0.1468  0.2673 0.388

Effective Number of Parameters: 2.617534 
Expected Residual Deviance: 21.24484 
DIC: 45.58812 

Expected Mean dispersion: 0.4956164 
Sq.root of Expected Mean dispersion: 0.7040003 

Mean Likelihood Subgradient Candidates Per iid sample: 1 

> 
> 
> 
> cleanEx()
> nameEx("summary.rglmb")
> ### * summary.rglmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: summary.rglmb
> ### Title: Summarizing Bayesian Generalized Linear Model Distribution
> ###   Functions
> ### Aliases: summary.rglmb print.summary.rglmb
> 
> ### ** Examples
> 
> data(menarche2)
> 
> summary(menarche2)
      Age            Total           Menarche      
 Min.   : 9.21   Min.   :  88.0   Min.   :   0.00  
 1st Qu.:11.58   1st Qu.:  98.0   1st Qu.:  10.00  
 Median :13.08   Median : 105.0   Median :  51.00  
 Mean   :13.10   Mean   : 156.7   Mean   :  92.32  
 3rd Qu.:14.58   3rd Qu.: 117.0   3rd Qu.:  92.00  
 Max.   :17.58   Max.   :1049.0   Max.   :1049.00  
> plot(Menarche/Total ~ Age, data=menarche2)
> 
> Age2=menarche2$Age-13
> 
> x<-matrix(as.numeric(1.0),nrow=length(Age2),ncol=2)
> x[,2]=Age2
> 
> y=menarche2$Menarche/menarche2$Total
> wt=menarche2$Total
> 
> mu<-matrix(as.numeric(0.0),nrow=2,ncol=1)
> mu[2,1]=(log(0.9/0.1)-log(0.5/0.5))/3
> 
> V1<-1*diag(as.numeric(2.0))
> 
> # 2 standard deviations for prior estimate at age 13 between 0.1 and 0.9
> ## Specifies uncertainty around the point estimates
> 
> V1[1,1]<-((log(0.9/0.1)-log(0.5/0.5))/2)^2 
> V1[2,2]=(3*mu[2,1]/2)^2  # Allows slope to be up to 3 times as large as point estimate 
> 
> out<-rglmb(n = 1000, y=y, x=x, pfamily=dNormal(mu=mu,Sigma=V1), weights = wt, 
+            family = binomial(logit)) 
Entering EnvelopeBuild_c: 2025-08-03 19:21:27
Entering Envelope Loop: 2025-08-03 19:21:27
Initiating NegLL Calculations: 2025-08-03 19:21:27
Initiating Gradient Calculations: 2025-08-03 19:21:27
> summary(out)
Warning in eval(family$initialize) :
  non-integer #successes in a binomial glm!
Call
NULL

Prior Estimates with Standard Deviations

            Prior.sd Approx.Prior.wt
[1,] 0.0000   1.0986           0.003
[2,] 0.7324   1.0986           0.003

Bayesian Estimates Based on 1000 iid draws

     Post.Mode Post.Mean  Post.Sd MC Error Pr(tail)    
[1,]  -0.01070  -0.01300  0.06242        0 0.404595    
[2,]   1.62939   1.63408  0.05654        0 0.000999 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Distribution Percentiles

         1.0%     2.5%     5.0%   Median    95.0%    97.5% 99.0%
[1,] -0.15623 -0.13331 -0.11685 -0.01699  0.08871  0.10993 0.137
[2,]  1.50254  1.52935  1.54381  1.63311  1.72798  1.74726 1.758
> 
> print(summary(out),digits=4)
Warning in eval(family$initialize) :
  non-integer #successes in a binomial glm!
Call
NULL

Prior Estimates with Standard Deviations

            Prior.sd Approx.Prior.wt
[1,] 0.0000   1.0986           0.003
[2,] 0.7324   1.0986           0.003

Bayesian Estimates Based on 1000 iid draws

     Post.Mode Post.Mean  Post.Sd MC Error Pr(tail)    
[1,]  -0.01070  -0.01300  0.06242        0 0.404595    
[2,]   1.62939   1.63408  0.05654        0 0.000999 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Distribution Percentiles

         1.0%     2.5%     5.0%   Median    95.0%    97.5% 99.0%
[1,] -0.15623 -0.13331 -0.11685 -0.01699  0.08871  0.10993 0.137
[2,]  1.50254  1.52935  1.54381  1.63311  1.72798  1.74726 1.758
> 
> mean(out$iters)
[1] 1.304
> 
> 
> 
> cleanEx()
> nameEx("vcov.glmb")
> ### * vcov.glmb
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: vcov.glmb
> ### Title: Calculate Variance-Covariance Matrux for a Fitted Model Object
> ### Aliases: vcov.glmb
> 
> ### ** Examples
> 
> ## ----dobson-------------------------------------------------------------------
> ## Dobson (1990) Page 93: Randomized Controlled Trial :
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> 
> ## Prior mean vector 
> mu<-matrix(0,5)           
> mu[1,1]=log(mean(counts)) 
> ## Prior standard deviation and Variance
> mysd<-1           
> V=((mysd)^2)*diag(5)  
> ## Call to glmb
> glmb.D93<-glmb(n=1000,counts ~ outcome + treatment,
+                family = poisson(),pfamily=dNormal(mu=mu,Sigma=V))
Entering EnvelopeBuild_c: 2025-08-03 19:21:27
Entering Envelope Loop: 2025-08-03 19:21:27
> 
> ## ----glmb vcov----------------------------------------------------------------
> vcov(glmb.D93)
            (Intercept)      outcome2      outcome3    treatment2    treatment3
(Intercept)  0.02874615 -0.0161908135 -0.0165964784 -0.0189899360 -0.0174296383
outcome2    -0.01619081  0.0396170583  0.0175653911  0.0009315440 -0.0004525639
outcome3    -0.01659648  0.0175653911  0.0401732151 -0.0003944613 -0.0011802510
treatment2  -0.01898994  0.0009315440 -0.0003944613  0.0373522638  0.0168864711
treatment3  -0.01742964 -0.0004525639 -0.0011802510  0.0168864711  0.0351084162
> 
> 
> 
> 
> ### * <FOOTER>
> ###
> cleanEx()
> options(digits = 7L)
> base::cat("Time elapsed: ", proc.time() - base::get("ptime", pos = 'CheckExEnv'),"\n")
Time elapsed:  6.25 0.69 7.58 NA NA 
> grDevices::dev.off()
null device 
          1 
> ###
> ### Local variables: ***
> ### mode: outline-minor ***
> ### outline-regexp: "\\(> \\)?### [*]+" ***
> ### End: ***
> quit('no')
